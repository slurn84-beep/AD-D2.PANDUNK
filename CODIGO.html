<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AD&D 2.Pandunk</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
            color: #e5e5e5;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .app-header {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 2px solid #ffd700;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 1.5rem;
            font-weight: bold;
            color: #ffd700;
        }

        .header-actions {
            display: flex;
            gap: 1rem;
        }

        .btn {
            padding: 0.6rem 1.2rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #1a1a2e;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 215, 0, 0.3);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #e5e5e5;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-1px);
        }

        .main-container {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 2rem;
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 2rem;
        }

        .sidebar {
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 1.5rem;
            height: fit-content;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .character-summary {
            text-align: center;
            padding: 1rem;
            background: rgba(255, 215, 0, 0.1);
            border-radius: 12px;
            border: 1px solid rgba(255, 215, 0, 0.3);
            margin-bottom: 2rem;
        }

        .character-avatar {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            border-radius: 50%;
            margin: 0 auto 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            color: #1a1a2e;
        }

        .category-selector {
            margin-bottom: 2rem;
        }

        .category-title {
            color: #ffd700;
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .category-grid {
            display: grid;
            gap: 0.5rem;
        }

        .category-option {
            padding: 0.8rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }

        .category-option:hover {
            background: rgba(255, 215, 0, 0.1);
            border-color: rgba(255, 215, 0, 0.3);
            transform: translateX(4px);
        }

        .category-option.selected {
            background: rgba(255, 215, 0, 0.2);
            border-color: #ffd700;
            position: relative;
        }

        .category-option.selected::before {
            content: "✓";
            position: absolute;
            right: 0.8rem;
            top: 50%;
            transform: translateY(-50%);
            color: #ffd700;
            font-weight: bold;
        }

        .category-name {
            font-weight: 600;
            color: #ffd700;
            display: block;
            margin-bottom: 0.2rem;
        }

        .category-desc {
            font-size: 0.85rem;
            color: #b0b0b0;
            line-height: 1.3;
        }

        .main-content {
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow: hidden;
        }

        .tab-navigation {
            display: flex;
            background: rgba(0, 0, 0, 0.3);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .tab-btn {
            padding: 1rem 2rem;
            background: transparent;
            border: none;
            color: #b0b0b0;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            font-weight: 500;
        }

        .tab-btn:hover {
            background: rgba(255, 255, 255, 0.05);
            color: #e5e5e5;
        }

        .tab-btn.active {
            color: #ffd700;
            background: rgba(255, 215, 0, 0.1);
        }

        .tab-btn.active::after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: #ffd700;
        }

        .tab-content {
            padding: 2rem;
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .form-label {
            font-weight: 600;
            color: #ffd700;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .form-input {
            padding: 0.8rem 1rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: #e5e5e5;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #ffd700;
            background: rgba(255, 255, 255, 0.1);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.2);
        }

        .abilities-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .ability-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            transition: all 0.3s ease;
        }

        .ability-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            border-color: rgba(255, 215, 0, 0.3);
        }

        .ability-name {
            color: #ffd700;
            font-weight: 700;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 0.8rem;
        }

        .ability-score {
            font-size: 2.5rem;
            font-weight: 800;
            color: #e5e5e5;
            margin-bottom: 0.5rem;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
        }

        .ability-modifier {
            font-size: 1.2rem;
            font-weight: 600;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            display: inline-block;
            min-width: 60px;
        }

        .modifier-positive {
            background: rgba(0, 255, 127, 0.2);
            color: #00ff7f;
            border: 1px solid rgba(0, 255, 127, 0.3);
        }

        .modifier-negative {
            background: rgba(255, 99, 71, 0.2);
            color: #ff6347;
            border: 1px solid rgba(255, 99, 71, 0.3);
        }

        .modifier-zero {
            background: rgba(255, 255, 255, 0.1);
            color: #b0b0b0;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .ability-input {
            background: transparent;
            border: none;
            color: inherit;
            font-size: inherit;
            font-weight: inherit;
            text-align: center;
            width: 100%;
            outline: none;
        }

        .stats-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: #ffd700;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: #b0b0b0;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .dice-roller {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 1000;
        }

        .dice-btn {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #1a1a2e;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.5rem;
            font-weight: bold;
            box-shadow: 0 4px 20px rgba(255, 215, 0, 0.4);
            transition: all 0.3s ease;
        }

        .dice-btn:hover {
            transform: scale(1.1) rotate(10deg);
            box-shadow: 0 6px 30px rgba(255, 215, 0, 0.6);
        }

        .notification {
            position: fixed;
            top: 100px;
            right: 2rem;
            background: rgba(0, 0, 0, 0.9);
            border: 1px solid #ffd700;
            border-radius: 8px;
            padding: 1rem 1.5rem;
            color: #ffd700;
            transform: translateX(400px);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 1001;
            white-space: pre-line;
            max-width: 400px;
        }

        .notification.show {
            transform: translateX(0);
            opacity: 1;
        }

        .con-bonus-info {
            background: rgba(255, 215, 0, 0.1);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
            font-size: 0.9rem;
        }

        .con-bonus-info h4 {
            color: #ffd700;
            margin-bottom: 0.5rem;
        }

        .con-bonus-info p {
            color: #e5e5e5;
            margin: 0.25rem 0;
        }

        .spells-list {
            display: grid;
            gap: 1rem;
            margin: 1rem 0;
        }

        .spell-item {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 1rem;
            border-left: 4px solid #ffd700;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .spell-item:hover {
            background: rgba(255, 215, 0, 0.1);
            transform: translateX(4px);
        }

        .spell-name {
            color: #ffd700;
            font-weight: 600;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .spell-level {
            display: inline-block;
            background: rgba(255, 255, 255, 0.1);
            color: #e5e5e5;
            padding: 0.2rem 0.5rem;
            border-radius: 12px;
            font-size: 0.8rem;
            margin-right: 0.5rem;
        }

        .spell-school {
            display: inline-block;
            background: rgba(0, 150, 255, 0.2);
            color: #87ceeb;
            padding: 0.2rem 0.5rem;
            border-radius: 12px;
            font-size: 0.8rem;
            margin-right: 0.5rem;
        }

        .spell-description {
            color: #b0b0b0;
            margin-top: 0.5rem;
            line-height: 1.4;
            font-size: 0.9rem;
        }

        .spell-slots {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(30px, 1fr));
            gap: 0.5rem;
            margin: 1rem 0;
        }

        .spell-slot {
            aspect-ratio: 1;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .spell-slot.used {
            background: rgba(255, 99, 71, 0.2);
            border-color: #ff6347;
            color: #ff6347;
        }

        .spell-slot.available {
            background: rgba(0, 255, 127, 0.2);
            border-color: #00ff7f;
            color: #00ff7f;
        }

        .spell-slot:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
        }

        .spell-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .spell-modal-content {
            background: rgba(0, 0, 0, 0.95);
            border: 2px solid #ffd700;
            border-radius: 16px;
            padding: 2rem;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
        }

        .spell-modal .close-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            color: #ffd700;
            font-size: 1.5rem;
            cursor: pointer;
        }

        /* Equipment specific styles */
        .equipment-section {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .equipment-section h3 {
            color: #ffd700;
            font-size: 1.2rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .equipment-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .equipment-slot {
            background: rgba(0, 0, 0, 0.3);
            border: 2px dashed rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 1rem;
            text-align: center;
            transition: all 0.3s ease;
            min-height: 80px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .equipment-slot.occupied {
            border-style: solid;
            border-color: #ffd700;
            background: rgba(255, 215, 0, 0.1);
        }

        .equipment-slot:hover {
            border-color: rgba(255, 215, 0, 0.5);
            background: rgba(255, 215, 0, 0.05);
        }

        .slot-label {
            font-size: 0.8rem;
            color: #b0b0b0;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.5rem;
        }

        .slot-item {
            color: #ffd700;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .slot-empty {
            color: #666;
            font-style: italic;
        }

        .weapon-slot {
            background: rgba(220, 20, 60, 0.1);
            border-color: rgba(220, 20, 60, 0.3);
        }

        .weapon-slot.occupied {
            border-color: #dc143c;
            background: rgba(220, 20, 60, 0.2);
        }

        .weapon-slot .slot-item {
            color: #ff6b6b;
        }

        .armor-stats {
            background: rgba(0, 100, 200, 0.1);
            border: 1px solid rgba(0, 100, 200, 0.3);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
        }

        .armor-stats h4 {
            color: #4da6ff;
            margin-bottom: 0.5rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            color: #e5e5e5;
        }

        .stat-item .label {
            color: #b0b0b0;
        }

        .stat-item .value {
            color: #ffd700;
            font-weight: 600;
        }

        .quick-equip-buttons {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .quick-equip-btn {
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            color: #e5e5e5;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.3s ease;
        }

        .quick-equip-btn:hover {
            background: rgba(255, 215, 0, 0.2);
            border-color: #ffd700;
            color: #ffd700;
        }

        @media (max-width: 1024px) {
            .main-container {
                grid-template-columns: 1fr;
                padding: 0 1rem;
            }
            
            .sidebar {
                order: 2;
            }
            
            .main-content {
                order: 1;
            }

            .equipment-grid {
                grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            }
        }

        @media (max-width: 768px) {
            .spell-modal-content {
                margin: 1rem;
                max-width: calc(100% - 2rem);
            }

            .equipment-grid {
                grid-template-columns: 1fr 1fr;
            }

            .quick-equip-buttons {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="app-header">
        <div class="header-content">
            <div class="logo">
                🎲 AD&D 2.Pandunk
            </div>
            <div class="header-actions">
                <button class="btn btn-secondary" onclick="rollAbilities()">🎲 Roll Stats</button>
                <button class="btn btn-secondary" onclick="rollHitPoints()">❤️ Roll HP</button>
                <button class="btn btn-secondary" onclick="saveCharacter()">💾 Guardar</button>
                <button class="btn btn-primary" onclick="exportCharacter()">📤 Exportar</button>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <!-- Character Summary -->
            <div class="character-summary">
                <div class="character-avatar" id="characterAvatar">👤</div>
                <h3 id="characterNameDisplay">Nuevo Personaje</h3>
                <p id="characterClassDisplay">Selecciona una clase</p>
                <p>Nivel <span id="characterLevelDisplay">1</span></p>
            </div>

           <div class="category-selector">
    <h4 class="category-title" style="text-align: center;">🛡️ Categoría Principal</h4>
    <div class="custom-dropdown-container">
        <div class="dropdown-header category-option" id="primary-dropdown-header">
            <h5 class="category-name" id="primary-selected-name" style="color: #b0b0b0; font-style: italic; text-align: center; margin: 0;">Selecciona una clase</h5>
            <span class="category-desc" id="primary-selected-desc"></span>
        </div>
        
        <div class="dropdown-options" id="primary-dropdown-options">
            <div class="option" data-category="luchador" data-class="Bárbaro">Bárbaro</div>
            <div class="option" data-category="luchador" data-class="Ranger">Ranger</div>
            <div class="option" data-category="luchador" data-class="Guerrero">Guerrero</div>
            <div class="option" data-category="luchador" data-class="Paladín">Paladín</div>
            <div class="option" data-category="luchador" data-class="Samurái">Samurái</div>
            <div class="option" data-category="sacerdote" data-class="Clérigo">Clérigo</div>
            <div class="option" data-category="sacerdote" data-class="Druida">Druida</div>
            <div class="option" data-category="sacerdote" data-class="Chamán">Chamán</div>
            <div class="option" data-category="hechicero" data-class="Mago">Mago</div>
            <div class="option" data-category="hechicero" data-class="Hechicero">Hechicero</div>
            <div class="option" data-category="hechicero" data-class="Bruja">Bruja</div>
            <div class="option" data-category="hechicero" data-class="Artífice">Artífice</div>
            <div class="option" data-category="bribon" data-class="Ladrón">Ladrón</div>
            <div class="option" data-category="bribon" data-class="Bardo">Bardo</div>
            <div class="option" data-category="bribon" data-class="Ninja">Ninja</div>
            <div class="option" data-category="bribon" data-class="Psiónico">Psiónico</div>
            <div class="option" data-category="bribon" data-class="Pistolero">Pistolero</div>
        </div>
    </div>
</div>

<div class="category-selector">
    <h4 class="category-title" style="text-align: center;">⚔️ Categoría Secundaria</h4>
    <div class="custom-dropdown-container">
        <div class="dropdown-header category-option disabled" id="secondary-dropdown-header">
            <h5 class="category-name" id="secondary-selected-name" style="color: #b0b0b0; font-style: italic; text-align: center; margin: 0;">Selecciona primero una categoría principal</h5>
            <span class="category-desc" id="secondary-selected-desc"></span>
        </div>
        <div class="dropdown-options" id="secondary-dropdown-options">
            </div>
    </div>
</div>

<div class="category-selector">
    <h4 class="category-title" style="text-align: center;">✨ Categoría Terciaria</h4>
    <div class="custom-dropdown-container">
        <div class="dropdown-header category-option disabled" id="tertiary-dropdown-header">
            <h5 class="category-name" id="tertiary-selected-name" style="color: #b0b0b0; font-style: italic; text-align: center; margin: 0;">Selecciona primero una categoría secundaria</h5>
            <span class="category-desc" id="tertiary-selected-desc"></span>
        </div>
        <div class="dropdown-options" id="tertiary-dropdown-options">
            </div>
    </div>
</div>

<style>
/* Estilos para el nuevo menú desplegable personalizado */
.custom-dropdown-container {
    position: relative;
    width: 100%;
}

.dropdown-header {
    cursor: pointer;
    transition: background-color 0.3s;
    text-align: center;
    padding: 0.5rem 1.5rem;
}

.dropdown-header:hover {
    background-color: #3b4252;
}

.dropdown-header.disabled {
    cursor: not-allowed;
    background-color: #2b303b;
    opacity: 0.5;
}

.dropdown-options {
    position: absolute;
    top: 100%;
    left: 0;
    width: 100%;
    background-color: #2b303b;
    border: 1px solid #4a5464;
    border-top: none;
    z-index: 5;
    max-height: 0;
    overflow-y: auto;
    transition: max-height 0.3s ease-in-out;
}

.dropdown-options.show {
    max-height: 500px;
}

.option {
    padding: 0.4rem 1.5rem;
    cursor: pointer;
    transition: background-color 0.2s;
    border-bottom: 1px solid #2b303b;
    text-align: center;
}

.option:hover {
    background-color: #4a5464;
}
</style>

<script>
    // Mapeo de categorías y clases principales
    const categories = {
        primary: [
            { id: 'luchador', name: 'Luchador', classes: ['Bárbaro', 'Ranger', 'Guerrero', 'Paladín', 'Samurái'] },
            { id: 'sacerdote', name: 'Sacerdote', classes: ['Clérigo', 'Druida', 'Chamán'] },
            { id: 'hechicero', name: 'Hechicero', classes: ['Mago', 'Hechicero', 'Bruja', 'Artífice'] },
            { id: 'bribon', name: 'Bribón', classes: ['Ladrón', 'Bardo', 'Ninja', 'Psiónico', 'Pistolero'] }
        ]
    };

    function setupDropdown(headerId, optionsId, selectedNameId, onSelectionCallback) {
        const header = document.getElementById(headerId);
        const options = document.getElementById(optionsId);
        const selectedName = document.getElementById(selectedNameId);

        if (!header || !options || !selectedName) return;

        header.addEventListener('click', () => {
            if (!header.classList.contains('disabled')) {
                options.classList.toggle('show');
            }
        });

        document.addEventListener('click', (e) => {
            if (!header.contains(e.target) && !options.contains(e.target)) {
                options.classList.remove('show');
            }
        });

        options.addEventListener('click', (e) => {
            const target = e.target.closest('.option');
            if (target) {
                const selectedClass = target.getAttribute('data-class');
                const categoryId = target.getAttribute('data-category');

                if (selectedClass === 'Ninguno') {
                    selectedName.textContent = 'Selecciona una clase';
                    selectedName.style.color = '#b0b0b0';
                    selectedName.style.fontStyle = 'italic';
                } else {
                    selectedName.textContent = selectedClass;
                    selectedName.style.color = 'inherit';
                    selectedName.style.fontStyle = 'normal';
                }

                options.classList.remove('show');
                
                if (onSelectionCallback) {
                    onSelectionCallback(categoryId);
                }
            }
        });
    }

    function populateDropdown(optionsContainerId, classList) {
        const container = document.getElementById(optionsContainerId);
        container.innerHTML = '';

        const emptyOption = document.createElement('div');
        emptyOption.className = 'option';
        emptyOption.setAttribute('data-category', '');
        emptyOption.setAttribute('data-class', 'Ninguno');
        emptyOption.textContent = 'Ninguno';
        container.appendChild(emptyOption);

        classList.forEach(cls => {
            const optionDiv = document.createElement('div');
            optionDiv.className = 'option';
            optionDiv.setAttribute('data-category', cls.categoryId);
            optionDiv.setAttribute('data-class', cls.name);
            optionDiv.textContent = cls.name;
            container.appendChild(optionDiv);
        });
    }

    function handlePrimarySelection(categoryId) {
        // Habilita el menú secundario
        const secondaryHeader = document.getElementById('secondary-dropdown-header');
        const secondarySelectedName = document.getElementById('secondary-selected-name');
        
        secondaryHeader.classList.remove('disabled');
        secondarySelectedName.textContent = 'Selecciona una clase';
        secondarySelectedName.style.color = '#b0b0b0';
        secondarySelectedName.style.fontStyle = 'italic';
        
        const secondaryClasses = categories.primary.flatMap(cat => 
            cat.classes.map(cls => ({ name: cls, categoryId: cat.id }))
        );
        populateDropdown('secondary-dropdown-options', secondaryClasses);
        
        // Deshabilita el menú terciario
        const tertiaryHeader = document.getElementById('tertiary-dropdown-header');
        const tertiarySelectedName = document.getElementById('tertiary-selected-name');
        tertiaryHeader.classList.add('disabled');
        tertiarySelectedName.textContent = 'Selecciona primero una categoría secundaria';
        tertiarySelectedName.style.color = '#b0b0b0';
        tertiarySelectedName.style.fontStyle = 'italic';
        document.getElementById('tertiary-dropdown-options').innerHTML = '';
        
        // Mantén tu función original
        selectPrimaryCategory(categoryId);
    }
    
    function handleSecondarySelection(categoryId) {
        // Habilita el menú terciario
        const tertiaryHeader = document.getElementById('tertiary-dropdown-header');
        const tertiarySelectedName = document.getElementById('tertiary-selected-name');
        
        tertiaryHeader.classList.remove('disabled');
        tertiarySelectedName.textContent = 'Selecciona una clase';
        tertiarySelectedName.style.color = '#b0b0b0';
        tertiarySelectedName.style.fontStyle = 'italic';
        
        const tertiaryClasses = categories.primary.flatMap(cat => 
            cat.classes.map(cls => ({ name: cls, categoryId: cat.id }))
        );
        populateDropdown('tertiary-dropdown-options', tertiaryClasses);
        
        // Mantén tu función original
        selectSecondaryCategory(categoryId);
    }
    
    // Configurar cada menú
    setupDropdown('primary-dropdown-header', 'primary-dropdown-options', 'primary-selected-name', handlePrimarySelection);
    setupDropdown('secondary-dropdown-header', 'secondary-dropdown-options', 'secondary-selected-name', handleSecondarySelection);
    setupDropdown('tertiary-dropdown-header', 'tertiary-dropdown-options', 'tertiary-selected-name');

    // Mantenemos la función original para la lógica de tu aplicación
    function selectPrimaryCategory(category) {
        console.log("Activando lógica para la categoría principal: " + category);
        // Aquí puedes agregar tu lógica para actualizar los campos
        // como `gaco`, `salvamentos` y `habilidades`.
    }
    
    function selectSecondaryCategory(category) {
        console.log("Activando lógica para la categoría secundaria: " + category);
    }
</script>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Tab Navigation -->
            <nav class="tab-navigation">
                <button class="tab-btn" onclick="showTab('basic', this)">📋 Básico</button>
                <button class="tab-btn" onclick="showTab('abilities', this)">💪 Habilidades</button>
                <button class="tab-btn" onclick="showTab('combat', this)">⚔️ Combate</button>
                <button class="tab-btn" onclick="showTab('skills', this)">🎯 Pericias</button>
                <button class="tab-btn" onclick="showTab('spells', this)">✨ Conjuros</button>
                <button class="tab-btn active" onclick="showTab('equipment', this)">🎒 Equipo</button>
            </nav>

            <!-- Basic Info Tab -->
            <div id="basic-tab" class="tab-content">
                <h2 style="color: #ffd700; margin-bottom: 2rem;">📋 Información Básica</h2>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">Nombre del Personaje</label>
                        <input type="text" class="form-input" id="characterName" placeholder="Ej: Nombre del Personaje" onchange="updateCharacterDisplay()">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Jugador</label>
                        <input type="text" class="form-input" id="playerName" placeholder="Tu nombre">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Raza</label>
                        <select class="form-input" id="race" onchange="updateCharacterDisplay()">
                            <option value="">Selecciona Raza</option>
                            <option value="humano">Humano</option>
                            <option value="elfo">Elfo</option>
                            <option value="enano">Enano</option>
                            <option value="mediano">Mediano</option>
                            <option value="orco">Orco</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Alineamiento</label>
                        <select class="form-input" id="alignment">
                            <option value="LB">Legal Bueno</option>
                            <option value="NB">Neutral Bueno</option>
                            <option value="CB">Caótico Bueno</option>
                            <option value="LN">Legal Neutral</option>
                            <option value="N" selected>Neutral Auténtico</option>
                            <option value="CN">Caótico Neutral</option>
                            <option value="LM">Legal Malvado</option>
                            <option value="NM">Neutral Malvado</option>
                            <option value="CM">Caótico Malvado</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
    <label class="form-label">Altura (cm)</label>
    <input type="number" class="form-input" id="characterHeight" min="1" max="30000" placeholder="Ej: 175" onchange="updateCharacterSize()">
</div>

<div class="form-group">
    <label class="form-label">Tamaño</label>
    <input type="text" class="form-input" id="characterSize" value="Mediano" readonly>
</div>

<div class="form-group">
    <label class="form-label">Religión</label>
    <select class="form-input" id="religion">
        <option value="">Sin religión</option>
        <option value="ao">Ao (El Oculto)</option>
        <option value="lathander">Lathander</option>
        <option value="gond">Gond</option>
        <option value="tyr">Tyr</option>
        <option value="helm">Helm</option>
        <option value="tempus">Tempus</option>
        <option value="mystra">Mystra</option>
        <option value="selune">Selûne</option>
        <option value="shar">Shar</option>
        <option value="cyric">Cyric</option>
        <option value="bane">Bane</option>
        <option value="bhaal">Bhaal</option>
        <option value="myrkul">Myrkul</option>
        <option value="kelemvor">Kelemvor</option>
        <option value="otro">Otro</option>
    </select>
</div>
                    <div class="form-group">
                        <label class="form-label">Experiencia</label>
                        <input type="number" class="form-input" id="experience" value="0" onchange="updateFromXP()">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Nivel</label>
                        <input type="number" class="form-input" id="Level" value="1" onchange="updateFromXP()">
                    </div>
                </div>

                <!-- Quick Stats Display -->
                <div class="stats-row">
                    <div class="stat-card">
                        <div class="stat-value" id="totalHP">10</div>
                        <div class="stat-label">Puntos de Golpe</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="armorClass">10</div>
                        <div class="stat-label">Clase de Armadura</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="gaco">20</div>
                        <div class="stat-label">GACO</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="initiative">+0</div>
                        <div class="stat-label">Iniciativa</div>
                    </div>
                </div>
            </div>

... <!-- Abilities Tab --> 
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AD&D 2nd Edition - Características</title>
    <style>
        body {
            background: linear-gradient(135deg, #0c1421 0%, #1e2a3a 100%);
            color: #e5e5e5;
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Estilos para la cuadrícula de habilidades */
        .abilities-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
            margin-top: 2rem;
            padding: 0 1rem;
        }

        .ability-card {
            background-color: #2b303b;
            border-radius: 12px;
            padding: 1rem 1.5rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: 0.5rem;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            width: 100%;
            box-sizing: border-box;
        }

        .ability-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.6);
        }

        .ability-name {
            font-size: 1.2rem;
            font-weight: bold;
            color: #ffd700;
            text-align: left;
            width: 100%;
        }

        .ability-main-row {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            width: 100%;
        }

        .ability-input {
            width: 80px;
            font-size: 2.2rem;
            font-weight: bold;
            text-align: center;
            background: transparent;
            border: none;
            color: #e5e5e5;
            appearance: none;
            border-bottom: 2px solid #4a5464;
            padding-bottom: 5px;
            flex-shrink: 0;
        }

        .ability-input:focus {
            outline: none;
            border-bottom-color: #ffd700;
        }

        .ability-input::-webkit-outer-spin-button,
        .ability-input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .ability-details-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 0.8rem;
            width: 100%;
            min-height: 40px;
        }

        .ability-detail-box {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 0.2rem;
            text-align: center;
            padding: 0.5rem 0.8rem;
            background-color: #16213e;
            border: 1px solid #4a5464;
            border-radius: 8px;
            min-width: 80px;
        }

        .detail-name {
            font-size: 0.8rem;
            color: #b0b0b0;
            white-space: nowrap;
        }

        .detail-value {
            font-size: 1.1rem;
            font-weight: bold;
            color: #e5e5e5;
            white-space: nowrap;
        }

        .detail-value.positive {
            color: #4CAF50;
        }

        .detail-value.negative {
            color: #f44336;
        }

        h2 {
            text-align: center;
            margin-bottom: 2rem;
        }

        .debug-info {
            background-color: #1a1a1a;
            border: 1px solid #333;
            padding: 10px;
            margin: 20px 0;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            color: #ccc;
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="abilities-tab" class="tab-content">
            <h2 style="color: #ffd700; margin-bottom: 2rem;">💪 Características</h2>
            
            <!-- Debug info para verificar que los datos se cargan -->
            <div class="debug-info" id="debug-info">
                Status: Cargando datos...
            </div>
            
            <div class="abilities-grid">
                <div class="ability-card">
                    <div class="ability-name">Fuerza</div>
                    <div class="ability-main-row">
                        <input type="number" class="ability-input" id="strength" min="1" max="65" value="10" oninput="window.AbilityCalculator.calculateModifiers()">
                        <div class="ability-details-row">
                            <div class="ability-detail-box">
                                <span class="detail-name">Golpe</span>
                                <span class="detail-value" id="str-hit-prob">+0</span>
                            </div>
                            <div class="ability-detail-box">
                                <span class="detail-name">Daño</span>
                                <span class="detail-value" id="str-damage-adj">+0</span>
                            </div>
                            <div class="ability-detail-box">
                                <span class="detail-name">Peso</span>
                                <span class="detail-value" id="str-weight-cap">0kg</span>
                            </div>
                            <div class="ability-detail-box">
                                <span class="detail-name">Esf. Máx.</span>
                                <span class="detail-value" id="str-max-effort">0kg</span>
                            </div>
                            <div class="ability-detail-box">
                                <span class="detail-name">Puertas</span>
                                <span class="detail-value" id="str-open-doors">0</span>
                            </div>
                            <div class="ability-detail-box">
                                <span class="detail-name">Barras</span>
                                <span class="detail-value" id="str-bend-bar">0%</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="ability-card">
                    <div class="ability-name">Destreza</div>
                    <div class="ability-main-row">
                        <input type="number" class="ability-input" id="dexterity" min="1" max="65" value="10" oninput="window.AbilityCalculator.calculateModifiers()">
                        <div class="ability-details-row">
                            <div class="ability-detail-box">
                                <span class="detail-name">Ajuste Reacción</span>
                                <span class="detail-value" id="dex-reaction">0</span>
                            </div>
                            <div class="ability-detail-box">
                                <span class="detail-name">Atq. Proyectiles</span>
                                <span class="detail-value" id="dex-missile">0</span>
                            </div>
                            <div class="ability-detail-box">
                                <span class="detail-name">Def. CA</span>
                                <span class="detail-value" id="dex-defensive">0</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="ability-card">
                    <div class="ability-name">Constitución</div>
                    <div class="ability-main-row">
                        <input type="number" class="ability-input" id="constitution" min="1" max="65" value="10" oninput="window.AbilityCalculator.calculateModifiers()">
                        <div class="ability-details-row">
                            <div class="ability-detail-box">
                                <span class="detail-name">HP/Nivel</span>
                                <span class="detail-value" id="con-hp-bonus">0</span>
                            </div>
                            <div class="ability-detail-box">
                                <span class="detail-name">Shock Sistema</span>
                                <span class="detail-value" id="con-shock-survival">0%</span>
                            </div>
                            <div class="ability-detail-box">
                                <span class="detail-name">Superv. Revivir</span>
                                <span class="detail-value" id="con-resurrection">0%</span>
                            </div>
                            <div class="ability-detail-box">
                                <span class="detail-name">Prot. Veneno</span>
                                <span class="detail-value" id="con-poison">0</span>
                            </div>
                            <div class="ability-detail-box">
                                <span class="detail-name">Regeneración</span>
                                <span class="detail-value" id="con-regeneration">--</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="ability-card">
                    <div class="ability-name">Inteligencia</div>
                    <div class="ability-main-row">
                        <input type="number" class="ability-input" id="intelligence" min="1" max="65" value="10" oninput="window.AbilityCalculator.calculateModifiers()">
                        <div class="ability-details-row">
                            <div class="ability-detail-box">
                                <span class="detail-name">Idiomas</span>
                                <span class="detail-value" id="int-languages">0</span>
                            </div>
                            <div class="ability-detail-box">
                                <span class="detail-name">Niv. Conjuros</span>
                                <span class="detail-value" id="int-spell-level">0</span>
                            </div>
                            <div class="ability-detail-box">
                                <span class="detail-name">Oport. Conjuros</span>
                                <span class="detail-value" id="int-spell-chance">0%</span>
                            </div>
                            <div class="ability-detail-box">
                                <span class="detail-name">Max Conjuros</span>
                                <span class="detail-value" id="int-max-spells">0</span>
                            </div>
                            <div class="ability-detail-box">
                                <span class="detail-name">Inmunidad</span>
                                <span class="detail-value" id="int-immunity">--</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="ability-card">
                    <div class="ability-name">Sabiduría</div>
                    <div class="ability-main-row">
                        <input type="number" class="ability-input" id="wisdom" min="1" max="65" value="10" oninput="window.AbilityCalculator.calculateModifiers()">
                        <div class="ability-details-row">
                            <div class="ability-detail-box">
                                <span class="detail-name">Def. Mágica</span>
                                <span class="detail-value" id="wis-magic-defense">0</span>
                            </div>
                            <div class="ability-detail-box">
                                <span class="detail-name">Bonif. Conjuros</span>
                                <span class="detail-value" id="wis-spell-bonus">0</span>
                            </div>
                            <div class="ability-detail-box">
                                <span class="detail-name">Fracaso Conjuro</span>
                                <span class="detail-value" id="wis-spell-failure">0%</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="ability-card">
                    <div class="ability-name">Carisma</div>
                    <div class="ability-main-row">
                        <input type="number" class="ability-input" id="charisma" min="1" max="65" value="10" oninput="window.AbilityCalculator.calculateModifiers()">
                        <div class="ability-details-row">
                            <div class="ability-detail-box">
                                <span class="detail-name">N° Servidores</span>
                                <span class="detail-value" id="cha-max-servers">0</span>
                            </div>
                            <div class="ability-detail-box">
                                <span class="detail-name">Lealtad Base</span>
                                <span class="detail-value" id="cha-base-loyalty">0</span>
                            </div>
                            <div class="ability-detail-box">
                                <span class="detail-name">Ajuste Reacción</span>
                                <span class="detail-value" id="cha-reaction-adj">0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Envolvemos todo en un namespace global para evitar conflictos
        window.AbilityCalculator = (function() {
            
            // Datos de habilidades (mismo JSON que tienes)
            const abilityData = {
            "fuerza": [
                {"Punt. Habilidad": "1", "Probab. de Golpe": "-5", "Ajuste de daño": "-4", "Peso Kg autorizado": "0,5", "Esfuerzo máximo Kg": "1,5", "Abrir Puertas": "1", "Doblar Barras": "0%"},
                {"Punt. Habilidad": "2", "Probab. de Golpe": "-3", "Ajuste de daño": "-2", "Peso Kg autorizado": "0,5", "Esfuerzo máximo Kg": "2,5", "Abrir Puertas": "1", "Doblar Barras": "0%"},
                {"Punt. Habilidad": "3", "Probab. de Golpe": "-3", "Ajuste de daño": "-1", "Peso Kg autorizado": "2,5", "Esfuerzo máximo Kg": "5", "Abrir Puertas": "2", "Doblar Barras": "0%"},
                {"Punt. Habilidad": "4", "Probab. de Golpe": "-2", "Ajuste de daño": "-1", "Peso Kg autorizado": "5", "Esfuerzo máximo Kg": "23", "Abrir Puertas": "3", "Doblar Barras": "0%"},
                {"Punt. Habilidad": "5", "Probab. de Golpe": "-2", "Ajuste de daño": "-1", "Peso Kg autorizado": "5", "Esfuerzo máximo Kg": "23", "Abrir Puertas": "3", "Doblar Barras": "0%"},
                {"Punt. Habilidad": "6", "Probab. de Golpe": "-1", "Ajuste de daño": "0", "Peso Kg autorizado": "10", "Esfuerzo máximo Kg": "28", "Abrir Puertas": "4", "Doblar Barras": "0%"},
                {"Punt. Habilidad": "7", "Probab. de Golpe": "-1", "Ajuste de daño": "0", "Peso Kg autorizado": "10", "Esfuerzo máximo Kg": "28", "Abrir Puertas": "4", "Doblar Barras": "0%"},
                {"Punt. Habilidad": "8", "Probab. de Golpe": "0", "Ajuste de daño": "0", "Peso Kg autorizado": "18", "Esfuerzo máximo Kg": "45", "Abrir Puertas": "5", "Doblar Barras": "1%"},
                {"Punt. Habilidad": "9", "Probab. de Golpe": "0", "Ajuste de daño": "0", "Peso Kg autorizado": "18", "Esfuerzo máximo Kg": "45", "Abrir Puertas": "5", "Doblar Barras": "1%"},
                {"Punt. Habilidad": "10", "Probab. de Golpe": "0", "Ajuste de daño": "0", "Peso Kg autorizado": "20", "Esfuerzo máximo Kg": "58", "Abrir Puertas": "6", "Doblar Barras": "2%"},
                {"Punt. Habilidad": "11", "Probab. de Golpe": "0", "Ajuste de daño": "0", "Peso Kg autorizado": "20", "Esfuerzo máximo Kg": "58", "Abrir Puertas": "6", "Doblar Barras": "2%"},
                {"Punt. Habilidad": "12", "Probab. de Golpe": "0", "Ajuste de daño": "0", "Peso Kg autorizado": "23", "Esfuerzo máximo Kg": "70", "Abrir Puertas": "7", "Doblar Barras": "4%"},
                {"Punt. Habilidad": "13", "Probab. de Golpe": "0", "Ajuste de daño": "0", "Peso Kg autorizado": "23", "Esfuerzo máximo Kg": "70", "Abrir Puertas": "7", "Doblar Barras": "4%"},
                {"Punt. Habilidad": "14", "Probab. de Golpe": "0", "Ajuste de daño": "0", "Peso Kg autorizado": "28", "Esfuerzo máximo Kg": "85", "Abrir Puertas": "8", "Doblar Barras": "7%"},
                {"Punt. Habilidad": "15", "Probab. de Golpe": "0", "Ajuste de daño": "0", "Peso Kg autorizado": "28", "Esfuerzo máximo Kg": "85", "Abrir Puertas": "8", "Doblar Barras": "7%"},
                {"Punt. Habilidad": "16", "Probab. de Golpe": "0", "Ajuste de daño": "1", "Peso Kg autorizado": "35", "Esfuerzo máximo Kg": "98", "Abrir Puertas": "9", "Doblar Barras": "10%"},
                {"Punt. Habilidad": "17", "Probab. de Golpe": "1", "Ajuste de daño": "1", "Peso Kg autorizado": "43", "Esfuerzo máximo Kg": "110", "Abrir Puertas": "10", "Doblar Barras": "13%"},
                {"Punt. Habilidad": "18", "Probab. de Golpe": "1", "Ajuste de daño": "2", "Peso Kg autorizado": "55", "Esfuerzo máximo Kg": "130", "Abrir Puertas": "11", "Doblar Barras": "16%"},
                {"Punt. Habilidad": "18/00 ", "Probab. de Golpe": "3", "Ajuste de daño": "6", "Peso Kg autorizado": "170", "Esfuerzo máximo Kg": "240", "Abrir Puertas": "16(6)", "Doblar Barras": "40%"},
                {"Punt. Habilidad": "19", "Probab. de Golpe": "3", "Ajuste de daño": "7", "Peso Kg autorizado": "245", "Esfuerzo máximo Kg": "320", "Abrir Puertas": "16(8)", "Doblar Barras": "50%"},
                {"Punt. Habilidad": "20", "Probab. de Golpe": "3", "Ajuste de daño": "8", "Peso Kg autorizado": "270", "Esfuerzo máximo Kg": "350", "Abrir Puertas": "17(10)", "Doblar Barras": "60%"},
                {"Punt. Habilidad": "21", "Probab. de Golpe": "4", "Ajuste de daño": "9", "Peso Kg autorizado": "320", "Esfuerzo máximo Kg": "405", "Abrir Puertas": "17(12)", "Doblar Barras": "70%"},
                {"Punt. Habilidad": "22", "Probab. de Golpe": "4", "Ajuste de daño": "10", "Peso Kg autorizado": "395", "Esfuerzo máximo Kg": "485", "Abrir Puertas": "18(14)", "Doblar Barras": "80%"},
                {"Punt. Habilidad": "23", "Probab. de Golpe": "5", "Ajuste de daño": "11", "Peso Kg autorizado": "470", "Esfuerzo máximo Kg": "565", "Abrir Puertas": "18(16)", "Doblar Barras": "90%"},
                {"Punt. Habilidad": "24", "Probab. de Golpe": "6", "Ajuste de daño": "12", "Peso Kg autorizado": "620", "Esfuerzo máximo Kg": "720", "Abrir Puertas": "19(17)", "Doblar Barras": "95%"},
                {"Punt. Habilidad": "25", "Probab. de Golpe": "7", "Ajuste de daño": "14", "Peso Kg autorizado": "770", "Esfuerzo máximo Kg": "875", "Abrir Puertas": "19(18)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "26", "Probab. de Golpe": "8", "Ajuste de daño": "16", "Peso Kg autorizado": "920", "Esfuerzo máximo Kg": "1030", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "27", "Probab. de Golpe": "9", "Ajuste de daño": "18", "Peso Kg autorizado": "1070", "Esfuerzo máximo Kg": "1185", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "28", "Probab. de Golpe": "10", "Ajuste de daño": "20", "Peso Kg autorizado": "1220", "Esfuerzo máximo Kg": "1340", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "29", "Probab. de Golpe": "11", "Ajuste de daño": "22", "Peso Kg autorizado": "1370", "Esfuerzo máximo Kg": "1495", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "30", "Probab. de Golpe": "12", "Ajuste de daño": "24", "Peso Kg autorizado": "1520", "Esfuerzo máximo Kg": "1650", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "31", "Probab. de Golpe": "13", "Ajuste de daño": "26", "Peso Kg autorizado": "1670", "Esfuerzo máximo Kg": "1805", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "32", "Probab. de Golpe": "14", "Ajuste de daño": "28", "Peso Kg autorizado": "1820", "Esfuerzo máximo Kg": "1960", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "33", "Probab. de Golpe": "15", "Ajuste de daño": "30", "Peso Kg autorizado": "1970", "Esfuerzo máximo Kg": "2115", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "34", "Probab. de Golpe": "16", "Ajuste de daño": "32", "Peso Kg autorizado": "2120", "Esfuerzo máximo Kg": "2270", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "35", "Probab. de Golpe": "17", "Ajuste de daño": "34", "Peso Kg autorizado": "2270", "Esfuerzo máximo Kg": "2425", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "36", "Probab. de Golpe": "18", "Ajuste de daño": "36", "Peso Kg autorizado": "2420", "Esfuerzo máximo Kg": "2580", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "37", "Probab. de Golpe": "19", "Ajuste de daño": "38", "Peso Kg autorizado": "2570", "Esfuerzo máximo Kg": "2735", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "38", "Probab. de Golpe": "20", "Ajuste de daño": "40", "Peso Kg autorizado": "2720", "Esfuerzo máximo Kg": "2890", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "39", "Probab. de Golpe": "21", "Ajuste de daño": "42", "Peso Kg autorizado": "2870", "Esfuerzo máximo Kg": "3045", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "40", "Probab. de Golpe": "22", "Ajuste de daño": "44", "Peso Kg autorizado": "3020", "Esfuerzo máximo Kg": "3200", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "41", "Probab. de Golpe": "23", "Ajuste de daño": "46", "Peso Kg autorizado": "3170", "Esfuerzo máximo Kg": "3355", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "42", "Probab. de Golpe": "24", "Ajuste de daño": "48", "Peso Kg autorizado": "3320", "Esfuerzo máximo Kg": "3510", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "43", "Probab. de Golpe": "25", "Ajuste de daño": "50", "Peso Kg autorizado": "3470", "Esfuerzo máximo Kg": "3665", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "44", "Probab. de Golpe": "26", "Ajuste de daño": "52", "Peso Kg autorizado": "3620", "Esfuerzo máximo Kg": "3820", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "45", "Probab. de Golpe": "27", "Ajuste de daño": "54", "Peso Kg autorizado": "3770", "Esfuerzo máximo Kg": "3975", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "46", "Probab. de Golpe": "28", "Ajuste de daño": "56", "Peso Kg autorizado": "3920", "Esfuerzo máximo Kg": "4130", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "47", "Probab. de Golpe": "29", "Ajuste de daño": "58", "Peso Kg autorizado": "4070", "Esfuerzo máximo Kg": "4285", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "48", "Probab. de Golpe": "30", "Ajuste de daño": "60", "Peso Kg autorizado": "4220", "Esfuerzo máximo Kg": "4440", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "49", "Probab. de Golpe": "31", "Ajuste de daño": "62", "Peso Kg autorizado": "4370", "Esfuerzo máximo Kg": "4595", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "50", "Probab. de Golpe": "32", "Ajuste de daño": "64", "Peso Kg autorizado": "4520", "Esfuerzo máximo Kg": "4750", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "51", "Probab. de Golpe": "33", "Ajuste de daño": "66", "Peso Kg autorizado": "4670", "Esfuerzo máximo Kg": "4905", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "52", "Probab. de Golpe": "34", "Ajuste de daño": "68", "Peso Kg autorizado": "4820", "Esfuerzo máximo Kg": "5060", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "53", "Probab. de Golpe": "35", "Ajuste de daño": "70", "Peso Kg autorizado": "4970", "Esfuerzo máximo Kg": "5215", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "54", "Probab. de Golpe": "36", "Ajuste de daño": "72", "Peso Kg autorizado": "5120", "Esfuerzo máximo Kg": "5370", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "55", "Probab. de Golpe": "37", "Ajuste de daño": "74", "Peso Kg autorizado": "5270", "Esfuerzo máximo Kg": "5525", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "56", "Probab. de Golpe": "38", "Ajuste de daño": "76", "Peso Kg autorizado": "5420", "Esfuerzo máximo Kg": "5680", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "57", "Probab. de Golpe": "39", "Ajuste de daño": "78", "Peso Kg autorizado": "5570", "Esfuerzo máximo Kg": "5835", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "58", "Probab. de Golpe": "40", "Ajuste de daño": "80", "Peso Kg autorizado": "5720", "Esfuerzo máximo Kg": "5990", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "59", "Probab. de Golpe": "41", "Ajuste de daño": "82", "Peso Kg autorizado": "5870", "Esfuerzo máximo Kg": "6145", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "60", "Probab. de Golpe": "42", "Ajuste de daño": "84", "Peso Kg autorizado": "6020", "Esfuerzo máximo Kg": "6300", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "61", "Probab. de Golpe": "43", "Ajuste de daño": "86", "Peso Kg autorizado": "6170", "Esfuerzo máximo Kg": "6455", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "62", "Probab. de Golpe": "44", "Ajuste de daño": "88", "Peso Kg autorizado": "6320", "Esfuerzo máximo Kg": "6610", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "63", "Probab. de Golpe": "45", "Ajuste de daño": "90", "Peso Kg autorizado": "6470", "Esfuerzo máximo Kg": "6765", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "64", "Probab. de Golpe": "46", "Ajuste de daño": "92", "Peso Kg autorizado": "6620", "Esfuerzo máximo Kg": "6920", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
                {"Punt. Habilidad": "65", "Probab. de Golpe": "47", "Ajuste de daño": "94", "Peso Kg autorizado": "6770", "Esfuerzo máximo Kg": "7075", "Abrir Puertas": "19(19)", "Doblar Barras": "99%"},
            ],
            "destreza": [
                {"Puntuación habilidad": "1", "Ajuste reacción": "-6", "Ajuste Atq Proyectiles": "-6", "Ajuste defensivo": "5"},
                {"Puntuación habilidad": "2", "Ajuste reacción": "-4", "Ajuste Atq Proyectiles": "-4", "Ajuste defensivo": "5"},
                {"Puntuación habilidad": "3", "Ajuste reacción": "-3", "Ajuste Atq Proyectiles": "-3", "Ajuste defensivo": "4"},
                {"Puntuación habilidad": "4", "Ajuste reacción": "-2", "Ajuste Atq Proyectiles": "-2", "Ajuste defensivo": "3"},
                {"Puntuación habilidad": "5", "Ajuste reacción": "-1", "Ajuste Atq Proyectiles": "-1", "Ajuste defensivo": "2"},
                {"Puntuación habilidad": "6", "Ajuste reacción": "0", "Ajuste Atq Proyectiles": "0", "Ajuste defensivo": "1"},
                {"Puntuación habilidad": "7", "Ajuste reacción": "0", "Ajuste Atq Proyectiles": "0", "Ajuste defensivo": "0"},
                {"Puntuación habilidad": "8", "Ajuste reacción": "0", "Ajuste Atq Proyectiles": "0", "Ajuste defensivo": "0"},
                {"Puntuación habilidad": "9", "Ajuste reacción": "0", "Ajuste Atq Proyectiles": "0", "Ajuste defensivo": "0"},
                {"Puntuación habilidad": "10", "Ajuste reacción": "0", "Ajuste Atq Proyectiles": "0", "Ajuste defensivo": "0"},
                {"Puntuación habilidad": "11", "Ajuste reacción": "0", "Ajuste Atq Proyectiles": "0", "Ajuste defensivo": "0"},
                {"Puntuación habilidad": "12", "Ajuste reacción": "0", "Ajuste Atq Proyectiles": "0", "Ajuste defensivo": "0"},
                {"Puntuación habilidad": "13", "Ajuste reacción": "0", "Ajuste Atq Proyectiles": "0", "Ajuste defensivo": "0"},
                {"Puntuación habilidad": "14", "Ajuste reacción": "0", "Ajuste Atq Proyectiles": "0", "Ajuste defensivo": "0"},
                {"Puntuación habilidad": "15", "Ajuste reacción": "0", "Ajuste Atq Proyectiles": "0", "Ajuste defensivo": "1"},
                {"Puntuación habilidad": "16", "Ajuste reacción": "1", "Ajuste Atq Proyectiles": "1", "Ajuste defensivo": "2"},
                {"Puntuación habilidad": "17", "Ajuste reacción": "2", "Ajuste Atq Proyectiles": "2", "Ajuste defensivo": "3"},
                {"Puntuación habilidad": "18", "Ajuste reacción": "2", "Ajuste Atq Proyectiles": "2", "Ajuste defensivo": "4"},
                {"Puntuación habilidad": "19", "Ajuste reacción": "3", "Ajuste Atq Proyectiles": "3", "Ajuste defensivo": "4"},
                {"Puntuación habilidad": "20", "Ajuste reacción": "3", "Ajuste Atq Proyectiles": "3", "Ajuste defensivo": "4"},
                {"Puntuación habilidad": "21", "Ajuste reacción": "3", "Ajuste Atq Proyectiles": "3", "Ajuste defensivo": "4"},
                {"Puntuación habilidad": "22", "Ajuste reacción": "4", "Ajuste Atq Proyectiles": "4", "Ajuste defensivo": "5"},
                {"Puntuación habilidad": "23", "Ajuste reacción": "4", "Ajuste Atq Proyectiles": "4", "Ajuste defensivo": "5"},
                {"Puntuación habilidad": "24", "Ajuste reacción": "4", "Ajuste Atq Proyectiles": "4", "Ajuste defensivo": "5"},
                {"Puntuación habilidad": "25", "Ajuste reacción": "5", "Ajuste Atq Proyectiles": "5", "Ajuste defensivo": "6"},
                {"Puntuación habilidad": "26", "Ajuste reacción": "5", "Ajuste Atq Proyectiles": "5", "Ajuste defensivo": "6"},
                {"Puntuación habilidad": "27", "Ajuste reacción": "5", "Ajuste Atq Proyectiles": "5", "Ajuste defensivo": "6"},
                {"Puntuación habilidad": "28", "Ajuste reacción": "6", "Ajuste Atq Proyectiles": "6", "Ajuste defensivo": "7"},
                {"Puntuación habilidad": "29", "Ajuste reacción": "6", "Ajuste Atq Proyectiles": "6", "Ajuste defensivo": "7"},
                {"Puntuación habilidad": "30", "Ajuste reacción": "6", "Ajuste Atq Proyectiles": "6", "Ajuste defensivo": "7"},
                {"Puntuación habilidad": "31", "Ajuste reacción": "7", "Ajuste Atq Proyectiles": "7", "Ajuste defensivo": "8"},
                {"Puntuación habilidad": "32", "Ajuste reacción": "7", "Ajuste Atq Proyectiles": "7", "Ajuste defensivo": "8"},
                {"Puntuación habilidad": "33", "Ajuste reacción": "8", "Ajuste Atq Proyectiles": "8", "Ajuste defensivo": "9"},
                {"Puntuación habilidad": "34", "Ajuste reacción": "8", "Ajuste Atq Proyectiles": "8", "Ajuste defensivo": "9"},
                {"Puntuación habilidad": "35", "Ajuste reacción": "9", "Ajuste Atq Proyectiles": "9", "Ajuste defensivo": "10"},
                {"Puntuación habilidad": "36", "Ajuste reacción": "9", "Ajuste Atq Proyectiles": "9", "Ajuste defensivo": "10"},
                {"Puntuación habilidad": "37", "Ajuste reacción": "10", "Ajuste Atq Proyectiles": "10", "Ajuste defensivo": "11"},
                {"Puntuación habilidad": "38", "Ajuste reacción": "10", "Ajuste Atq Proyectiles": "10", "Ajuste defensivo": "11"},
                {"Puntuación habilidad": "39", "Ajuste reacción": "11", "Ajuste Atq Proyectiles": "11", "Ajuste defensivo": "12"},
                {"Puntuación habilidad": "40", "Ajuste reacción": "11", "Ajuste Atq Proyectiles": "11", "Ajuste defensivo": "12"},
                {"Puntuación habilidad": "41", "Ajuste reacción": "12", "Ajuste Atq Proyectiles": "12", "Ajuste defensivo": "13"},
                {"Puntuación habilidad": "42", "Ajuste reacción": "13", "Ajuste Atq Proyectiles": "13", "Ajuste defensivo": "14"},
                {"Puntuación habilidad": "43", "Ajuste reacción": "14", "Ajuste Atq Proyectiles": "14", "Ajuste defensivo": "15"},
                {"Puntuación habilidad": "44", "Ajuste reacción": "15", "Ajuste Atq Proyectiles": "15", "Ajuste defensivo": "16"},
                {"Puntuación habilidad": "45", "Ajuste reacción": "16", "Ajuste Atq Proyectiles": "16", "Ajuste defensivo": "17"},
                {"Puntuación habilidad": "46", "Ajuste reacción": "17", "Ajuste Atq Proyectiles": "17", "Ajuste defensivo": "18"},
                {"Puntuación habilidad": "47", "Ajuste reacción": "18", "Ajuste Atq Proyectiles": "18", "Ajuste defensivo": "19"},
                {"Puntuación habilidad": "48", "Ajuste reacción": "19", "Ajuste Atq Proyectiles": "19", "Ajuste defensivo": "20"},
                {"Puntuación habilidad": "49", "Ajuste reacción": "20", "Ajuste Atq Proyectiles": "20", "Ajuste defensivo": "21"},
                {"Puntuación habilidad": "50", "Ajuste reacción": "21", "Ajuste Atq Proyectiles": "21", "Ajuste defensivo": "22"},
                {"Puntuación habilidad": "51", "Ajuste reacción": "22", "Ajuste Atq Proyectiles": "22", "Ajuste defensivo": "23"},
                {"Puntuación habilidad": "52", "Ajuste reacción": "23", "Ajuste Atq Proyectiles": "23", "Ajuste defensivo": "24"},
                {"Puntuación habilidad": "53", "Ajuste reacción": "24", "Ajuste Atq Proyectiles": "24", "Ajuste defensivo": "25"},
                {"Puntuación habilidad": "54", "Ajuste reacción": "25", "Ajuste Atq Proyectiles": "25", "Ajuste defensivo": "26"},
                {"Puntuación habilidad": "55", "Ajuste reacción": "26", "Ajuste Atq Proyectiles": "26", "Ajuste defensivo": "27"},
                {"Puntuación habilidad": "56", "Ajuste reacción": "27", "Ajuste Atq Proyectiles": "27", "Ajuste defensivo": "28"},
                {"Puntuación habilidad": "57", "Ajuste reacción": "28", "Ajuste Atq Proyectiles": "28", "Ajuste defensivo": "29"},
                {"Puntuación habilidad": "58", "Ajuste reacción": "29", "Ajuste Atq Proyectiles": "29", "Ajuste defensivo": "30"},
                {"Puntuación habilidad": "59", "Ajuste reacción": "30", "Ajuste Atq Proyectiles": "30", "Ajuste defensivo": "31"},
                {"Puntuación habilidad": "60", "Ajuste reacción": "31", "Ajuste Atq Proyectiles": "31", "Ajuste defensivo": "32"},
                {"Puntuación habilidad": "61", "Ajuste reacción": "32", "Ajuste Atq Proyectiles": "32", "Ajuste defensivo": "33"},
                {"Puntuación habilidad": "62", "Ajuste reacción": "33", "Ajuste Atq Proyectiles": "33", "Ajuste defensivo": "34"},
                {"Puntuación habilidad": "63", "Ajuste reacción": "34", "Ajuste Atq Proyectiles": "34", "Ajuste defensivo": "35"},
                {"Puntuación habilidad": "64", "Ajuste reacción": "35", "Ajuste Atq Proyectiles": "35", "Ajuste defensivo": "36"},
                {"Puntuación habilidad": "65", "Ajuste reacción": "36", "Ajuste Atq Proyectiles": "36", "Ajuste defensivo": "37"}
            ],
            "constitucion": [
                {"Puntuación habilidad": "1", "Bonif HP/Nivel": "-3", "Shock de sistema": "10%", "Superv. Revivir": "20%", "Prot. Veneno": "-2", "Regeneración": "--"},
                {"Puntuación habilidad": "2", "Bonif HP/Nivel": "-2", "Shock de sistema": "15%", "Superv. Revivir": "25%", "Prot. Veneno": "-1", "Regeneración": "--"},
                {"Puntuación habilidad": "3", "Bonif HP/Nivel": "-2", "Shock de sistema": "20%", "Superv. Revivir": "30%", "Prot. Veneno": "-1", "Regeneración": "--"},
                {"Puntuación habilidad": "4", "Bonif HP/Nivel": "-1", "Shock de sistema": "25%", "Superv. Revivir": "35%", "Prot. Veneno": "0", "Regeneración": "--"},
                {"Puntuación habilidad": "5", "Bonif HP/Nivel": "-1", "Shock de sistema": "30%", "Superv. Revivir": "40%", "Prot. Veneno": "0", "Regeneración": "--"},
                {"Puntuación habilidad": "6", "Bonif HP/Nivel": "0", "Shock de sistema": "35%", "Superv. Revivir": "45%", "Prot. Veneno": "0", "Regeneración": "--"},
                {"Puntuación habilidad": "7", "Bonif HP/Nivel": "0", "Shock de sistema": "40%", "Superv. Revivir": "50%", "Prot. Veneno": "0", "Regeneración": "--"},
                {"Puntuación habilidad": "8", "Bonif HP/Nivel": "0", "Shock de sistema": "45%", "Superv. Revivir": "55%", "Prot. Veneno": "0", "Regeneración": "--"},
                {"Puntuación habilidad": "9", "Bonif HP/Nivel": "0", "Shock de sistema": "50%", "Superv. Revivir": "60%", "Prot. Veneno": "0", "Regeneración": "--"},
                {"Puntuación habilidad": "10", "Bonif HP/Nivel": "0", "Shock de sistema": "55%", "Superv. Revivir": "65%", "Prot. Veneno": "0", "Regeneración": "--"},
                {"Puntuación habilidad": "11", "Bonif HP/Nivel": "0", "Shock de sistema": "60%", "Superv. Revivir": "70%", "Prot. Veneno": "0", "Regeneración": "--"},
                {"Puntuación habilidad": "12", "Bonif HP/Nivel": "0", "Shock de sistema": "65%", "Superv. Revivir": "75%", "Prot. Veneno": "0", "Regeneración": "--"},
                {"Puntuación habilidad": "13", "Bonif HP/Nivel": "0", "Shock de sistema": "70%", "Superv. Revivir": "80%", "Prot. Veneno": "0", "Regeneración": "--"},
                {"Puntuación habilidad": "14", "Bonif HP/Nivel": "0", "Shock de sistema": "75%", "Superv. Revivir": "85%", "Prot. Veneno": "0", "Regeneración": "--"},
                {"Puntuación habilidad": "15", "Bonif HP/Nivel": "1", "Shock de sistema": "80%", "Superv. Revivir": "90%", "Prot. Veneno": "0", "Regeneración": "--"},
                {"Puntuación habilidad": "16", "Bonif HP/Nivel": "2", "Shock de sistema": "85%", "Superv. Revivir": "95%", "Prot. Veneno": "0", "Regeneración": "--"},
                {"Puntuación habilidad": "17", "Bonif HP/Nivel": "2", "Shock de sistema": "90%", "Superv. Revivir": "96%", "Prot. Veneno": "0", "Regeneración": "--"},
                {"Puntuación habilidad": "18", "Bonif HP/Nivel": "3", "Shock de sistema": "95%", "Superv. Revivir": "97%", "Prot. Veneno": "0", "Regeneración": "--"},
                {"Puntuación habilidad": "19", "Bonif HP/Nivel": "3", "Shock de sistema": "97%", "Superv. Revivir": "98%", "Prot. Veneno": "0", "Regeneración": "--"},
                {"Puntuación habilidad": "20", "Bonif HP/Nivel": "4", "Shock de sistema": "98%", "Superv. Revivir": "99%", "Prot. Veneno": "0", "Regeneración": "--"},
                {"Puntuación habilidad": "21", "Bonif HP/Nivel": "4", "Shock de sistema": "99%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "1"},
                {"Puntuación habilidad": "22", "Bonif HP/Nivel": "4", "Shock de sistema": "99%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "1"},
                {"Puntuación habilidad": "23", "Bonif HP/Nivel": "5", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "1"},
                {"Puntuación habilidad": "24", "Bonif HP/Nivel": "5", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "1"},
                {"Puntuación habilidad": "25", "Bonif HP/Nivel": "5", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "2"},
                {"Puntuación habilidad": "26", "Bonif HP/Nivel": "6", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "2"},
                {"Puntuación habilidad": "27", "Bonif HP/Nivel": "6", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "2"},
                {"Puntuación habilidad": "28", "Bonif HP/Nivel": "7", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "3"},
                {"Puntuación habilidad": "29", "Bonif HP/Nivel": "7", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "3"},
                {"Puntuación habilidad": "30", "Bonif HP/Nivel": "8", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "3"},
                {"Puntuación habilidad": "31", "Bonif HP/Nivel": "8", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "4"},
                {"Puntuación habilidad": "32", "Bonif HP/Nivel": "9", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "4"},
                {"Puntuación habilidad": "33", "Bonif HP/Nivel": "9", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "4"},
                {"Puntuación habilidad": "34", "Bonif HP/Nivel": "10", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "5"},
                {"Puntuación habilidad": "35", "Bonif HP/Nivel": "10", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "5"},
                {"Puntuación habilidad": "36", "Bonif HP/Nivel": "11", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "5"},
                {"Puntuación habilidad": "37", "Bonif HP/Nivel": "11", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "6"},
                {"Puntuación habilidad": "38", "Bonif HP/Nivel": "12", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "6"},
                {"Puntuación habilidad": "39", "Bonif HP/Nivel": "12", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "6"},
                {"Puntuación habilidad": "40", "Bonif HP/Nivel": "13", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "7"},
                {"Puntuación habilidad": "41", "Bonif HP/Nivel": "13", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "7"},
                {"Puntuación habilidad": "42", "Bonif HP/Nivel": "14", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "8"},
                {"Puntuación habilidad": "43", "Bonif HP/Nivel": "14", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "8"},
                {"Puntuación habilidad": "44", "Bonif HP/Nivel": "15", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "8"},
                {"Puntuación habilidad": "45", "Bonif HP/Nivel": "15", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "9"},
                {"Puntuación habilidad": "46", "Bonif HP/Nivel": "16", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "9"},
                {"Puntuación habilidad": "47", "Bonif HP/Nivel": "16", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "9"},
                {"Puntuación habilidad": "48", "Bonif HP/Nivel": "17", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "10"},
                {"Puntuación habilidad": "49", "Bonif HP/Nivel": "17", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "10"},
                {"Puntuación habilidad": "50", "Bonif HP/Nivel": "18", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "10"},
                {"Puntuación habilidad": "51", "Bonif HP/Nivel": "18", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "11"},
                {"Puntuación habilidad": "52", "Bonif HP/Nivel": "19", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "11"},
                {"Puntuación habilidad": "53", "Bonif HP/Nivel": "19", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "12"},
                {"Puntuación habilidad": "54", "Bonif HP/Nivel": "20", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "12"},
                {"Puntuación habilidad": "55", "Bonif HP/Nivel": "20", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "12"},
                {"Puntuación habilidad": "56", "Bonif HP/Nivel": "21", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "13"},
                {"Puntuación habilidad": "57", "Bonif HP/Nivel": "21", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "13"},
                {"Puntuación habilidad": "58", "Bonif HP/Nivel": "22", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "14"},
                {"Puntuación habilidad": "59", "Bonif HP/Nivel": "22", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "14"},
                {"Puntuación habilidad": "60", "Bonif HP/Nivel": "23", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "14"},
                {"Puntuación habilidad": "61", "Bonif HP/Nivel": "23", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "15"},
                {"Puntuación habilidad": "62", "Bonif HP/Nivel": "24", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "15"},
                {"Puntuación habilidad": "63", "Bonif HP/Nivel": "24", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "16"},
                {"Puntuación habilidad": "64", "Bonif HP/Nivel": "25", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "16"},
                {"Puntuación habilidad": "65", "Bonif HP/Nivel": "25", "Shock de sistema": "100%", "Superv. Revivir": "100%", "Prot. Veneno": "0", "Regeneración": "16"}
            ],
            "inteligencia": [
                {"Puntuación habilidad": "1", "Idiomas": "0", "Niveles de conjuros": "--", "Oportunidad de aprender conjuros": "0%", "Máximo conjuros por nivel": "0", "Inmunidad": "--"},
                {"Puntuación habilidad": "2", "Idiomas": "0", "Niveles de conjuros": "--", "Oportunidad de aprender conjuros": "0%", "Máximo conjuros por nivel": "0", "Inmunidad": "--"},
                {"Puntuación habilidad": "3", "Idiomas": "0", "Niveles de conjuros": "--", "Oportunidad de aprender conjuros": "0%", "Máximo conjuros por nivel": "0", "Inmunidad": "--"},
                {"Puntuación habilidad": "4", "Idiomas": "0", "Niveles de conjuros": "--", "Oportunidad de aprender conjuros": "0%", "Máximo conjuros por nivel": "0", "Inmunidad": "--"},
                {"Puntuación habilidad": "5", "Idiomas": "0", "Niveles de conjuros": "--", "Oportunidad de aprender conjuros": "0%", "Máximo conjuros por nivel": "0", "Inmunidad": "--"},
                {"Puntuación habilidad": "6", "Idiomas": "1", "Niveles de conjuros": "--", "Oportunidad de aprender conjuros": "0%", "Máximo conjuros por nivel": "0", "Inmunidad": "--"},
                {"Puntuación habilidad": "7", "Idiomas": "1", "Niveles de conjuros": "--", "Oportunidad de aprender conjuros": "0%", "Máximo conjuros por nivel": "0", "Inmunidad": "--"},
                {"Puntuación habilidad": "8", "Idiomas": "1", "Niveles de conjuros": "--", "Oportunidad de aprender conjuros": "0%", "Máximo conjuros por nivel": "0", "Inmunidad": "--"},
                {"Puntuación habilidad": "9", "Idiomas": "1", "Niveles de conjuros": "--", "Oportunidad de aprender conjuros": "0%", "Máximo conjuros por nivel": "0", "Inmunidad": "--"},
                {"Puntuación habilidad": "10", "Idiomas": "2", "Niveles de conjuros": "1", "Oportunidad de aprender conjuros": "25%", "Máximo conjuros por nivel": "6", "Inmunidad": "--"},
                {"Puntuación habilidad": "11", "Idiomas": "2", "Niveles de conjuros": "2", "Oportunidad de aprender conjuros": "35%", "Máximo conjuros por nivel": "7", "Inmunidad": "--"},
                {"Puntuación habilidad": "12", "Idiomas": "3", "Niveles de conjuros": "2", "Oportunidad de aprender conjuros": "45%", "Máximo conjuros por nivel": "7", "Inmunidad": "--"},
                {"Puntuación habilidad": "13", "Idiomas": "3", "Niveles de conjuros": "3", "Oportunidad de aprender conjuros": "50%", "Máximo conjuros por nivel": "9", "Inmunidad": "--"},
                {"Puntuación habilidad": "14", "Idiomas": "4", "Niveles de conjuros": "3", "Oportunidad de aprender conjuros": "60%", "Máximo conjuros por nivel": "11", "Inmunidad": "--"},
                {"Puntuación habilidad": "15", "Idiomas": "4", "Niveles de conjuros": "4", "Oportunidad de aprender conjuros": "70%", "Máximo conjuros por nivel": "14", "Inmunidad": "--"},
                {"Puntuación habilidad": "16", "Idiomas": "5", "Niveles de conjuros": "4", "Oportunidad de aprender conjuros": "75%", "Máximo conjuros por nivel": "18", "Inmunidad": "--"},
                {"Puntuación habilidad": "17", "Idiomas": "6", "Niveles de conjuros": "5", "Oportunidad de aprender conjuros": "85%", "Máximo conjuros por nivel": "20", "Inmunidad": "--"},
                {"Puntuación habilidad": "18", "Idiomas": "7", "Niveles de conjuros": "5", "Oportunidad de aprender conjuros": "95%", "Máximo conjuros por nivel": "25", "Inmunidad": "1"},
                {"Puntuación habilidad": "19", "Idiomas": "8", "Niveles de conjuros": "6", "Oportunidad de aprender conjuros": "96%", "Máximo conjuros por nivel": "28", "Inmunidad": "1"},
                {"Puntuación habilidad": "20", "Idiomas": "9", "Niveles de conjuros": "6", "Oportunidad de aprender conjuros": "97%", "Máximo conjuros por nivel": "30", "Inmunidad": "1"},
                {"Puntuación habilidad": "21", "Idiomas": "10", "Niveles de conjuros": "7", "Oportunidad de aprender conjuros": "98%", "Máximo conjuros por nivel": "35", "Inmunidad": "1"},
                {"Puntuación habilidad": "22", "Idiomas": "11", "Niveles de conjuros": "7", "Oportunidad de aprender conjuros": "99%", "Máximo conjuros por nivel": "38", "Inmunidad": "1"},
                {"Puntuación habilidad": "23", "Idiomas": "12", "Niveles de conjuros": "8", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "42", "Inmunidad": "2"},
                {"Puntuación habilidad": "24", "Idiomas": "13", "Niveles de conjuros": "8", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "45", "Inmunidad": "2"},
                {"Puntuación habilidad": "25", "Idiomas": "14", "Niveles de conjuros": "9", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "50", "Inmunidad": "2"},
                {"Puntuación habilidad": "26", "Idiomas": "15", "Niveles de conjuros": "9", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "55", "Inmunidad": "2"},
                {"Puntuación habilidad": "27", "Idiomas": "16", "Niveles de conjuros": "10", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "60", "Inmunidad": "3"},
                {"Puntuación habilidad": "28", "Idiomas": "17", "Niveles de conjuros": "10", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "65", "Inmunidad": "3"},
                {"Puntuación habilidad": "29", "Idiomas": "18", "Niveles de conjuros": "11", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "70", "Inmunidad": "3"},
                {"Puntuación habilidad": "30", "Idiomas": "19", "Niveles de conjuros": "11", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "75", "Inmunidad": "4"},
                {"Puntuación habilidad": "31", "Idiomas": "20", "Niveles de conjuros": "12", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "80", "Inmunidad": "4"},
                {"Puntuación habilidad": "32", "Idiomas": "21", "Niveles de conjuros": "12", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "85", "Inmunidad": "4"},
                {"Puntuación habilidad": "33", "Idiomas": "22", "Niveles de conjuros": "13", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "90", "Inmunidad": "5"},
                {"Puntuación habilidad": "34", "Idiomas": "23", "Niveles de conjuros": "13", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "95", "Inmunidad": "5"},
                {"Puntuación habilidad": "35", "Idiomas": "24", "Niveles de conjuros": "14", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "100", "Inmunidad": "5"},
                {"Puntuación habilidad": "36", "Idiomas": "25", "Niveles de conjuros": "14", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "105", "Inmunidad": "6"},
                {"Puntuación habilidad": "37", "Idiomas": "26", "Niveles de conjuros": "15", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "110", "Inmunidad": "6"},
                {"Puntuación habilidad": "38", "Idiomas": "27", "Niveles de conjuros": "15", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "115", "Inmunidad": "6"},
                {"Puntuación habilidad": "39", "Idiomas": "28", "Niveles de conjuros": "16", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "120", "Inmunidad": "7"},
                {"Puntuación habilidad": "40", "Idiomas": "29", "Niveles de conjuros": "16", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "125", "Inmunidad": "7"},
                {"Puntuación habilidad": "41", "Idiomas": "30", "Niveles de conjuros": "17", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "130", "Inmunidad": "7"},
                {"Puntuación habilidad": "42", "Idiomas": "31", "Niveles de conjuros": "17", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "135", "Inmunidad": "8"},
                {"Puntuación habilidad": "43", "Idiomas": "32", "Niveles de conjuros": "18", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "140", "Inmunidad": "8"},
                {"Puntuación habilidad": "44", "Idiomas": "33", "Niveles de conjuros": "18", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "145", "Inmunidad": "8"},
                {"Puntuación habilidad": "45", "Idiomas": "34", "Niveles de conjuros": "19", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "150", "Inmunidad": "9"},
                {"Puntuación habilidad": "46", "Idiomas": "35", "Niveles de conjuros": "19", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "155", "Inmunidad": "9"},
                {"Puntuación habilidad": "47", "Idiomas": "36", "Niveles de conjuros": "20", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "160", "Inmunidad": "9"},
                {"Puntuación habilidad": "48", "Idiomas": "37", "Niveles de conjuros": "20", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "165", "Inmunidad": "10"},
                {"Puntuación habilidad": "49", "Idiomas": "38", "Niveles de conjuros": "21", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "170", "Inmunidad": "10"},
                {"Puntuación habilidad": "50", "Idiomas": "39", "Niveles de conjuros": "21", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "175", "Inmunidad": "10"},
                {"Puntuación habilidad": "51", "Idiomas": "40", "Niveles de conjuros": "22", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "180", "Inmunidad": "11"},
                {"Puntuación habilidad": "52", "Idiomas": "41", "Niveles de conjuros": "22", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "185", "Inmunidad": "11"},
                {"Puntuación habilidad": "53", "Idiomas": "42", "Niveles de conjuros": "23", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "190", "Inmunidad": "11"},
                {"Puntuación habilidad": "54", "Idiomas": "43", "Niveles de conjuros": "23", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "195", "Inmunidad": "12"},
                {"Puntuación habilidad": "55", "Idiomas": "44", "Niveles de conjuros": "24", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "200", "Inmunidad": "12"},
                {"Puntuación habilidad": "56", "Idiomas": "45", "Niveles de conjuros": "24", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "205", "Inmunidad": "12"},
                {"Puntuación habilidad": "57", "Idiomas": "46", "Niveles de conjuros": "25", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "210", "Inmunidad": "13"},
                {"Puntuación habilidad": "58", "Idiomas": "47", "Niveles de conjuros": "25", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "215", "Inmunidad": "13"},
                {"Puntuación habilidad": "59", "Idiomas": "48", "Niveles de conjuros": "26", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "220", "Inmunidad": "13"},
                {"Puntuación habilidad": "60", "Idiomas": "49", "Niveles de conjuros": "26", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "225", "Inmunidad": "14"},
                {"Puntuación habilidad": "61", "Idiomas": "50", "Niveles de conjuros": "27", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "230", "Inmunidad": "14"},
                {"Puntuación habilidad": "62", "Idiomas": "51", "Niveles de conjuros": "27", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "235", "Inmunidad": "14"},
                {"Puntuación habilidad": "63", "Idiomas": "52", "Niveles de conjuros": "28", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "240", "Inmunidad": "15"},
                {"Puntuación habilidad": "64", "Idiomas": "53", "Niveles de conjuros": "28", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "245", "Inmunidad": "15"},
                {"Puntuación habilidad": "65", "Idiomas": "54", "Niveles de conjuros": "29", "Oportunidad de aprender conjuros": "100%", "Máximo conjuros por nivel": "250", "Inmunidad": "15"}
            ],
            "sabiduria": [
                {"Puntuación habilidad": "1", "Def. Mágica": "-6", "Bonif. Conjuros": "0", "Fracaso Conjuro": "50%"},
                {"Puntuación habilidad": "2", "Def. Mágica": "-4", "Bonif. Conjuros": "0", "Fracaso Conjuro": "45%"},
                {"Puntuación habilidad": "3", "Def. Mágica": "-3", "Bonif. Conjuros": "0", "Fracaso Conjuro": "40%"},
                {"Puntuación habilidad": "4", "Def. Mágica": "-2", "Bonif. Conjuros": "0", "Fracaso Conjuro": "35%"},
                {"Puntuación habilidad": "5", "Def. Mágica": "-1", "Bonif. Conjuros": "0", "Fracaso Conjuro": "30%"},
                {"Puntuación habilidad": "6", "Def. Mágica": "0", "Bonif. Conjuros": "0", "Fracaso Conjuro": "25%"},
                {"Puntuación habilidad": "7", "Def. Mágica": "0", "Bonif. Conjuros": "0", "Fracaso Conjuro": "20%"},
                {"Puntuación habilidad": "8", "Def. Mágica": "0", "Bonif. Conjuros": "0", "Fracaso Conjuro": "15%"},
                {"Puntuación habilidad": "9", "Def. Mágica": "0", "Bonif. Conjuros": "0", "Fracaso Conjuro": "10%"},
                {"Puntuación habilidad": "10", "Def. Mágica": "0", "Bonif. Conjuros": "0", "Fracaso Conjuro": "5%"},
                {"Puntuación habilidad": "11", "Def. Mágica": "0", "Bonif. Conjuros": "0", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "12", "Def. Mágica": "0", "Bonif. Conjuros": "0", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "13", "Def. Mágica": "0", "Bonif. Conjuros": "0", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "14", "Def. Mágica": "0", "Bonif. Conjuros": "0", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "15", "Def. Mágica": "0", "Bonif. Conjuros": "1", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "16", "Def. Mágica": "1", "Bonif. Conjuros": "2", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "17", "Def. Mágica": "2", "Bonif. Conjuros": "3", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "18", "Def. Mágica": "3", "Bonif. Conjuros": "4", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "19", "Def. Mágica": "4", "Bonif. Conjuros": "4", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "20", "Def. Mágica": "4", "Bonif. Conjuros": "5", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "21", "Def. Mágica": "4", "Bonif. Conjuros": "5", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "22", "Def. Mágica": "5", "Bonif. Conjuros": "6", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "23", "Def. Mágica": "5", "Bonif. Conjuros": "6", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "24", "Def. Mágica": "5", "Bonif. Conjuros": "7", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "25", "Def. Mágica": "6", "Bonif. Conjuros": "7", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "26", "Def. Mágica": "6", "Bonif. Conjuros": "8", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "27", "Def. Mágica": "6", "Bonif. Conjuros": "8", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "28", "Def. Mágica": "7", "Bonif. Conjuros": "9", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "29", "Def. Mágica": "7", "Bonif. Conjuros": "9", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "30", "Def. Mágica": "8", "Bonif. Conjuros": "10", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "31", "Def. Mágica": "8", "Bonif. Conjuros": "10", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "32", "Def. Mágica": "9", "Bonif. Conjuros": "11", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "33", "Def. Mágica": "9", "Bonif. Conjuros": "11", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "34", "Def. Mágica": "10", "Bonif. Conjuros": "12", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "35", "Def. Mágica": "10", "Bonif. Conjuros": "12", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "36", "Def. Mágica": "11", "Bonif. Conjuros": "13", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "37", "Def. Mágica": "11", "Bonif. Conjuros": "13", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "38", "Def. Mágica": "12", "Bonif. Conjuros": "14", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "39", "Def. Mágica": "12", "Bonif. Conjuros": "14", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "40", "Def. Mágica": "13", "Bonif. Conjuros": "15", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "41", "Def. Mágica": "13", "Bonif. Conjuros": "15", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "42", "Def. Mágica": "14", "Bonif. Conjuros": "16", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "43", "Def. Mágica": "14", "Bonif. Conjuros": "16", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "44", "Def. Mágica": "15", "Bonif. Conjuros": "17", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "45", "Def. Mágica": "15", "Bonif. Conjuros": "17", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "46", "Def. Mágica": "16", "Bonif. Conjuros": "18", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "47", "Def. Mágica": "16", "Bonif. Conjuros": "18", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "48", "Def. Mágica": "17", "Bonif. Conjuros": "19", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "49", "Def. Mágica": "17", "Bonif. Conjuros": "19", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "50", "Def. Mágica": "18", "Bonif. Conjuros": "20", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "51", "Def. Mágica": "18", "Bonif. Conjuros": "20", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "52", "Def. Mágica": "19", "Bonif. Conjuros": "21", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "53", "Def. Mágica": "19", "Bonif. Conjuros": "21", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "54", "Def. Mágica": "20", "Bonif. Conjuros": "22", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "55", "Def. Mágica": "20", "Bonif. Conjuros": "22", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "56", "Def. Mágica": "21", "Bonif. Conjuros": "23", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "57", "Def. Mágica": "21", "Bonif. Conjuros": "23", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "58", "Def. Mágica": "22", "Bonif. Conjuros": "24", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "59", "Def. Mágica": "22", "Bonif. Conjuros": "24", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "60", "Def. Mágica": "23", "Bonif. Conjuros": "25", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "61", "Def. Mágica": "23", "Bonif. Conjuros": "25", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "62", "Def. Mágica": "24", "Bonif. Conjuros": "26", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "63", "Def. Mágica": "24", "Bonif. Conjuros": "26", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "64", "Def. Mágica": "25", "Bonif. Conjuros": "27", "Fracaso Conjuro": "0%"},
                {"Puntuación habilidad": "65", "Def. Mágica": "25", "Bonif. Conjuros": "27", "Fracaso Conjuro": "0%"}
            ],
            "carisma": [
                {"Puntuación habilidad": "1", "N° de servidores": "0", "Lealtad base": "-5", "Ajuste reacción": "-7"},
                {"Puntuación habilidad": "2", "N° de servidores": "0", "Lealtad base": "-4", "Ajuste reacción": "-6"},
                {"Puntuación habilidad": "3", "N° de servidores": "0", "Lealtad base": "-3", "Ajuste reacción": "-5"},
                {"Puntuación habilidad": "4", "N° de servidores": "1", "Lealtad base": "-2", "Ajuste reacción": "-4"},
                {"Puntuación habilidad": "5", "N° de servidores": "1", "Lealtad base": "-1", "Ajuste reacción": "-3"},
                {"Puntuación habilidad": "6", "N° de servidores": "1", "Lealtad base": "0", "Ajuste reacción": "-2"},
                {"Puntuación habilidad": "7", "N° de servidores": "1", "Lealtad base": "0", "Ajuste reacción": "-1"},
                {"Puntuación habilidad": "8", "N° de servidores": "2", "Lealtad base": "0", "Ajuste reacción": "0"},
                {"Puntuación habilidad": "9", "N° de servidores": "2", "Lealtad base": "0", "Ajuste reacción": "0"},
                {"Puntuación habilidad": "10", "N° de servidores": "3", "Lealtad base": "0", "Ajuste reacción": "0"},
                {"Puntuación habilidad": "11", "N° de servidores": "3", "Lealtad base": "0", "Ajuste reacción": "0"},
                {"Puntuación habilidad": "12", "N° de servidores": "4", "Lealtad base": "0", "Ajuste reacción": "0"},
                {"Puntuación habilidad": "13", "N° de servidores": "4", "Lealtad base": "0", "Ajuste reacción": "0"},
                {"Puntuación habilidad": "14", "N° de servidores": "5", "Lealtad base": "1", "Ajuste reacción": "1"},
                {"Puntuación habilidad": "15", "N° de servidores": "6", "Lealtad base": "2", "Ajuste reacción": "2"},
                {"Puntuación habilidad": "16", "N° de servidores": "7", "Lealtad base": "3", "Ajuste reacción": "3"},
                {"Puntuación habilidad": "17", "N° de servidores": "8", "Lealtad base": "4", "Ajuste reacción": "4"},
                {"Puntuación habilidad": "18", "N° de servidores": "10", "Lealtad base": "5", "Ajuste reacción": "5"},
                {"Puntuación habilidad": "19", "N° de servidores": "12", "Lealtad base": "6", "Ajuste reacción": "6"},
                {"Puntuación habilidad": "20", "N° de servidores": "14", "Lealtad base": "7", "Ajuste reacción": "7"},
                {"Puntuación habilidad": "21", "N° de servidores": "16", "Lealtad base": "8", "Ajuste reacción": "8"},
                {"Puntuación habilidad": "22", "N° de servidores": "18", "Lealtad base": "9", "Ajuste reacción": "9"},
                {"Puntuación habilidad": "23", "N° de servidores": "20", "Lealtad base": "10", "Ajuste reacción": "10"},
                {"Puntuación habilidad": "24", "N° de servidores": "22", "Lealtad base": "11", "Ajuste reacción": "11"},
                {"Puntuación habilidad": "25", "N° de servidores": "24", "Lealtad base": "12", "Ajuste reacción": "12"},
                {"Puntuación habilidad": "26", "N° de servidores": "26", "Lealtad base": "13", "Ajuste reacción": "13"},
                {"Puntuación habilidad": "27", "N° de servidores": "28", "Lealtad base": "14", "Ajuste reacción": "14"},
                {"Puntuación habilidad": "28", "N° de servidores": "30", "Lealtad base": "15", "Ajuste reacción": "15"},
                {"Puntuación habilidad": "29", "N° de servidores": "32", "Lealtad base": "16", "Ajuste reacción": "16"},
                {"Puntuación habilidad": "30", "N° de servidores": "34", "Lealtad base": "17", "Ajuste reacción": "17"},
                {"Puntuación habilidad": "31", "N° de servidores": "36", "Lealtad base": "18", "Ajuste reacción": "18"},
                {"Puntuación habilidad": "32", "N° de servidores": "38", "Lealtad base": "19", "Ajuste reacción": "19"},
                {"Puntuación habilidad": "33", "N° de servidores": "40", "Lealtad base": "20", "Ajuste reacción": "20"},
                {"Puntuación habilidad": "34", "N° de servidores": "42", "Lealtad base": "21", "Ajuste reacción": "21"},
                {"Puntuación habilidad": "35", "N° de servidores": "44", "Lealtad base": "22", "Ajuste reacción": "22"},
                {"Puntuación habilidad": "36", "N° de servidores": "46", "Lealtad base": "23", "Ajuste reacción": "23"},
                {"Puntuación habilidad": "37", "N° de servidores": "48", "Lealtad base": "24", "Ajuste reacción": "24"},
                {"Puntuación habilidad": "38", "N° de servidores": "50", "Lealtad base": "25", "Ajuste reacción": "25"},
                {"Puntuación habilidad": "39", "N° de servidores": "52", "Lealtad base": "26", "Ajuste reacción": "26"},
                {"Puntuación habilidad": "40", "N° de servidores": "54", "Lealtad base": "27", "Ajuste reacción": "27"},
                {"Puntuación habilidad": "41", "N° de servidores": "56", "Lealtad base": "28", "Ajuste reacción": "28"},
                {"Puntuación habilidad": "42", "N° de servidores": "58", "Lealtad base": "29", "Ajuste reacción": "29"},
                {"Puntuación habilidad": "43", "N° de servidores": "60", "Lealtad base": "30", "Ajuste reacción": "30"},
                {"Puntuación habilidad": "44", "N° de servidores": "62", "Lealtad base": "31", "Ajuste reacción": "31"},
                {"Puntuación habilidad": "45", "N° de servidores": "64", "Lealtad base": "32", "Ajuste reacción": "32"},
                {"Puntuación habilidad": "46", "N° de servidores": "66", "Lealtad base": "33", "Ajuste reacción": "33"},
                {"Puntuación habilidad": "47", "N° de servidores": "68", "Lealtad base": "34", "Ajuste reacción": "34"},
                {"Puntuación habilidad": "48", "N° de servidores": "70", "Lealtad base": "35", "Ajuste reacción": "35"},
                {"Puntuación habilidad": "49", "N° de servidores": "72", "Lealtad base": "36", "Ajuste reacción": "36"},
                {"Puntuación habilidad": "50", "N° de servidores": "74", "Lealtad base": "37", "Ajuste reacción": "37"},
                {"Puntuación habilidad": "51", "N° de servidores": "76", "Lealtad base": "38", "Ajuste reacción": "38"},
                {"Puntuación habilidad": "52", "N° de servidores": "78", "Lealtad base": "39", "Ajuste reacción": "39"},
                {"Puntuación habilidad": "53", "N° de servidores": "80", "Lealtad base": "40", "Ajuste reacción": "40"},
                {"Puntuación habilidad": "54", "N° de servidores": "82", "Lealtad base": "41", "Ajuste reacción": "41"},
                {"Puntuación habilidad": "55", "N° de servidores": "84", "Lealtad base": "42", "Ajuste reacción": "42"},
                {"Puntuación habilidad": "56", "N° de servidores": "86", "Lealtad base": "43", "Ajuste reacción": "43"},
                {"Puntuación habilidad": "57", "N° de servidores": "88", "Lealtad base": "44", "Ajuste reacción": "44"},
                {"Puntuación habilidad": "58", "N° de servidores": "90", "Lealtad base": "45", "Ajuste reacción": "45"},
                {"Puntuación habilidad": "59", "N° de servidores": "92", "Lealtad base": "46", "Ajuste reacción": "46"},
                {"Puntuación habilidad": "60", "N° de servidores": "94", "Lealtad base": "47", "Ajuste reacción": "47"},
                {"Puntuación habilidad": "61", "N° de servidores": "96", "Lealtad base": "48", "Ajuste reacción": "48"},
                {"Puntuación habilidad": "62", "N° de servidores": "98", "Lealtad base": "49", "Ajuste reacción": "49"},
                {"Puntuación habilidad": "63", "N° de servidores": "100", "Lealtad base": "50", "Ajuste reacción": "50"},
                {"Puntuación habilidad": "64", "N° de servidores": "102", "Lealtad base": "51", "Ajuste reacción": "51"},
                {"Puntuación habilidad": "65", "N° de servidores": "104", "Lealtad base": "52", "Ajuste reacción": "52"}
            ]
        };

 // Función para calcular modificadores
            function calculateModifiers() {
                try {
                    document.getElementById("debug-info").textContent = "Status: Calculando modificadores...";
                    
                    // FUERZA
                    const str = parseInt(document.getElementById("strength").value) || 10;
                    const strData = abilityData["fuerza"]?.find(f => f["Punt. Habilidad"] == str);
                    
                    if (strData) {
                        document.getElementById("str-hit-prob").textContent = strData["Probab. de Golpe"] || "--";
                        document.getElementById("str-damage-adj").textContent = strData["Ajuste de daño"] || "--";
                        document.getElementById("str-weight-cap").textContent = (strData["Peso Kg autorizado"] || "--") + "kg";
                        document.getElementById("str-max-effort").textContent = (strData["Esfuerzo máximo Kg"] || "--") + "kg";
                        document.getElementById("str-open-doors").textContent = strData["Abrir Puertas"] || "--";
                        document.getElementById("str-bend-bar").textContent = strData["Doblar Barras"] || "--";
                    } else {
                        setElementsToDefault("str", ["--", "--", "--kg", "--kg", "--", "--"]);
                    }

                    // DESTREZA
                    const dex = parseInt(document.getElementById("dexterity").value) || 10;
                    const dexData = abilityData["destreza"]?.find(f => f["Puntuación habilidad"] == dex);
                    
                    if (dexData) {
                        document.getElementById("dex-reaction").textContent = dexData["Ajuste reacción"] || "--";
                        document.getElementById("dex-missile").textContent = dexData["Ajuste Atq Proyectiles"] || "--";
                        document.getElementById("dex-defensive").textContent = dexData["Ajuste defensivo"] || "--";
                    } else {
                        setElementsToDefault("dex", ["--", "--", "--"]);
                    }

                    // CONSTITUCIÓN
                    const con = parseInt(document.getElementById("constitution").value) || 10;
                    const conData = abilityData["constitucion"]?.find(f => f["Puntuación habilidad"] == con);
                    
                    if (conData) {
                        document.getElementById("con-hp-bonus").textContent = conData["Bonif HP/Nivel"] || "--";
                        document.getElementById("con-shock-survival").textContent = conData["Shock de sistema"] || "--";
                        document.getElementById("con-resurrection").textContent = conData["Superv. Revivir"] || "--";
                        document.getElementById("con-poison").textContent = conData["Prot. Veneno"] || "--";
                        document.getElementById("con-regeneration").textContent = conData["Regeneración"] || "--";
                    } else {
                        setElementsToDefault("con", ["--", "--", "--", "--", "--"]);
                    }

                    // INTELIGENCIA
                    const intel = parseInt(document.getElementById("intelligence").value) || 10;
                    const intelData = abilityData["inteligencia"]?.find(f => f["Puntuación habilidad"] == intel);
                    
                    if (intelData) {
                        document.getElementById("int-languages").textContent = intelData["Idiomas"] || "--";
                        document.getElementById("int-spell-level").textContent = intelData["Niveles de conjuros"] || "--";
                        document.getElementById("int-spell-chance").textContent = intelData["Oportunidad de aprender conjuros"] || "--";
                        document.getElementById("int-max-spells").textContent = intelData["Máximo conjuros por nivel"] || "--";
                        document.getElementById("int-immunity").textContent = intelData["Inmunidad"] || "--";
                    } else {
                        setElementsToDefault("int", ["--", "--", "--", "--", "--"]);
                    }

                    // SABIDURÍA
                    const wis = parseInt(document.getElementById("wisdom").value) || 10;
                    const wisData = abilityData["sabiduria"]?.find(f => f["Puntuación habilidad"] == wis);
                    
                    if (wisData) {
                        document.getElementById("wis-magic-defense").textContent = wisData["Def. Mágica"] || "--";
                        document.getElementById("wis-spell-bonus").textContent = wisData["Bonif. Conjuros"] || "--";
                        document.getElementById("wis-spell-failure").textContent = wisData["Fracaso Conjuro"] || "--";
                    } else {
                        setElementsToDefault("wis", ["--", "--", "--"]);
                    }

                    // CARISMA
                    const cha = parseInt(document.getElementById("charisma").value) || 10;
                    const chaData = abilityData["carisma"]?.find(f => f["Puntuación habilidad"] == cha);
                    
                    if (chaData) {
                        document.getElementById("cha-max-servers").textContent = chaData["N° de servidores"] || "--";
                        document.getElementById("cha-base-loyalty").textContent = chaData["Lealtad base"] || "--";
                        document.getElementById("cha-reaction-adj").textContent = chaData["Ajuste reacción"] || "--";
                    } else {
                        setElementsToDefault("cha", ["--", "--", "--"]);
                    }

                    document.getElementById("debug-info").textContent = "Status: ✅ Cálculos completados correctamente";
                    
                } catch (error) {
                    document.getElementById("debug-info").textContent = "Status: ❌ Error - " + error.message;
                    console.error("Error en calculateModifiers:", error);
                }
            }

            // Función auxiliar para establecer valores por defecto
            function setElementsToDefault(prefix, values) {
                const ids = {
                    "str": ["str-hit-prob", "str-damage-adj", "str-weight-cap", "str-max-effort", "str-open-doors", "str-bend-bar"],
                    "dex": ["dex-reaction", "dex-missile", "dex-defensive"],
                    "con": ["con-hp-bonus", "con-shock-survival", "con-resurrection", "con-poison", "con-regeneration"],
                    "int": ["int-languages", "int-spell-level", "int-spell-chance", "int-max-spells", "int-immunity"],
                    "wis": ["wis-magic-defense", "wis-spell-bonus", "wis-spell-failure"],
                    "cha": ["cha-max-servers", "cha-base-loyalty", "cha-reaction-adj"]
                };

                if (ids[prefix]) {
                    ids[prefix].forEach((id, index) => {
                        const element = document.getElementById(id);
                        if (element && values[index]) {
                            element.textContent = values[index];
                        }
                    });
                }
            }

            // Función de inicialización
            function init() {
                document.getElementById("debug-info").textContent = "Status: 🔄 Inicializando calculadora...";
                
                // Verificar que todos los elementos existen
                const requiredElements = [
                    "strength", "dexterity", "constitution", "intelligence", "wisdom", "charisma"
                ];
                
                let allElementsFound = true;
                requiredElements.forEach(id => {
                    if (!document.getElementById(id)) {
                        console.error("Elemento no encontrado:", id);
                        allElementsFound = false;
                    }
                });

                if (allElementsFound) {
                    calculateModifiers();
                    document.getElementById("debug-info").textContent = "Status: ✅ Calculadora inicializada correctamente";
                } else {
                    document.getElementById("debug-info").textContent = "Status: ❌ Error - Elementos HTML faltantes";
                }
            }

            // API pública del módulo
            return {
                calculateModifiers: calculateModifiers,
                init: init,
                abilityData: abilityData // Exportamos los datos para debugging
            };
        })();

        // Inicializar cuando el DOM esté listo
        document.addEventListener('DOMContentLoaded', function() {
            window.AbilityCalculator.init();
        });

        // También ejecutar inmediatamente por si el DOM ya está listo
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', window.AbilityCalculator.init);
        } else {
            window.AbilityCalculator.init();
        }
    </script>
</body>
</html>

<!-- Combat Tab -->
<div id="combat-tab" class="tab-content">
    <h2 style="color: #ffd700; margin-bottom: 2rem;">⚔️ Combate</h2>

    <!-- Stats de Combate -->
    <div class="combat-stats-row">
        <div class="stat-card combat-stat">
            <div class="stat-value" id="combatAC">10</div>
            <div class="stat-label">Clase de Armadura</div>
        </div>
        <div class="stat-card combat-stat">
            <div class="stat-value" id="combatGaco">20</div>
            <div class="stat-label">GACO Base</div>
        </div>
        <div class="stat-card combat-stat">
            <div class="stat-value" id="combatInitiative">+0</div>
            <div class="stat-label">Iniciativa</div>
        </div>
        <div class="stat-card combat-stat">
            <div class="stat-value" id="combatMovement">30m</div>
            <div class="stat-label">Movimiento</div>
        </div>
    </div>

    <!-- Armas Equipadas -->
    <div class="combat-section">
        <h3 style="color: #ffd700; margin-bottom: 1rem;">⚔️ Armas Equipadas</h3>
        
        <div class="equipped-weapons" id="equipped-weapons-container">
            <div class="weapon-slot-combat" data-slot="main-hand">
                <div class="slot-label">🗡️ Mano Principal</div>
                <div class="weapon-info" id="main-hand-weapon">
                    <div class="weapon-name-combat">Sin Arma</div>
                    <div class="weapon-stats-combat">
                        <span class="weapon-gaco">GACO: 20</span>
                        <span class="weapon-damage">Daño: 1d2</span>
                        <span class="weapon-attacks">Ataques: 1</span>
                    </div>
                </div>
                <button class="equip-weapon-btn" onclick="openWeaponSelector('main-hand')">Equipar</button>
            </div>

            <div class="weapon-slot-combat" data-slot="off-hand">
                <div class="slot-label">🛡️ Mano Secundaria</div>
                <div class="weapon-info" id="off-hand-weapon">
                    <div class="weapon-name-combat">Vacío</div>
                    <div class="weapon-stats-combat">
                        <span class="weapon-note">Segunda arma o escudo</span>
                    </div>
                </div>
                <button class="equip-weapon-btn" onclick="openWeaponSelector('off-hand')">Equipar</button>
            </div>

            <div class="weapon-slot-combat" data-slot="ranged">
                <div class="slot-label">🏹 Arma a Distancia</div>
                <div class="weapon-info" id="ranged-weapon">
                    <div class="weapon-name-combat">Sin Arma</div>
                    <div class="weapon-stats-combat">
                        <span class="weapon-gaco">GACO: 20</span>
                        <span class="weapon-damage">Daño: --</span>
                        <span class="weapon-range">Alcance: --</span>
                    </div>
                </div>
                <button class="equip-weapon-btn" onclick="openWeaponSelector('ranged')">Equipar</button>
            </div>
        </div>
    </div>

    <!-- Estilos de Combate Activos -->
    <div class="combat-section">
        <h3 style="color: #ffd700; margin-bottom: 1rem;">🥋 Estilos de Combate</h3>
        
        <div class="active-combat-styles" id="active-combat-styles">
            <div class="no-styles-active">
                <p style="color: #b0b0b0; font-style: italic; text-align: center;">
                    No tienes estilos de combate disponibles.<br>
                    <small>Compra estilos en la pestaña de Pericias para habilitarlos aquí.</small>
                </p>
            </div>
        </div>
    </div>

    <!-- Armadura y Protección -->
    <div class="combat-section">
        <h3 style="color: #ffd700; margin-bottom: 1rem;">🛡️ Armadura y Protección</h3>
        
        <div class="armor-protection-grid">
            <div class="armor-slot-combat">
                <div class="armor-type-label">Armadura Corporal</div>
                <div class="armor-info" id="body-armor-info">
                    <div class="armor-name">Sin Armadura</div>
                    <div class="armor-stats">
                        <span class="armor-ac">CA: 10</span>
                        <span class="armor-dex-bonus">Dex: Sin límite</span>
                    </div>
                </div>
                <button class="change-armor-btn" onclick="openArmorSelector('body')">Cambiar</button>
            </div>

            <div class="armor-slot-combat">
                <div class="armor-type-label">Escudo</div>
                <div class="armor-info" id="shield-info">
                    <div class="armor-name">Sin Escudo</div>
                    <div class="armor-stats">
                        <span class="shield-ac">CA: +0</span>
                        <span class="shield-attacks">Ataques: +0</span>
                    </div>
                </div>
                <button class="change-armor-btn" onclick="openArmorSelector('shield')">Cambiar</button>
            </div>
        </div>

        <!-- Modificadores de CA -->
        <div class="ac-modifiers" id="ac-breakdown">
            <h4 style="color: #ffd700; margin-bottom: 0.5rem;">Desglose de CA:</h4>
            <div class="ac-breakdown-list">
                <div class="ac-modifier-item">
                    <span>Armadura base:</span>
                    <span id="ac-base-armor">10</span>
                </div>
                <div class="ac-modifier-item">
                    <span>Modificador de Destreza:</span>
                    <span id="ac-dex-mod">+0</span>
                </div>
                <div class="ac-modifier-item">
                    <span>Escudo:</span>
                    <span id="ac-shield">+0</span>
                </div>
                <div class="ac-modifier-item">
                    <span>Estilos de combate:</span>
                    <span id="ac-style-bonus">+0</span>
                </div>
                <div class="ac-modifier-item">
                    <span>Bonificaciones mágicas:</span>
                    <span id="ac-magic-bonus">+0</span>
                </div>
                <div class="ac-modifier-total">
                    <span><strong>CA Total:</strong></span>
                    <span id="ac-total"><strong>10</strong></span>
                </div>
            </div>
        </div>
    </div>

    <!-- Ataques por Ronda -->
    <div class="combat-section">
        <h3 style="color: #ffd700; margin-bottom: 1rem;">⚡ Ataques por Ronda</h3>
        
        <div class="attacks-per-round" id="attacks-breakdown">
            <div class="attacks-info">
                <div class="base-attacks">
                    <span class="attacks-label">Ataques base por nivel:</span>
                    <span class="attacks-value" id="base-attacks-value">1</span>
                </div>
                <div class="specialization-attacks">
                    <span class="attacks-label">Por especialización en armas:</span>
                    <span class="attacks-value" id="specialization-attacks-value">+0</span>
                </div>
                <div class="style-attacks">
                    <span class="attacks-label">Por estilos de combate:</span>
                    <span class="attacks-value" id="style-attacks-value">+0</span>
                </div>
                <div class="total-attacks">
                    <span class="attacks-label"><strong>Total por ronda:</strong></span>
                    <span class="attacks-value" id="total-attacks-value"><strong>1</strong></span>
                </div>
            </div>
            
            <div class="attacks-note">
                <p style="color: #b0b0b0; font-size: 0.9rem; font-style: italic;">
                    * Los ataques adicionales por especialización se alternan entre rondas.<br>
                    Ejemplo: 1.5 ataques = 2 ataques en una ronda, 1 en la siguiente.
                </p>
            </div>
        </div>
    </div>

    <!-- Salvaciones -->
    <div class="combat-section">
        <h3 style="color: #ffd700; margin-bottom: 1rem;">🛡️ Tiradas de Salvación</h3>
        
        <div class="saving-throws-grid" id="saving-throws">
            <div class="saving-throw-item">
                <div class="save-name">Parálisis/Veneno/Muerte</div>
                <div class="save-value" id="save-paralysis">10</div>
            </div>
            <div class="saving-throw-item">
                <div class="save-name">Varas/Bastones/Hechizos</div>
                <div class="save-value" id="save-rods">13</div>
            </div>
            <div class="saving-throw-item">
                <div class="save-name">Petrificación/Transformación</div>
                <div class="save-value" id="save-petrification">12</div>
            </div>
            <div class="saving-throw-item">
                <div class="save-name">Aliento de Dragón</div>
                <div class="save-value" id="save-breath">15</div>
            </div>
            <div class="saving-throw-item">
                <div class="save-name">Conjuros</div>
                <div class="save-value" id="save-spells">14</div>
            </div>
        </div>
    </div>
</div>

<style>
/* Estilos específicos para Combat Tab */
.combat-stats-row {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 1rem;
    margin-bottom: 2rem;
}

.combat-stat {
    background: linear-gradient(135deg, rgba(220, 20, 60, 0.1), rgba(255, 69, 0, 0.1));
    border: 1px solid rgba(220, 20, 60, 0.3);
}

.combat-section {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    padding: 2rem;
    margin-bottom: 2rem;
}

/* Armas Equipadas */
.equipped-weapons {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
}

.weapon-slot-combat {
    background: rgba(0, 0, 0, 0.3);
    border: 2px dashed rgba(255, 255, 255, 0.2);
    border-radius: 12px;
    padding: 1.5rem;
    text-align: center;
    transition: all 0.3s ease;
}

.weapon-slot-combat:hover {
    border-color: rgba(255, 215, 0, 0.5);
    background: rgba(255, 215, 0, 0.05);
}

.weapon-slot-combat.equipped {
    border-style: solid;
    border-color: #ffd700;
    background: rgba(255, 215, 0, 0.1);
}

.slot-label {
    color: #b0b0b0;
    font-size: 0.9rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 1rem;
}

.weapon-info {
    margin-bottom: 1rem;
}

.weapon-name-combat {
    color: #ffd700;
    font-weight: bold;
    font-size: 1.1rem;
    margin-bottom: 0.5rem;
}

.weapon-stats-combat {
    display: flex;
    flex-direction: column;
    gap: 0.3rem;
    color: #e5e5e5;
    font-size: 0.9rem;
}

.weapon-note {
    color: #b0b0b0;
    font-style: italic;
}

.equip-weapon-btn, .change-armor-btn {
    padding: 0.6rem 1.2rem;
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 6px;
    background: rgba(255, 255, 255, 0.05);
    color: #e5e5e5;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 0.9rem;
}

.equip-weapon-btn:hover, .change-armor-btn:hover {
    border-color: #ffd700;
    background: rgba(255, 215, 0, 0.1);
    color: #ffd700;
}

/* Estilos de Combate Activos */
.active-combat-styles {
    display: grid;
    gap: 1rem;
}

.combat-style-active {
    background: rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(255, 215, 0, 0.3);
    border-radius: 8px;
    padding: 1.5rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.style-info-active {
    flex: 1;
}

.style-name-active {
    color: #ffd700;
    font-weight: bold;
    font-size: 1.1rem;
    margin-bottom: 0.5rem;
}

.style-level-active {
    color: #b0b0b0;
    font-size: 0.9rem;
    margin-bottom: 0.3rem;
}

.style-effects-active {
    color: #e5e5e5;
    font-size: 0.9rem;
}

.style-toggle-btn {
    padding: 0.8rem 1.2rem;
    border: 2px solid rgba(255, 215, 0, 0.5);
    border-radius: 8px;
    background: transparent;
    color: #ffd700;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: bold;
}

.style-toggle-btn:hover {
    background: rgba(255, 215, 0, 0.1);
}

.style-toggle-btn.active {
    background: rgba(255, 215, 0, 0.3);
    border-color: #ffd700;
}

/* Armadura y Protección */
.armor-protection-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
}

.armor-slot-combat {
    background: rgba(0, 100, 200, 0.1);
    border: 1px solid rgba(0, 100, 200, 0.3);
    border-radius: 8px;
    padding: 1.5rem;
    text-align: center;
}

.armor-type-label {
    color: #4da6ff;
    font-weight: bold;
    margin-bottom: 1rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.armor-info {
    margin-bottom: 1rem;
}

.armor-name {
    color: #4da6ff;
    font-weight: bold;
    font-size: 1rem;
    margin-bottom: 0.5rem;
}

.armor-stats {
    display: flex;
    flex-direction: column;
    gap: 0.3rem;
    color: #e5e5e5;
    font-size: 0.9rem;
}

/* Desglose de CA */
.ac-modifiers {
    background: rgba(0, 0, 0, 0.2);
    border-radius: 8px;
    padding: 1.5rem;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.ac-breakdown-list {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.ac-modifier-item {
    display: flex;
    justify-content: space-between;
    color: #e5e5e5;
    font-size: 0.9rem;
}

.ac-modifier-total {
    display: flex;
    justify-content: space-between;
    color: #ffd700;
    font-size: 1rem;
    margin-top: 0.5rem;
    padding-top: 0.5rem;
    border-top: 1px solid rgba(255, 255, 255, 0.2);
}

/* Ataques por Ronda */
.attacks-per-round {
    display: grid;
    gap: 1.5rem;
}

.attacks-info {
    background: rgba(0, 0, 0, 0.2);
    border-radius: 8px;
    padding: 1.5rem;
    border: 1px solid rgba(255, 255, 255, 0.1);
    display: grid;
    gap: 0.8rem;
}

.base-attacks, .specialization-attacks, .style-attacks, .total-attacks {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.attacks-label {
    color: #e5e5e5;
    font-size: 0.9rem;
}

.attacks-value {
    color: #ffd700;
    font-weight: bold;
}

.total-attacks {
    border-top: 1px solid rgba(255, 255, 255, 0.2);
    padding-top: 0.8rem;
    margin-top: 0.5rem;
}

.attacks-note {
    background: rgba(255, 215, 0, 0.05);
    border-left: 3px solid #ffd700;
    padding: 1rem;
    border-radius: 0 8px 8px 0;
}

/* Tiradas de Salvación */
.saving-throws-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
}

.saving-throw-item {
    background: rgba(0, 150, 0, 0.1);
    border: 1px solid rgba(0, 150, 0, 0.3);
    border-radius: 8px;
    padding: 1rem;
    text-align: center;
    transition: all 0.3s ease;
}

.saving-throw-item:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(0, 150, 0, 0.2);
}

.save-name {
    color: #90EE90;
    font-weight: bold;
    font-size: 0.9rem;
    margin-bottom: 0.5rem;
    text-transform: uppercase;
    letter-spacing: 0.3px;
}

.save-value {
    color: #00FF7F;
    font-size: 1.5rem;
    font-weight: bold;
}

.no-styles-active {
    text-align: center;
    padding: 2rem;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 8px;
    border: 1px dashed rgba(255, 255, 255, 0.2);
}

/* Responsive Design */
@media (max-width: 768px) {
    .combat-stats-row {
        grid-template-columns: repeat(2, 1fr);
    }
    
    .equipped-weapons {
        grid-template-columns: 1fr;
    }
    
    .armor-protection-grid {
        grid-template-columns: 1fr;
    }
    
    .saving-throws-grid {
        grid-template-columns: 1fr;
    }
    
    .weapon-stats-combat {
        flex-direction: row;
        flex-wrap: wrap;
        justify-content: space-around;
        gap: 0.5rem;
    }
}

@media (max-width: 480px) {
    .combat-stats-row {
        grid-template-columns: 1fr;
    }
    
    .weapon-stats-combat {
        flex-direction: column;
    }
}
</style>

<<!-- Skills Tab -->
<div id="skills-tab" class="tab-content">
    <h2 style="color: #ffd700; margin-bottom: 2rem;">🎯 Pericias</h2>

    <!-- Pericias en Armas -->
    <div class="skills-section">
        <h3 style="color: #ffd700; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
            ⚔️ Pericias en Armas
            <span class="slot-counter" id="weapon-slots-counter">0/0 casillas</span>
        </h3>
        
        <div class="weapons-proficiency-container">
            <div class="weapon-search-container">
                <input type="text" id="weapon-search" class="form-input" placeholder="🔍 Buscar arma..." style="margin-bottom: 1rem;">
            </div>
            
            <div class="weapons-grid" id="weapons-proficiency-grid">
                <!-- Las armas se cargarán dinámicamente aquí -->
            </div>
        </div>
    </div>

    <!-- Pericias en No-Armas -->
    <div class="skills-section">
        <h3 style="color: #ffd700; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
            🛠️ Pericias en No-Armas
            <span class="slot-counter" id="nonweapon-slots-counter">0/0 casillas</span>
        </h3>
        
        <div class="nonweapon-proficiency-container">
            <div class="skill-search-container">
                <input type="text" id="skill-search" class="form-input" placeholder="🔍 Buscar pericia..." style="margin-bottom: 1rem;">
                <select id="skill-group-filter" class="form-input" style="margin-bottom: 1rem;">
                    <option value="all">Todos los grupos</option>
                    <option value="Gen">General (Gen)</option>
                    <option value="Luc">Luchador (Luc)</option>
                    <option value="Sac">Sacerdote (Sac)</option>
                    <option value="Hec">Hechicero (Hec/Mago)</option>
                    <option value="Bri">Bribón (Bri)</option>
                    <option value="Psi">Psiónico (Psi)</option>
                </select>
            </div>
            
            <div class="skills-grid" id="nonweapon-skills-grid">
                <!-- Las pericias se cargarán dinámicamente aquí -->
            </div>
        </div>
    </div>

    <!-- Estilos de Combate -->
    <div class="skills-section">
        <h3 style="color: #ffd700; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
            🥋 Estilos de Combate
            <span class="slot-counter" id="combat-styles-counter">0/0 casillas</span>
            <small style="color: #b0b0b0; font-size: 0.8rem; margin-left: 1rem;">(Solo Luchadores)</small>
        </h3>
        
        <div class="combat-styles-container" id="combat-styles-container">
            <!-- Los estilos se cargarán dinámicamente según la clase -->
        </div>
    </div>
</div>

<style>
/* Estilos específicos para el tab de Skills */
.skills-section {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    padding: 2rem;
    margin-bottom: 2rem;
}

.slot-counter {
    background: rgba(255, 215, 0, 0.2);
    color: #ffd700;
    padding: 0.3rem 0.8rem;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: bold;
    border: 1px solid rgba(255, 215, 0, 0.3);
}

.weapons-grid, .skills-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 1rem;
    max-height: 500px;
    overflow-y: auto;
    padding: 0.5rem;
}

.weapon-item, .skill-item {
    background: rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    padding: 1rem;
    transition: all 0.3s ease;
    position: relative;
}

.weapon-item:hover, .skill-item:hover {
    border-color: rgba(255, 215, 0, 0.5);
    background: rgba(255, 215, 0, 0.05);
    transform: translateY(-2px);
}

.item-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.8rem;
}

.item-name {
    color: #ffd700;
    font-weight: bold;
    font-size: 1rem;
    flex: 1;
}

.item-group {
    background: rgba(0, 150, 255, 0.2);
    color: #87ceeb;
    padding: 0.2rem 0.5rem;
    border-radius: 12px;
    font-size: 0.75rem;
    margin-left: 0.5rem;
}

.item-details {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
    color: #e5e5e5;
    font-size: 0.9rem;
}

.item-characteristic {
    color: #b0b0b0;
}

.item-modifier {
    color: #ffd700;
    font-weight: bold;
}

.proficiency-controls {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.proficiency-level {
    display: flex;
    align-items: center;
    gap: 0.3rem;
}

.level-btn {
    width: 30px;
    height: 30px;
    border: 2px solid rgba(255, 255, 255, 0.2);
    border-radius: 6px;
    background: transparent;
    color: #e5e5e5;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 0.8rem;
    font-weight: bold;
}

.level-btn:hover {
    border-color: #ffd700;
    background: rgba(255, 215, 0, 0.1);
}

.level-btn.active {
    border-color: #ffd700;
    background: rgba(255, 215, 0, 0.3);
    color: #ffd700;
}

.level-btn.disabled {
    border-color: rgba(255, 255, 255, 0.1);
    color: rgba(255, 255, 255, 0.3);
    cursor: not-allowed;
}

.mastery-info {
    margin-top: 0.5rem;
    padding: 0.5rem;
    background: rgba(255, 215, 0, 0.1);
    border-radius: 6px;
    border-left: 3px solid #ffd700;
    font-size: 0.8rem;
    color: #e5e5e5;
    display: none;
}

.mastery-info.show {
    display: block;
}

.slots-required {
    color: #ffd700;
    font-weight: bold;
    margin-left: auto;
    font-size: 0.85rem;
}

.combat-styles-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
    gap: 1.5rem;
}

.combat-style-card {
    background: rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    padding: 1.5rem;
    transition: all 0.3s ease;
}

.combat-style-card:hover {
    border-color: rgba(255, 215, 0, 0.5);
    background: rgba(255, 215, 0, 0.05);
}

.style-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
}

.style-name {
    color: #ffd700;
    font-weight: bold;
    font-size: 1.1rem;
}

.style-cost {
    color: #b0b0b0;
    font-size: 0.85rem;
}

.style-description {
    color: #e5e5e5;
    margin-bottom: 1rem;
    line-height: 1.4;
    font-size: 0.9rem;
}

.style-levels {
    display: flex;
    flex-direction: column;
    gap: 0.8rem;
}

.style-level {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 0.8rem;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 8px;
    border-left: 3px solid transparent;
    transition: all 0.3s ease;
}

.style-level.purchased {
    border-left-color: #ffd700;
    background: rgba(255, 215, 0, 0.1);
}

.style-level-name {
    font-weight: bold;
    color: #ffd700;
    min-width: 100px;
}

.style-level-effect {
    flex: 1;
    color: #e5e5e5;
    font-size: 0.9rem;
}

.style-level-btn {
    padding: 0.4rem 0.8rem;
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 6px;
    background: transparent;
    color: #e5e5e5;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 0.8rem;
}

.style-level-btn:hover {
    border-color: #ffd700;
    background: rgba(255, 215, 0, 0.1);
    color: #ffd700;
}

.style-level-btn.purchased {
    background: rgba(255, 215, 0, 0.3);
    border-color: #ffd700;
    color: #ffd700;
}

.style-level-btn.disabled {
    border-color: rgba(255, 255, 255, 0.1);
    color: rgba(255, 255, 255, 0.3);
    cursor: not-allowed;
}

.no-styles-message {
    text-align: center;
    color: #b0b0b0;
    font-style: italic;
    padding: 2rem;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 8px;
}

/* Filtros y búsqueda */
.weapon-search-container, .skill-search-container {
    margin-bottom: 1rem;
    display: grid;
    grid-template-columns: 1fr;
    gap: 0.5rem;
}

.skill-search-container {
    grid-template-columns: 1fr 200px;
}

@media (max-width: 768px) {
    .weapons-grid, .skills-grid {
        grid-template-columns: 1fr;
    }
    
    .combat-styles-container {
        grid-template-columns: 1fr;
    }
    
    .skill-search-container {
        grid-template-columns: 1fr;
    }
}
</style>
            <!-- Spells Tab -->
            <div id="spells-tab" class="tab-content">
                <h2 style="color: #ffd700; margin-bottom: 2rem;">✨ Conjuros</h2>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">Tipo de Lanzador</label>
                        <select class="form-input" id="casterType" onchange="updateSpellList()">
                            <option value="">Selecciona tipo</option>
                            <option value="wizard">Mago/Hechicero</option>
                            <option value="priest">Clérigo/Druida</option>
                            <option value="psionic">Psiónico</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Nivel de Conjuro</label>
                        <select class="form-input" id="spellLevel" onchange="filterSpells()">
                            <option value="">Todos los niveles</option>
                            <option value="1">Nivel 1</option>
                            <option value="2">Nivel 2</option>
                            <option value="3">Nivel 3</option>
                            <option value="4">Nivel 4</option>
                            <option value="5">Nivel 5</option>
                            <option value="6">Nivel 6</option>
                            <option value="7">Nivel 7</option>
                            <option value="8">Nivel 8</option>
                            <option value="9">Nivel 9</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Buscar Conjuro</label>
                        <input type="text" class="form-input" id="spellSearch" placeholder="Nombre del conjuro..." oninput="searchSpells()">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Explorar Listas</label>
                        <button class="btn btn-secondary" onclick="browseSpellLists()">📜 Ver Lista Completa</button>
                    </div>
                </div>
                
                <!-- Botones adicionales para manejo de conjuros -->
                <div class="form-grid" style="margin-bottom: 1rem;">
                    <div class="form-group">
                        <label class="form-label">Buscar Online</label>
                        <button class="btn btn-secondary" onclick="searchSpellOnline()" id="onlineSearchBtn" disabled>🔍 Buscar en Wiki</button>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Importar Texto</label>
                        <button class="btn btn-primary" onclick="parseSpellsFromText()">🔥 Importar Lista</button>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Gestión</label>
                        <button class="btn btn-secondary" onclick="exportCustomSpells()">📤 Exportar</button>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Archivos</label>
                        <button class="btn btn-secondary" onclick="importCustomSpells()">📁 Importar JSON</button>
                    </div>
                </div>

                <!-- Spell Slots Display -->
                <div id="spellSlotsContainer" style="display: none;">
                    <h3 style="color: #ffd700; margin: 2rem 0 1rem;">Espacios de Conjuro por Nivel</h3>
                    <div id="spellSlotsGrid" class="stats-row">
                        <!-- Spell slots will be dynamically generated here -->
                    </div>
                </div>

                <!-- Known Spells -->
                <div id="knownSpellsContainer">
                    <h3 style="color: #ffd700; margin: 2rem 0 1rem;">Conjuros Conocidos</h3>
                    <div id="knownSpellsList" class="spells-list">
                        <p style="color: #b0b0b0; text-align: center; margin: 2rem 0;">
                            Selecciona un tipo de lanzador para ver conjuros disponibles
                        </p>
                    </div>
                </div>

                <!-- Add Spell Button -->
                <div style="text-align: center; margin-top: 2rem;">
                    <button class="btn btn-primary" onclick="addCustomSpell()" id="addSpellBtn" disabled">➕ Añadir Conjuro Manual</button>
                </div>
            </div>

            <!-- Equipment Tab -->
            <div id="equipment-tab" class="tab-content active">
                <h2 style="color: #ffd700; margin-bottom: 2rem;">🎒 Equipo del Personaje</h2>
                
                <!-- Quick Equipment Buttons -->
                <div class="quick-equip-buttons">
                    <button class="quick-equip-btn" onclick="quickEquipSet('warrior')">⚔️ Guerrero</button>
                    <button class="quick-equip-btn" onclick="quickEquipSet('mage')">🔮 Mago</button>
                    <button class="quick-equip-btn" onclick="quickEquipSet('rogue')">🗡️ Pícaro</button>
                    <button class="quick-equip-btn" onclick="quickEquipSet('priest')">🛡️ Clérigo</button>
                    <button class="quick-equip-btn" onclick="clearAllEquipment()">🧹 Limpiar Todo</button>
                </div>

                <!-- Head & Neck Equipment -->
                <div class="equipment-section">
                    <h3>👑 Cabeza y Cuello</h3>
                    <div class="equipment-grid">
                        <div class="equipment-slot" id="helmet-slot" onclick="equipItem('helmet')">
                            <div class="slot-label">Casco/Yelmo</div>
                            <div class="slot-item slot-empty">Vacío</div>
                        </div>
                        <div class="equipment-slot" id="crown-slot" onclick="equipItem('crown')">
                            <div class="slot-label">Corona/Tiara</div>
                            <div class="slot-item slot-empty">Vacío</div>
                        </div>
                        <div class="equipment-slot" id="neck-slot" onclick="equipItem('neck')">
                            <div class="slot-label">Cuello</div>
                            <div class="slot-item slot-empty">Vacío</div>
                        </div>
                        <div class="equipment-slot" id="cloak-slot" onclick="equipItem('cloak')">
                            <div class="slot-label">Capa/Manto</div>
                            <div class="slot-item slot-empty">Vacío</div>
                        </div>
                    </div>
                </div>

                <!-- Arms & Hands Equipment -->
                <div class="equipment-section">
                    <h3>🤲 Brazos y Manos</h3>
                    <div class="equipment-grid">
                        <div class="equipment-slot" id="bracers-slot" onclick="equipItem('bracers')">
                            <div class="slot-label">Brazales</div>
                            <div class="slot-item slot-empty">Vacío</div>
                        </div>
                        <div class="equipment-slot" id="gauntlets-slot" onclick="equipItem('gauntlets')">
                            <div class="slot-label">Guanteletes</div>
                            <div class="slot-item slot-empty">Vacío</div>
                        </div>
                        <div class="equipment-slot" id="ring1-slot" onclick="equipItem('ring1')">
                            <div class="slot-label">Anillo 1</div>
                            <div class="slot-item slot-empty">Vacío</div>
                        </div>
                        <div class="equipment-slot" id="ring2-slot" onclick="equipItem('ring2')">
                            <div class="slot-label">Anillo 2</div>
                            <div class="slot-item slot-empty">Vacío</div>
                        </div>
                    </div>
                </div>

                <!-- Body & Feet Equipment -->
                <div class="equipment-section">
                    <h3>👕 Cuerpo y Pies</h3>
                    <div class="equipment-grid">
                        <div class="equipment-slot" id="armor-slot" onclick="equipItem('armor')">
                            <div class="slot-label">Armadura</div>
                            <div class="slot-item slot-empty">Vacío</div>
                        </div>
                        <div class="equipment-slot" id="shield-slot" onclick="equipItem('shield')">
                            <div class="slot-label">Escudo</div>
                            <div class="slot-item slot-empty">Vacío</div>
                        </div>
                        <div class="equipment-slot" id="boots-slot" onclick="equipItem('boots')">
                            <div class="slot-label">Botas</div>
                            <div class="slot-item slot-empty">Vacío</div>
                        </div>
                        <div class="equipment-slot" id="belt-slot" onclick="equipItem('belt')">
                            <div class="slot-label">Cinturón</div>
                            <div class="slot-item slot-empty">Vacío</div>
                        </div>
                    </div>
                </div>

                <!-- Weapons Section -->
                <div class="equipment-section">
                    <h3>⚔️ Armas</h3>
                    <div class="equipment-grid">
                        <div class="equipment-slot weapon-slot" id="weapon1-slot" onclick="equipWeapon('weapon1')">
                            <div class="slot-label">Arma Principal</div>
                            <div class="slot-item slot-empty">Vacío</div>
                        </div>
                        <div class="equipment-slot weapon-slot" id="weapon2-slot" onclick="equipWeapon('weapon2')">
                            <div class="slot-label">Arma Secundaria</div>
                            <div class="slot-item slot-empty">Vacío</div>
                        </div>
                        <div class="equipment-slot weapon-slot" id="weapon3-slot" onclick="equipWeapon('weapon3')">
                            <div class="slot-label">Arma Terciaria</div>
                            <div class="slot-item slot-empty">Vacío</div>
                        </div>
                        <div class="equipment-slot weapon-slot" id="weapon4-slot" onclick="equipWeapon('weapon4')">
                            <div class="slot-label">Arma de Distancia</div>
                            <div class="slot-item slot-empty">Vacío</div>
                        </div>
                        <div class="equipment-slot weapon-slot" id="weapon5-slot" onclick="equipWeapon('weapon5')">
                            <div class="slot-label">Arma Especial</div>
                            <div class="slot-item slot-empty">Vacío</div>
                        </div>
                    </div>
                </div>

                <!-- Armor Statistics -->
                <div class="armor-stats">
                    <h4>📊 Estadísticas de Protección</h4>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <span class="label">Clase de Armadura:</span>
                            <span class="value" id="equipmentAC">10</span>
                        </div>
                        <div class="stat-item">
                            <span class="label">Peso Total:</span>
                            <span class="value" id="totalWeight">0 kg</span>
                        </div>
                        <div class="stat-item">
                            <span class="label">Penalizador Destreza:</span>
                            <span class="value" id="dexPenalty">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="label">Max Bonif. Destreza:</span>
                            <span class="value" id="maxDexBonus">+6</span>
                        </div>
                        <div class="stat-item">
                            <span class="label">Velocidad:</span>
                            <span class="value" id="armorSpeed">12</span>
                        </div>
                        <div class="stat-item">
                            <span class="label">Resistencia Mágica:</span>
                            <span class="value" id="magicResistance">0%</span>
                        </div>
                    </div>
                </div>

                <!-- Additional Equipment -->
                <div class="equipment-section">
                    <h3>🎒 Inventario Adicional</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Dinero (MO)</label>
                            <input type="number" class="form-input" id="gold" value="0" min="0" onchange="updateMoney()">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Monedas Plata (MP)</label>
                            <input type="number" class="form-input" id="silver" value="0" min="0" onchange="updateMoney()">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Monedas Cobre (MC)</label>
                            <input type="number" class="form-input" id="copper" value="0" min="0" onchange="updateMoney()">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Valor Total (MO)</label>
                            <input type="text" class="form-input" id="totalValue" value="0 MO" readonly>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Objetos Adicionales</label>
                        <textarea class="form-input" id="additionalItems" rows="4" placeholder="Ej: Cuerda de seda (50 pies), Kit de ladrón, Poción de curación..."></textarea>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Dice Roller -->
    <div class="dice-roller">
        <button class="dice-btn" onclick="rollDice(20)" title="Tirar d20">🎲</button>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification"></div>

    <script>
        // Global character data
        let character = {
            name: '',
            playerName: '',
            race: '',
            alignment: 'N',
            primaryClass: '',
            secondaryClass: '',
            tertiaryClass: '',
            specificClass: '',
            level: 1,
            experience: 0,
            abilities: {
                strength: 10,
                dexterity: 10,
                constitution: 10,
                intelligence: 10,
                wisdom: 10,
                charisma: 10
            },
            hitPoints: 10,
            armorClass: 10,
            gaco: 20,
            equipment: {
                helmet: null,
                crown: null,
                neck: null,
                cloak: null,
                bracers: null,
                gauntlets: null,
                ring1: null,
                ring2: null,
                armor: null,
                shield: null,
                boots: null,
                belt: null,
                weapon1: null,
                weapon2: null,
                weapon3: null,
                weapon4: null,
                weapon5: null
            },
            money: {
                gold: 0,
                silver: 0,
                copper: 0
            },
            additionalItems: '',
            knownSpells: []
        };

        // Equipment Database
        const equipmentDatabase = {
            helmet: [
                { name: 'Casco de Cuero', ac: 0, weight: 1, type: 'light', price: '5 MO' },
                { name: 'Yelmo de Acero', ac: 0, weight: 3, type: 'medium', price: '15 MO' },
                { name: 'Gran Yelmo', ac: 1, weight: 5, type: 'heavy', price: '50 MO' },
                { name: 'Yelmo Encantado +1', ac: 1, weight: 3, type: 'magic', price: '1000 MO' }
            ],
            crown: [
                { name: 'Corona de Cobre', ac: 0, weight: 0.5, type: 'light', price: '25 MO' },
                { name: 'Corona Real', ac: 0, weight: 1, type: 'medium', price: '500 MO' },
                { name: 'Tiara Élfica', ac: 0, weight: 0.2, type: 'magic', price: '2000 MO' },
                { name: 'Diadema del Intelecto', ac: 0, weight: 0.1, type: 'magic', price: '5000 MO' }
            ],
            neck: [
                { name: 'Collar de Cuero', ac: 0, weight: 0.2, type: 'light', price: '2 MO' },
                { name: 'Cadena de Plata', ac: 0, weight: 0.5, type: 'medium', price: '50 MO' },
                { name: 'Amuleto de Protección', ac: 1, weight: 0.1, type: 'magic', price: '1500 MO' },
                { name: 'Medallón Sagrado', ac: 0, weight: 0.3, type: 'magic', price: '800 MO' }
            ],
            cloak: [
                { name: 'Capa de Viaje', ac: 0, weight: 2, type: 'light', price: '8 MO' },
                { name: 'Manto de Lana', ac: 0, weight: 3, type: 'medium', price: '15 MO' },
                { name: 'Capa de Desplazamiento', ac: 2, weight: 1, type: 'magic', price: '3500 MO' },
                { name: 'Manto Élfico', ac: 1, weight: 1.5, type: 'magic', price: '2000 MO' }
            ],
            bracers: [
                { name: 'Brazales de Cuero', ac: 0, weight: 1, type: 'light', price: '10 MO' },
                { name: 'Brazales de Acero', ac: 1, weight: 3, type: 'medium', price: '75 MO' },
                { name: 'Brazales de Defensa CA 6', ac: 4, weight: 2, type: 'magic', price: '2000 MO' },
                { name: 'Brazales de Defensa CA 4', ac: 6, weight: 2, type: 'magic', price: '8000 MO' }
            ],
            gauntlets: [
                { name: 'Guantes de Cuero', ac: 0, weight: 0.5, type: 'light', price: '5 MO' },
                { name: 'Guanteletes', ac: 0, weight: 2, type: 'medium', price: '25 MO' },
                { name: 'Guanteletes de Poder de Ogro', ac: 0, weight: 2, type: 'magic', price: '3000 MO' },
                { name: 'Guanteletes de Destreza', ac: 0, weight: 1, type: 'magic', price: '2500 MO' }
            ],
            ring1: [
                { name: 'Anillo de Cobre', ac: 0, weight: 0.1, type: 'light', price: '1 MO' },
                { name: 'Anillo de Plata', ac: 0, weight: 0.1, type: 'medium', price: '10 MO' },
                { name: 'Anillo de Protección +1', ac: 1, weight: 0.1, type: 'magic', price: '2000 MO' },
                { name: 'Anillo de Invisibilidad', ac: 0, weight: 0.1, type: 'magic', price: '7500 MO' }
            ],
            ring2: [
                { name: 'Anillo de Cobre', ac: 0, weight: 0.1, type: 'light', price: '1 MO' },
                { name: 'Anillo de Oro', ac: 0, weight: 0.1, type: 'medium', price: '50 MO' },
                { name: 'Anillo de Protección +2', ac: 2, weight: 0.1, type: 'magic', price: '5000 MO' },
                { name: 'Anillo de Regeneración', ac: 0, weight: 0.1, type: 'magic', price: '15000 MO' }
            ],
            armor: [
                { name: 'Sin Armadura', ac: 10, weight: 0, type: 'none', price: '0 MO' },
                { name: 'Armadura de Cuero', ac: 8, weight: 13, type: 'light', price: '10 MO' },
                { name: 'Cuero Tachonado', ac: 7, weight: 11, type: 'light', price: '25 MO' },
                { name: 'Cota de Malla', ac: 5, weight: 18, type: 'medium', price: '100 MO' },
                { name: 'Armadura de Escamas', ac: 6, weight: 18, type: 'medium', price: '120 MO' },
                { name: 'Armadura de Placas', ac: 3, weight: 22, type: 'heavy', price: '600 MO' },
                { name: 'Armadura Completa', ac: 2, weight: 31, type: 'heavy', price: '1200 MO' },
                { name: 'Armadura +1', ac: 2, weight: 18, type: 'magic', price: '3000 MO' }
            ],
            shield: [
                { name: 'Sin Escudo', ac: 0, weight: 0, type: 'none', price: '0 MO' },
                { name: 'Escudo Pequeño', ac: 1, weight: 2, type: 'light', price: '3 MO' },
                { name: 'Escudo Mediano', ac: 1, weight: 5, type: 'medium', price: '7 MO' },
                { name: 'Escudo Grande', ac: 2, weight: 8, type: 'heavy', price: '15 MO' },
                { name: 'Escudo +1', ac: 2, weight: 5, type: 'magic', price: '1500 MO' },
                { name: 'Escudo +2', ac: 3, weight: 5, type: 'magic', price: '4000 MO' }
            ],
            boots: [
                { name: 'Sandalias', ac: 0, weight: 0.5, type: 'light', price: '2 MO' },
                { name: 'Botas de Cuero', ac: 0, weight: 1, type: 'medium', price: '8 MO' },
                { name: 'Botas de Velocidad', ac: 0, weight: 1, type: 'magic', price: '5000 MO' },
                { name: 'Botas de Andar por el Agua', ac: 0, weight: 1, type: 'magic', price: '3000 MO' }
            ],
            belt: [
                { name: 'Cinturón de Cuerda', ac: 0, weight: 0.5, type: 'light', price: '1 MO' },
                { name: 'Cinturón de Cuero', ac: 0, weight: 1, type: 'medium', price: '5 MO' },
                { name: 'Cinturón de Fuerza de Gigante', ac: 0, weight: 1, type: 'magic', price: '8000 MO' },
                { name: 'Cinturón Élfico', ac: 0, weight: 0.5, type: 'magic', price: '2500 MO' }
            ],
            weapon1: [
                { name: 'Puños', damage: '1d3', weight: 0, type: 'none', price: '0 MO' },
                { name: 'Daga', damage: '1d4', weight: 1, type: 'light', price: '2 MO' },
                { name: 'Espada Corta', damage: '1d6', weight: 1, type: 'light', price: '10 MO' },
                { name: 'Espada Larga', damage: '1d8', weight: 2, type: 'medium', price: '15 MO' },
                { name: 'Espada Mandoble', damage: '2d6', weight: 7, type: 'heavy', price: '50 MO' },
                { name: 'Hacha de Mano', damage: '1d6', weight: 2, type: 'light', price: '5 MO' },
                { name: 'Hacha de Batalla', damage: '1d8', weight: 3, type: 'medium', price: '5 MO' },
                { name: 'Gran Hacha', damage: '1d12', weight: 7, type: 'heavy', price: '30 MO' },
                { name: 'Martillo de Guerra', damage: '1d8', weight: 3, type: 'medium', price: '2 MO' },
                { name: 'Maza', damage: '1d6', weight: 4, type: 'medium', price: '5 MO' },
                { name: 'Lanza', damage: '1d6', weight: 2, type: 'medium', price: '6 MO' },
                { name: 'Alabarda', damage: '1d10', weight: 7, type: 'heavy', price: '10 MO' },
                { name: 'Espada +1', damage: '1d8+1', weight: 2, type: 'magic', price: '2000 MO' },
                { name: 'Espada Flamígera +2', damage: '1d8+2', weight: 2, type: 'magic', price: '5000 MO' }
            ],
            weapon2: [
                { name: 'Vacío', damage: '0', weight: 0, type: 'none', price: '0 MO' },
                { name: 'Daga Arrojadiza', damage: '1d4', weight: 1, type: 'light', price: '2 MO' },
                { name: 'Puñal', damage: '1d4', weight: 1, type: 'light', price: '2 MO' },
                { name: 'Martillo Ligero', damage: '1d4', weight: 2, type: 'light', price: '2 MO' },
                { name: 'Hacha de Mano', damage: '1d6', weight: 2, type: 'light', price: '5 MO' },
                { name: 'Maza Ligera', damage: '1d6', weight: 4, type: 'medium', price: '5 MO' },
                { name: 'Cimitarra', damage: '1d6', weight: 2, type: 'light', price: '15 MO' },
                { name: 'Estoque', damage: '1d6', weight: 2, type: 'light', price: '25 MO' }
            ],
            weapon3: [
                { name: 'Vacío', damage: '0', weight: 0, type: 'none', price: '0 MO' },
                { name: 'Bastón', damage: '1d6', weight: 4, type: 'medium', price: '1 MO' },
                { name: 'Vara', damage: '1d8', weight: 8, type: 'medium', price: '2 MO' },
                { name: 'Tridente', damage: '1d6', weight: 2, type: 'medium', price: '15 MO' },
                { name: 'Lanza de Caballería', damage: '1d12', weight: 5, type: 'heavy', price: '10 MO' }
            ],
            weapon4: [
                { name: 'Vacío', damage: '0', weight: 0, type: 'none', price: '0 MO' },
                { name: 'Honda', damage: '1d4', weight: 0, type: 'light', price: '5 MC' },
                { name: 'Dardo', damage: '1d3', weight: 0.25, type: 'light', price: '5 PP' },
                { name: 'Jabalina', damage: '1d6', weight: 1, type: 'light', price: '5 PP' },
                { name: 'Arco Corto', damage: '1d6', weight: 1, type: 'medium', price: '30 MO' },
                { name: 'Arco Largo', damage: '1d8', weight: 2, type: 'medium', price: '75 MO' },
                { name: 'Ballesta Ligera', damage: '1d8', weight: 2, type: 'medium', price: '35 MO' },
                { name: 'Ballesta Pesada', damage: '1d10', weight: 6, type: 'heavy', price: '50 MO' },
                { name: 'Arco Largo +1', damage: '1d8+1', weight: 2, type: 'magic', price: '2500 MO' }
            ],
            weapon5: [
                { name: 'Vacío', damage: '0', weight: 0, type: 'none', price: '0 MO' },
                { name: 'Látigo', damage: '1d2', weight: 1, type: 'exotic', price: '1 MO' },
                { name: 'Red', damage: '0', weight: 2, type: 'exotic', price: '8 MO' },
                { name: 'Mayal', damage: '1d4', weight: 6, type: 'exotic', price: '15 MO' },
                { name: 'Katana', damage: '1d10', weight: 6, type: 'exotic', price: '500+ MO' },
                { name: 'Espada Bastarda', damage: '1d8', weight: 5, type: 'exotic', price: '25 MO' },
                { name: 'Arcabuz', damage: '1d10', weight: 5, type: 'exotic', price: '500 MO' }
            ]
        };

        // Spell data - Basic spell database with most common spells
        const spellDatabase = {
            wizard: {
                1: [
                    { name: "Magic Missile", school: "Evocation", description: "Automatically hits target for 1d4+1 damage per missile" },
                    { name: "Shield", school: "Abjuration", description: "Grants AC 2 vs. missiles, AC 4 vs. other attacks" },
                    { name: "Sleep", school: "Enchantment", description: "Causes 4d4 HD of creatures to fall asleep" },
                    { name: "Charm Person", school: "Enchantment", description: "Makes person friendly and helpful" },
                    { name: "Detect Magic", school: "Divination", description: "Reveals magical auras within 60 feet" },
                    { name: "Light", school: "Alteration", description: "Creates bright light in 20-foot radius" },
                    { name: "Read Magic", school: "Divination", description: "Allows reading of magical writings" },
                    { name: "Burning Hands", school: "Alteration", description: "Cone of fire deals 1d3+2 per level damage" },
                    { name: "Identify", school: "Divination", description: "Reveals properties of magical items" },
                    { name: "Feather Fall", school: "Alteration", description: "Slows falling rate to 2 feet per second" }
                ],
                2: [
                    { name: "Fireball", school: "Evocation", description: "Explodes for 1d6 per level damage" },
                    { name: "Web", school: "Evocation", description: "Creates sticky webs to entangle foes" },
                    { name: "Mirror Image", school: "Illusion", description: "Creates 1d4+1 duplicate images" },
                    { name: "Invisibility", school: "Illusion", description: "Makes creature invisible until it attacks" },
                    { name: "Knock", school: "Alteration", description: "Opens locked doors and containers" },
                    { name: "Levitate", school: "Alteration", description: "Moves up and down at 20 feet per round" },
                    { name: "Detect Invisibility", school: "Divination", description: "Reveals invisible creatures and objects" },
                    { name: "Strength", school: "Alteration", description: "Raises Strength to 18/00 for a time" }
                ],
                3: [
                    { name: "Lightning Bolt", school: "Evocation", description: "Bolt deals 1d6 per level damage" },
                    { name: "Dispel Magic", school: "Abjuration", description: "Cancels magical effects" },
                    { name: "Hold Person", school: "Enchantment", description: "Paralyzes 1-4 persons" },
                    { name: "Fly", school: "Alteration", description: "Grants flight at 18 movement rate" },
                    { name: "Haste", school: "Alteration", description: "Doubles movement and attacks" },
                    { name: "Slow", school: "Alteration", description: "Halves movement and attacks" }
                ]
            },
            priest: {
                1: [
                    { name: "Cure Light Wounds", school: "Necromancy", description: "Heals 1d8 points of damage" },
                    { name: "Bless", school: "Conjuration", description: "Improves morale and attack rolls" },
                    { name: "Command", school: "Enchantment", description: "Subject obeys one-word command" },
                    { name: "Detect Evil", school: "Divination", description: "Reveals evil auras within 60 feet" },
                    { name: "Light", school: "Alteration", description: "Creates bright light in 20-foot radius" },
                    { name: "Protection from Evil", school: "Abjuration", description: "Ward against evil attacks" },
                    { name: "Remove Fear", school: "Abjuration", description: "Suppresses fear effects" },
                    { name: "Sanctuary", school: "Abjuration", description: "Opponents can't attack caster" }
                ],
                2: [
                    { name: "Cure Moderate Wounds", school: "Necromancy", description: "Heals 1d8+1 points of damage" },
                    { name: "Hold Person", school: "Enchantment", description: "Paralyzes one person" },
                    { name: "Silence 15' Radius", school: "Alteration", description: "Creates zone of absolute silence" },
                    { name: "Spiritual Hammer", school: "Invocation", description: "Magical hammer attacks foes" },
                    { name: "Know Alignment", school: "Divination", description: "Reveals creature's alignment" },
                    { name: "Snake Charm", school: "Enchantment", description: "Charms snakes within area" }
                ],
                3: [
                    { name: "Cure Serious Wounds", school: "Necromancy", description: "Heals 2d8+1 points of damage" },
                    { name: "Dispel Magic", school: "Abjuration", description: "Cancels magical effects" },
                    { name: "Prayer", school: "Conjuration", description: "Aids allies and hinders enemies" },
                    { name: "Remove Curse", school: "Abjuration", description: "Removes curses from creature or object" }
                ]
            },
            psionic: [
                { name: "Mind Blast", discipline: "Telepathy", description: "Mental attack that stuns opponents" },
                { name: "Levitation", discipline: "Psychokinesis", description: "Lift objects or self with mind power" },
                { name: "ESP", discipline: "Telepathy", description: "Read surface thoughts of others" },
                { name: "Telekinesis", discipline: "Psychokinesis", description: "Move objects with mental force" },
                { name: "Body Equilibrium", discipline: "Psychometabolism", description: "Walk on water or other surfaces" },
                { name: "Invisibility", discipline: "Psychometabolism", description: "Bend light to become invisible" }
            ]
        };

        // Character spell slots by level (simplified AD&D progression)
        const spellSlotsByLevel = {
            wizard: {
                1: [1, 0, 0, 0, 0, 0, 0, 0, 0],
                2: [2, 0, 0, 0, 0, 0, 0, 0, 0],
                3: [2, 1, 0, 0, 0, 0, 0, 0, 0],
                4: [3, 2, 0, 0, 0, 0, 0, 0, 0],
                5: [4, 2, 1, 0, 0, 0, 0, 0, 0],
                6: [4, 2, 2, 0, 0, 0, 0, 0, 0],
                7: [4, 3, 2, 1, 0, 0, 0, 0, 0],
                8: [4, 3, 3, 2, 0, 0, 0, 0, 0],
                9: [4, 3, 3, 2, 1, 0, 0, 0, 0],
                10: [4, 4, 3, 3, 2, 0, 0, 0, 0]
            },
            priest: {
                1: [1, 0, 0, 0, 0, 0, 0],
                2: [2, 0, 0, 0, 0, 0, 0],
                3: [2, 1, 0, 0, 0, 0, 0],
                4: [3, 2, 0, 0, 0, 0, 0],
                5: [3, 3, 1, 0, 0, 0, 0],
                6: [3, 3, 2, 0, 0, 0, 0],
                7: [3, 3, 2, 1, 0, 0, 0],
                8: [3, 3, 3, 2, 0, 0, 0],
                9: [4, 4, 3, 2, 1, 0, 0],
                10: [4, 4, 3, 3, 2, 0, 0]
            }
        };

        // Class data structure
        const classData = {
            luchador: {
                name: 'Luchador',
                classes: ['Bárbaro', 'Ranger', 'Guerrero', 'Paladín', 'Samurái'],
                hitDie: 'd10',
                primaryAbility: 'strength'
            },
            sacerdote: {
                name: 'Sacerdote',
                classes: ['Clérigo', 'Druida', 'Chamán'],
                hitDie: 'd8',
                primaryAbility: 'wisdom'
            },
            hechicero: {
                name: 'Hechicero',
                classes: ['Mago', 'Hechicero', 'Bruja', 'Artífice'],
                hitDie: 'd4',
                primaryAbility: 'intelligence'
            },
            bribon: {
                name: 'Bribón',
                classes: ['Ladrón', 'Bardo', 'Ninja', 'Psiónico', 'Pistolero'],
                hitDie: 'd6',
                primaryAbility: 'dexterity'
            }
        };

        // AD&D ability score modifiers
        const abilityModifiers = {
            strength: {
                1: { hit: -5, damage: -4 }, 2: { hit: -3, damage: -2 }, 3: { hit: -3, damage: -1 },
                4: { hit: -2, damage: -1 }, 5: { hit: -2, damage: -1 }, 6: { hit: -1, damage: 0 },
                7: { hit: -1, damage: 0 }, 8: { hit: 0, damage: 0 }, 9: { hit: 0, damage: 0 },
                10: { hit: 0, damage: 0 }, 11: { hit: 0, damage: 0 }, 12: { hit: 0, damage: 0 },
                13: { hit: 0, damage: 0 }, 14: { hit: 0, damage: 0 }, 15: { hit: 0, damage: 0 },
                16: { hit: 0, damage: 1 }, 17: { hit: 1, damage: 1 }, 18: { hit: 1, damage: 2 },
                19: { hit: 3, damage: 7 }, 20: { hit: 3, damage: 8 }, 21: { hit: 4, damage: 9 },
                22: { hit: 4, damage: 10 }, 23: { hit: 5, damage: 11 }, 24: { hit: 6, damage: 12 },
                25: { hit: 7, damage: 14 }
            },
            dexterity: {
                1: { reaction: -6, missile: -6, ac: 5 }, 2: { reaction: -4, missile: -4, ac: 5 },
                3: { reaction: -3, missile: -3, ac: 4 }, 4: { reaction: -2, missile: -2, ac: 3 },
                5: { reaction: -1, missile: -1, ac: 2 }, 6: { reaction: 0, missile: 0, ac: 1 },
                7: { reaction: 0, missile: 0, ac: 0 }, 8: { reaction: 0, missile: 0, ac: 0 },
                9: { reaction: 0, missile: 0, ac: 0 }, 10: { reaction: 0, missile: 0, ac: 0 },
                11: { reaction: 0, missile: 0, ac: 0 }, 12: { reaction: 0, missile: 0, ac: 0 },
                13: { reaction: 0, missile: 0, ac: 0 }, 14: { reaction: 0, missile: 0, ac: 0 },
                15: { reaction: 0, missile: 0, ac: -1 }, 16: { reaction: 1, missile: 1, ac: -2 },
                17: { reaction: 2, missile: 2, ac: -3 }, 18: { reaction: 2, missile: 2, ac: -4 },
                19: { reaction: 3, missile: 3, ac: -4 }, 20: { reaction: 3, missile: 3, ac: -4 },
                21: { reaction: 4, missile: 4, ac: -5 }, 22: { reaction: 4, missile: 4, ac: -5 },
                23: { reaction: 5, missile: 5, ac: -6 }, 24: { reaction: 5, missile: 5, ac: -6 },
                25: { reaction: 6, missile: 6, ac: -7 }
            },
            constitution: {
                1: { hp: -3, shock: 25, resurrection: 30 }, 2: { hp: -2, shock: 30, resurrection: 35 },
                3: { hp: -2, shock: 35, resurrection: 40 }, 4: { hp: -1, shock: 40, resurrection: 45 },
                5: { hp: -1, shock: 45, resurrection: 50 }, 6: { hp: -1, shock: 50, resurrection: 55 },
                7: { hp: 0, shock: 55, resurrection: 60 }, 8: { hp: 0, shock: 60, resurrection: 65 },
                9: { hp: 0, shock: 65, resurrection: 70 }, 10: { hp: 0, shock: 70, resurrection: 75 },
                11: { hp: 0, shock: 75, resurrection: 80 }, 12: { hp: 0, shock: 80, resurrection: 85 },
                13: { hp: 0, shock: 85, resurrection: 90 }, 14: { hp: 0, shock: 88, resurrection: 92 },
                15: { hp: 1, shock: 90, resurrection: 94 }, 16: { hp: 2, shock: 95, resurrection: 96 },
                17: { hp: 3, shock: 97, resurrection: 98 }, 18: { hp: 4, shock: 99, resurrection: 100 },
                19: { hp: 5, shock: 99, resurrection: 100 }, 20: { hp: 5, shock: 99, resurrection: 100 },
                21: { hp: 6, shock: 99, resurrection: 100 }, 22: { hp: 6, shock: 99, resurrection: 100 },
                23: { hp: 6, shock: 99, resurrection: 100 }, 24: { hp: 7, shock: 99, resurrection: 100 },
                25: { hp: 7, shock: 100, resurrection: 100 }
            }
        };

        // Equipment Functions
        function equipItem(slotType) {
            const items = equipmentDatabase[slotType] || [];
            if (items.length === 0) {
                showNotification('No hay objetos disponibles para este slot');
                return;
            }

            let optionsHtml = '<option value="">Seleccionar objeto...</option>';
            items.forEach((item, index) => {
                optionsHtml += `<option value="${index}">${item.name} (AC: ${item.ac > 0 ? '+' : ''}${item.ac}, Peso: ${item.weight}kg, ${item.price})</option>`;
            });

            const selection = prompt(`Selecciona un objeto para ${slotType}:\n\n${items.map((item, index) => 
                `${index + 1}. ${item.name} (AC: ${item.ac > 0 ? '+' : ''}${item.ac}, Peso: ${item.weight}kg, ${item.price})`
            ).join('\n')}\n\n0. Quitar objeto actual\n\nIngresa el número:`);

            if (selection === null) return;
            
            const itemIndex = parseInt(selection) - 1;
            
            if (selection === '0') {
                character.equipment[slotType] = null;
                updateEquipmentSlot(slotType, null);
            } else if (itemIndex >= 0 && itemIndex < items.length) {
                character.equipment[slotType] = items[itemIndex];
                updateEquipmentSlot(slotType, items[itemIndex]);
            } else {
                showNotification('Selección inválida');
                return;
            }
            
            updateArmorStats();
        }

        function equipWeapon(slotType) {
            equipItem(slotType);
        }

        function updateEquipmentSlot(slotType, item) {
            const slot = document.getElementById(`${slotType}-slot`);
            const itemDiv = slot.querySelector('.slot-item');
            
            if (item) {
                itemDiv.textContent = item.name;
                itemDiv.className = 'slot-item';
                slot.classList.add('occupied');
                
                if (slotType.startsWith('weapon')) {
                    itemDiv.textContent += ` (${item.damage})`;
                }
            } else {
                itemDiv.textContent = 'Vacío';
                itemDiv.className = 'slot-item slot-empty';
                slot.classList.remove('occupied');
            }
        }

        function updateArmorStats() {
            let totalAC = 10;
            let totalWeight = 0;
            let dexPenalty = 0;
            let maxDexBonus = 6;
            let speed = 12;
            
            // Calculate from equipped items
            Object.values(character.equipment).forEach(item => {
                if (item) {
                    totalWeight += item.weight;
                    if (item.ac) {
                        if (item.name === 'Sin Armadura' || item.name === 'Sin Escudo' || item.name === 'Vacío') {
                            // These don't affect AC
                        } else {
                            totalAC -= Math.abs(item.ac);
                        }
                    }
                }
            });

            // Apply dexterity modifier
            const dex = parseInt(document.getElementById('dexterity').value) || 10;
            const dexMod = abilityModifiers.dexterity[dex]?.ac || 0;
            totalAC += dexMod;

            // Update display
            document.getElementById('equipmentAC').textContent = totalAC;
            document.getElementById('totalWeight').textContent = `${totalWeight} kg`;
            document.getElementById('dexPenalty').textContent = dexPenalty;
            document.getElementById('maxDexBonus').textContent = `+${maxDexBonus}`;
            document.getElementById('armorSpeed').textContent = speed;
            document.getElementById('magicResistance').textContent = '0%';
            
            // Update main AC displays
            character.armorClass = totalAC;
            document.getElementById('armorClass').textContent = totalAC;
            document.getElementById('combatAC').textContent = totalAC;
        }

        function quickEquipSet(setType) {
            // Clear current equipment
            Object.keys(character.equipment).forEach(slot => {
                character.equipment[slot] = null;
            });

            // Quick equip sets
            const sets = {
                warrior: {
                    armor: equipmentDatabase.armor[4], // Chain Mail
                    shield: equipmentDatabase.shield[2], // Medium Shield
                    helmet: equipmentDatabase.helmet[1], // Steel Helm
                    weapon1: equipmentDatabase.weapon1[3], // Long Sword
                    weapon2: equipmentDatabase.weapon2[4], // Hand Axe
                    weapon4: equipmentDatabase.weapon4[4], // Short Bow
                    boots: equipmentDatabase.boots[1], // Leather Boots
                    cloak: equipmentDatabase.cloak[0], // Travel Cloak
                    gauntlets: equipmentDatabase.gauntlets[0] // Leather Gloves
                },
                priest: {
                    armor: equipmentDatabase.armor[3], // Chain Mail
                    shield: equipmentDatabase.shield[1], // Small Shield
                    helmet: equipmentDatabase.helmet[0], // Leather Cap
                    weapon1: equipmentDatabase.weapon1[9], // Mace
                    weapon3: equipmentDatabase.weapon3[1], // Rod
                    cloak: equipmentDatabase.cloak[1], // Wool Cloak
                    boots: equipmentDatabase.boots[1], // Leather Boots
                    neck: equipmentDatabase.neck[3] // Sacred Medallion
                }
            };

            const selectedSet = sets[setType];
            if (selectedSet) {
                Object.entries(selectedSet).forEach(([slot, item]) => {
                    character.equipment[slot] = item;
                    updateEquipmentSlot(slot, item);
                });
                updateArmorStats();
                showNotification(`Equipo de ${setType} equipado correctamente`);
            }
        }

        function clearAllEquipment() {
            Object.keys(character.equipment).forEach(slot => {
                character.equipment[slot] = null;
                updateEquipmentSlot(slot, null);
            });
            updateArmorStats();
            showNotification('Todo el equipo ha sido removido');
        }

        function updateMoney() {
            const gold = parseInt(document.getElementById('gold').value) || 0;
            const silver = parseInt(document.getElementById('silver').value) || 0;
            const copper = parseInt(document.getElementById('copper').value) || 0;
            
            character.money.gold = gold;
            character.money.silver = silver;
            character.money.copper = copper;
            
            // Calculate total value in gold
            const totalValue = gold + (silver / 10) + (copper / 100);
            document.getElementById('totalValue').value = `${totalValue.toFixed(2)} MO`;
        }

        // Notification system
        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Tab system
        function showTab(tabName, element) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(tab => tab.classList.remove('active'));
            
            // Remove active class from all tab buttons
            const tabBtns = document.querySelectorAll('.tab-btn');
            tabBtns.forEach(btn => btn.classList.remove('active'));
            
            // Show selected tab and mark button as active
            document.getElementById(tabName + '-tab').classList.add('active');
            element.classList.add('active');
        }

        // Character management functions
        function updateCharacterDisplay() {
            const name = document.getElementById('characterName').value || 'Nuevo Personaje';
            const race = document.getElementById('race').value;
            
            document.getElementById('characterNameDisplay').textContent = name;
            
            if (character.primaryClass) {
                let classDisplay = classData[character.primaryClass].name;
                if (character.specificClass) {
                    classDisplay = character.specificClass;
                }
                if (race) {
                    classDisplay = `${race} ${classDisplay}`;
                }
                document.getElementById('characterClassDisplay').textContent = classDisplay;
            }
        }

        function selectPrimaryCategory(category) {
            // Update selection
            document.querySelectorAll('.category-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            document.querySelector(`[data-category="${category}"]`).classList.add('selected');
            
            character.primaryClass = category;
            
            // Update secondary categories
            const secondaryGrid = document.getElementById('secondaryCategoryGrid');
            const otherCategories = Object.keys(classData).filter(cat => cat !== category);
            
            secondaryGrid.innerHTML = '';
            otherCategories.forEach(cat => {
                const option = document.createElement('div');
                option.className = 'category-option';
                option.setAttribute('data-category', cat);
                option.onclick = () => selectSecondaryCategory(cat);
                
                option.innerHTML = `
                    <span class="category-name">${classData[cat].name}</span>
                    <span class="category-desc">${classData[cat].classes.join(', ')}</span>
                `;
                
                secondaryGrid.appendChild(option);
            });
            
            // Update specific class options
            updateSpecificClassOptions();
            updateCharacterDisplay();
        }

        function selectSecondaryCategory(category) {
            document.querySelectorAll('#secondaryCategoryGrid .category-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            document.querySelector(`#secondaryCategoryGrid [data-category="${category}"]`).classList.add('selected');
            
            character.secondaryClass = category;
            
            // Update tertiary categories
            const tertiaryGrid = document.getElementById('tertiaryCategoryGrid');
            const remainingCategories = Object.keys(classData).filter(cat => 
                cat !== character.primaryClass && cat !== category
            );
            
            tertiaryGrid.innerHTML = '';
            remainingCategories.forEach(cat => {
                const option = document.createElement('div');
                option.className = 'category-option';
                option.setAttribute('data-category', cat);
                option.onclick = () => selectTertiaryCategory(cat);
                
                option.innerHTML = `
                    <span class="category-name">${classData[cat].name}</span>
                    <span class="category-desc">${classData[cat].classes.join(', ')}</span>
                `;
                
                tertiaryGrid.appendChild(option);
            });
        }

        function selectTertiaryCategory(category) {
            document.querySelectorAll('#tertiaryCategoryGrid .category-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            document.querySelector(`#tertiaryCategoryGrid [data-category="${category}"]`).classList.add('selected');
            
            character.tertiaryClass = category;
        }

        function updateSpecificClassOptions() {
            const specificClassSelect = document.getElementById('specificClass');
            
            if (character.primaryClass) {
                const classes = classData[character.primaryClass].classes;
                
                specificClassSelect.innerHTML = '<option value="">Selecciona una clase específica</option>';
                classes.forEach(className => {
                    const option = document.createElement('option');
                    option.value = className;
                    option.textContent = className;
                    specificClassSelect.appendChild(option);
                });
            }
        }
// ==========================================
// SISTEMA DE PERICIAS Y COMBATE AD&D 2e
// ==========================================

// Variables globales para el sistema
let skillsData = null;
let weaponsData = null;
let armorData = null;
let characterSkills = {
    weaponProficiencies: {},
    nonWeaponProficiencies: {},
    combatStyles: {}
};

// ==========================================
// DATOS BASE DEL SISTEMA
// ==========================================

// Grupos de clases
const CLASS_GROUPS = {
    'luchador': ['Bárbaro', 'Ranger', 'Guerrero', 'Paladín', 'Samurái'],
    'sacerdote': ['Clérigo', 'Druida', 'Chamán'],
    'hechicero': ['Mago', 'Hechicero', 'Bruja', 'Artífice'],
    'bribon': ['Ladrón', 'Bardo', 'Ninja', 'Psiónico', 'Pistolero']
};

// Datos de estilos de combate
const COMBAT_STYLES = {
    'sin-armas': {
        name: 'Sin Armas (Puños)',
        description: 'Combate desarmado especializado',
        availableFor: ['todos'],
        levels: {
            especialista: {
                name: 'Especialista',
                cost: 1,
                effects: '+4 CA, +0.5 ataques/ronda, 1 Arte Marcial'
            },
            maestro: {
                name: 'Maestro',
                cost: 2,
                effects: '+0.5 ataques/ronda adicional, Mejora Arte Marcial'
            }
        }
    },
    'arma-unica': {
        name: 'Arma Única',
        description: 'Especialización en combate con una sola arma',
        availableFor: ['todos'],
        levels: {
            especialista: {
                name: 'Especialista',
                cost: 1,
                effects: '+1 CA defensiva'
            },
            maestro: {
                name: 'Maestro',
                cost: 2,
                effects: '+2 CA defensiva total'
            }
        }
    },
    'arma-y-escudo': {
        name: 'Arma y Escudo',
        description: 'Combate con arma de una mano y escudo',
        availableFor: ['luchador', 'sacerdote'],
        levels: {
            especialista: {
                name: 'Especialista',
                cost: 1,
                effects: '+2 CA adicional del escudo'
            },
            maestro: {
                name: 'Maestro',
                cost: 2,
                effects: '1 ataque con escudo adicional'
            }
        }
    },
    'arma-dos-manos': {
        name: 'Arma a Dos Manos',
        description: 'Especialización en armas de dos manos',
        availableFor: ['luchador', 'sacerdote', 'hechicero'],
        levels: {
            especialista: {
                name: 'Especialista',
                cost: 1,
                effects: '+50% ajuste al daño por Fuerza'
            },
            maestro: {
                name: 'Maestro',
                cost: 2,
                effects: '+100% ajuste al daño por Fuerza'
            }
        }
    },
    'dos-armas': {
        name: 'Dos Armas',
        description: 'Combate con arma en cada mano',
        availableFor: ['luchador', 'bribon'],
        levels: {
            especialista: {
                name: 'Especialista',
                cost: 1,
                effects: 'Reduce penalizadores por combate con dos armas'
            },
            maestro: {
                name: 'Maestro',
                cost: 2,
                effects: 'Misma cantidad de ataques en ambas manos'
            }
        }
    },
    'arqueria': {
        name: 'Arquería',
        description: 'Especialización en arcos',
        availableFor: ['luchador', 'bribon'],
        levels: {
            especialista: {
                name: 'Especialista',
                cost: 1,
                effects: '+2 daño con arcos, +50% alcance'
            },
            maestro: {
                name: 'Maestro',
                cost: 2,
                effects: '+4 daño total, +100% alcance'
            }
        }
    },
    'ballestas': {
        name: 'Ballestas',
        description: 'Especialización en ballestas',
        availableFor: ['luchador', 'bribon'],
        levels: {
            especialista: {
                name: 'Especialista',
                cost: 1,
                effects: 'Recarga más rápida, +0.5 ataques/ronda'
            },
            maestro: {
                name: 'Maestro',
                cost: 2,
                effects: 'Recarga de rayo, +0.5 ataques/ronda adicional'
            }
        }
    }
};

// Armas básicas para el sistema
const BASIC_WEAPONS = [
    // Armas cuerpo a cuerpo
    { name: 'Puños', type: 'melee', size: 'S', damage: '1d2', speed: 2, category: 'Desarmado' },
    { name: 'Daga', type: 'melee', size: 'S', damage: '1d4', speed: 2, category: 'Cuchilla Pequeña' },
    { name: 'Espada Corta', type: 'melee', size: 'S', damage: '1d6', speed: 3, category: 'Cuchilla Pequeña' },
    { name: 'Espada Larga', type: 'melee', size: 'M', damage: '1d8', speed: 5, category: 'Cuchilla Larga' },
    { name: 'Espada de dos Manos', type: 'melee', size: 'L', damage: '1d10', speed: 10, category: 'Cuchilla Larga' },
    { name: 'Hacha de Mano', type: 'melee', size: 'M', damage: '1d6', speed: 4, category: 'Hacha' },
    { name: 'Hacha de Guerra', type: 'melee', size: 'M', damage: '1d8', speed: 7, category: 'Hacha' },
    { name: 'Maza', type: 'melee', size: 'M', damage: '1d6+1', speed: 7, category: 'Contundente' },
    { name: 'Martillo de Guerra', type: 'melee', size: 'M', damage: '1d4+1', speed: 4, category: 'Contundente' },
    { name: 'Lanza', type: 'melee', size: 'M', damage: '1d6', speed: 6, category: 'Lanza' },
    { name: 'Alabarda', type: 'melee', size: 'L', damage: '1d10', speed: 9, category: 'Asta' },
    { name: 'Bastón', type: 'melee', size: 'L', damage: '1d6', speed: 4, category: 'Bastón' },
    
    // Armas a distancia
    { name: 'Arco Corto', type: 'ranged', size: 'M', damage: '1d6', speed: 7, range: '50/100/150', category: 'Arco' },
    { name: 'Arco Largo', type: 'ranged', size: 'L', damage: '1d6', speed: 8, range: '70/140/210', category: 'Arco' },
    { name: 'Ballesta Ligera', type: 'ranged', size: 'M', damage: '1d4', speed: 7, range: '60/120/180', category: 'Ballesta' },
    { name: 'Ballesta Pesada', type: 'ranged', size: 'L', damage: '1d4+1', speed: 10, range: '80/160/240', category: 'Ballesta' },
    { name: 'Honda', type: 'ranged', size: 'S', damage: '1d4+1', speed: 6, range: '40/80/160', category: 'Honda' },
    { name: 'Jabalina', type: 'thrown', size: 'M', damage: '1d6', speed: 4, range: '20/40/60', category: 'Lanza' },
    { name: 'Daga Arrojadiza', type: 'thrown', size: 'S', damage: '1d4', speed: 2, range: '10/20/30', category: 'Cuchilla Pequeña' }
];

// Armaduras básicas
const BASIC_ARMOR = [
    { name: 'Sin Armadura', ac: 10, type: 'none', weight: 0, dexBonus: 'unlimited' },
    { name: 'Cuero', ac: 8, type: 'light', weight: 15, dexBonus: 'unlimited' },
    { name: 'Cuero Tachonado', ac: 7, type: 'light', weight: 20, dexBonus: 'unlimited' },
    { name: 'Cota de Anillas', ac: 7, type: 'medium', weight: 30, dexBonus: 2 },
    { name: 'Cota de Escamas', ac: 6, type: 'medium', weight: 40, dexBonus: 1 },
    { name: 'Cota de Mallas', ac: 5, type: 'medium', weight: 40, dexBonus: 1 },
    { name: 'Armadura de Bandas', ac: 4, type: 'heavy', weight: 35, dexBonus: 1 },
    { name: 'Armadura de Placas', ac: 3, type: 'heavy', weight: 45, dexBonus: 0 },
    { name: 'Armadura de Placas Completa', ac: 1, type: 'heavy', weight: 70, dexBonus: 0 }
];

// ==========================================
// FUNCIONES DE UTILIDAD
// ==========================================

// Obtener grupo de clase actual
function getCurrentClassGroup() {
    const primaryClass = document.getElementById('primary-selected-name')?.textContent || '';
    
    for (const [group, classes] of Object.entries(CLASS_GROUPS)) {
        if (classes.includes(primaryClass)) {
            return group;
        }
    }
    return 'luchador'; // Default
}

// Obtener nivel del personaje
function getCurrentLevel() {
    return parseInt(document.getElementById('characterLevel')?.value) || 1;
}

// Obtener valor de habilidad
function getAbilityScore(ability) {
    const element = document.getElementById(ability.toLowerCase());
    return parseInt(element?.value) || 10;
}

// Calcular modificador de habilidad
function getAbilityModifier(score, type = 'standard') {
    if (!window.AbilityCalculator || !window.AbilityCalculator.abilityData) {
        // Fallback calculation
        return Math.floor((score - 10) / 2);
    }

    const data = window.AbilityCalculator.abilityData;
    let abilityTable;
    
    switch (type) {
        case 'strength-hit':
            abilityTable = data.fuerza;
            return findAbilityValue(abilityTable, score, 'Probab. de Golpe') || 0;
        case 'strength-damage':
            abilityTable = data.fuerza;
            return findAbilityValue(abilityTable, score, 'Ajuste de daño') || 0;
        case 'dexterity-defensive':
            abilityTable = data.destreza;
            return findAbilityValue(abilityTable, score, 'Ajuste defensivo') || 0;
        case 'dexterity-missile':
            abilityTable = data.destreza;
            return findAbilityValue(abilityTable, score, 'Ajuste Atq Proyectiles') || 0;
        default:
            return Math.floor((score - 10) / 2);
    }
}

// Buscar valor en tabla de habilidades
function findAbilityValue(table, score, column) {
    const entry = table.find(row => {
        const abilityScore = row['Punt. Habilidad'] || row['Puntuación habilidad'];
        return parseInt(abilityScore) === score;
    });
    
    if (entry) {
        const value = entry[column];
        return parseInt(value) || 0;
    }
    return 0;
}

// ==========================================
// CÁLCULOS DE COMBATE
// ==========================================

// Calcular GACO base por clase y nivel
function calculateBaseGaco() {
    const classGroup = getCurrentClassGroup();
    const level = getCurrentLevel();
    let baseGaco = 20;

    switch (classGroup) {
        case 'luchador':
            baseGaco = 21 - level; // Mejora cada nivel
            break;
        case 'sacerdote':
        case 'bribon':
            baseGaco = 20 - Math.floor((level - 1) / 2); // Mejora cada 2 niveles
            break;
        case 'hechicero':
            baseGaco = 20 - Math.floor((level - 1) / 3); // Mejora cada 3 niveles
            break;
    }

    return Math.max(1, baseGaco); // Mínimo GACO 1
}

// Calcular Clase de Armadura
function calculateArmorClass() {
    let ac = 10; // CA base sin armadura
    
    // CA de armadura equipada (implementar cuando esté el sistema de equipo)
    const equippedArmor = getEquippedArmor();
    if (equippedArmor) {
        ac = equippedArmor.ac;
    }
    
    // Modificador defensivo de destreza
    const dexScore = getAbilityScore('dexterity');
    const dexDefensive = getAbilityModifier(dexScore, 'dexterity-defensive');
    ac -= dexDefensive; // En AD&D menor CA es mejor
    
    // Escudo equipado
    const hasShield = getEquippedShield();
    if (hasShield) {
        ac -= 1; // Escudo base
        
        // Especialización en "Arma y escudo"
        if (hasCombatStyleActive('arma-y-escudo')) {
            ac -= 2; // +2 CA adicional del escudo
        }
    }
    
    // Bonificaciones por otros estilos
    if (hasCombatStyleActive('arma-unica')) {
        const styleLevel = getCombatStyleLevel('arma-unica');
        ac -= styleLevel === 'maestro' ? 2 : 1;
    }
    
    if (hasCombatStyleActive('sin-armas')) {
        ac -= 4; // +4 CA por combate desarmado
    }
    
    return Math.max(ac, -10); // Límite práctico de CA
}

// Calcular Iniciativa
function calculateInitiative() {
    const dexScore = getAbilityScore('dexterity');
    const dexReaction = getAbilityModifier(dexScore, 'dexterity-missile'); // Usar missile para reacción
    return dexReaction;
}

// ==========================================
// SISTEMA DE PERICIAS EN ARMAS
// ==========================================

// Calcular casillas de armas disponibles
function calculateWeaponProficiencySlots() {
    const classGroup = getCurrentClassGroup();
    const level = getCurrentLevel();
    let slots = 0;
    
    switch (classGroup) {
        case 'luchador':
            slots = 4 + Math.floor((level - 1) / 3); // 4 iniciales + 1 cada 3 niveles
            break;
        case 'sacerdote':
        case 'bribon':
            slots = 2 + Math.floor((level - 1) / 4); // 2 iniciales + 1 cada 4 niveles
            break;
        case 'hechicero':
            slots = 1 + Math.floor((level - 1) / 6); // 1 inicial + 1 cada 6 niveles
            break;
    }
    
    return slots;
}

// Obtener penalizador sin pericia
function getWeaponPenaltyWithoutProficiency() {
    const classGroup = getCurrentClassGroup();
    
    switch (classGroup) {
        case 'luchador': return -2;
        case 'sacerdote':
        case 'bribon': return -3;
        case 'hechicero': return -5;
        default: return -2;
    }
}

// Renderizar pericias en armas
function renderWeaponProficiencies() {
    const container = document.getElementById('weapons-proficiency-grid');
    const slotsCounter = document.getElementById('weapon-slots-counter');
    
    if (!container || !slotsCounter) return;
    
    const totalSlots = calculateWeaponProficiencySlots();
    const usedSlots = calculateUsedWeaponSlots();
    const availableSlots = totalSlots - usedSlots;
    
    slotsCounter.textContent = `${availableSlots}/${totalSlots} casillas`;
    
    // Limpiar contenedor
    container.innerHTML = '';
    
    // Renderizar armas
    BASIC_WEAPONS.forEach(weapon => {
        const weaponElement = createWeaponProficiencyElement(weapon, availableSlots);
        container.appendChild(weaponElement);
    });
}

// Crear elemento de pericia en arma
function createWeaponProficiencyElement(weapon, availableSlots) {
    const div = document.createElement('div');
    div.className = 'weapon-item';
    
    const currentLevel = characterSkills.weaponProficiencies[weapon.name] || 0;
    const canIncrease = availableSlots > 0 && currentLevel < 4;
    const canDecrease = currentLevel > 0;
    
    div.innerHTML = `
        <div class="item-header">
            <span class="item-name">${weapon.name}</span>
            <span class="item-group">${weapon.category}</span>
        </div>
        <div class="item-details">
            <span class="item-characteristic">Daño: ${weapon.damage}</span>
            <span class="item-modifier">Vel: ${weapon.speed}</span>
        </div>
        <div class="proficiency-controls">
            <div class="proficiency-level">
                <button class="level-btn ${canDecrease ? '' : 'disabled'}" 
                        onclick="adjustWeaponProficiency('${weapon.name}', -1)" 
                        ${!canDecrease ? 'disabled' : ''}>-</button>
                <span class="slots-required">${currentLevel}</span>
                <button class="level-btn ${canIncrease ? '' : 'disabled'}" 
                        onclick="adjustWeaponProficiency('${weapon.name}', 1)" 
                        ${!canIncrease ? 'disabled' : ''}>+</button>
            </div>
            <span class="mastery-level">${getMasteryLevelName(currentLevel)}</span>
        </div>
        <div class="mastery-info ${currentLevel > 0 ? 'show' : ''}">
            ${getMasteryEffects(currentLevel)}
        </div>
    `;
    
    return div;
}

// Obtener nombre del nivel de maestría
function getMasteryLevelName(level) {
    switch (level) {
        case 0: return 'Sin Pericia';
        case 1: return 'Pericia Básica';
        case 2: return 'Especialización';
        case 3: return 'Maestro';
        case 4: return 'Gran Maestro';
        default: return 'Sin Pericia';
    }
}

// Obtener efectos de la maestría
function getMasteryEffects(level) {
    switch (level) {
        case 0: return `Penalizador: ${getWeaponPenaltyWithoutProficiency()}`;
        case 1: return 'Sin penalizador';
        case 2: return '+1 ataque, +2 daño, +0.5 ataques/ronda';
        case 3: return '+2 ataque, +4 daño, +0.5 ataques/ronda';
        case 4: return '+3 ataque, +6 daño, +0.5 ataques/ronda';
        default: return '';
    }
}

// Ajustar nivel de pericia en arma
function adjustWeaponProficiency(weaponName, change) {
    const currentLevel = characterSkills.weaponProficiencies[weaponName] || 0;
    const newLevel = Math.max(0, Math.min(4, currentLevel + change));
    
    if (newLevel !== currentLevel) {
        characterSkills.weaponProficiencies[weaponName] = newLevel;
        if (newLevel === 0) {
            delete characterSkills.weaponProficiencies[weaponName];
        }
        renderWeaponProficiencies();
        updateCombatStats();
    }
}

// Calcular casillas de armas usadas
function calculateUsedWeaponSlots() {
    return Object.values(characterSkills.weaponProficiencies).reduce((total, level) => total + level, 0);
}

// ==========================================
// SISTEMA DE PERICIAS EN NO-ARMAS
// ==========================================

// Cargar pericias desde JSON
async function loadSkillsData() {
    try {
        const response = await fetch('https://raw.githubusercontent.com/slurn84-beep/AD-D2.PANDUNK/refs/heads/main/Tabla%20Pericias.html');
        const data = await response.json();
        skillsData = data;
        renderNonWeaponProficiencies();
    } catch (error) {
        console.error('Error loading skills data:', error);
        // Usar datos de fallback si falla la carga
        skillsData = getFallbackSkillsData();
        renderNonWeaponProficiencies();
    }
}

// Datos de fallback para pericias
function getFallbackSkillsData() {
    return [
        { "Pericia": "Natación", "Grupo": "Gen", "Ranuras": "1", "Caracteristica": "Fue", "Modificador": "0" },
        { "Pericia": "Trepar", "Grupo": "Gen", "Ranuras": "1", "Caracteristica": "Fue", "Modificador": "0" },
        { "Pericia": "Rastreo", "Grupo": "Bri", "Ranuras": "2", "Caracteristica": "Sab", "Modificador": "0" },
        { "Pericia": "Supervivencia", "Grupo": "Bri", "Ranuras": "2", "Caracteristica": "Int", "Modificador": "0" },
        { "Pericia": "Primeros Auxilios", "Grupo": "Gen", "Ranuras": "1", "Caracteristica": "Sab", "Modificador": "0" }
    ];
}

// Calcular casillas de no-armas disponibles
function calculateNonWeaponProficiencySlots() {
    const classGroup = getCurrentClassGroup();
    const level = getCurrentLevel();
    const wisdom = getAbilityScore('wisdom');
    
    let baseSlots = 0;
    
    switch (classGroup) {
        case 'luchador':
            baseSlots = 3 + Math.floor((level - 1) / 3); // 3 iniciales + 1 cada 3 niveles
            break;
        case 'sacerdote':
        case 'hechicero':
            baseSlots = 4 + Math.floor((level - 1) / 3); // 4 iniciales + 1 cada 3 niveles
            break;
        case 'bribon':
            baseSlots = 3 + Math.floor((level - 1) / 4); // 3 iniciales + 1 cada 4 niveles
            break;
    }
    
    // Bonificación por Sabiduría
    const wisdomBonus = Math.max(0, Math.floor((wisdom - 8) / 2));
    
    return baseSlots + wisdomBonus;
}

// Renderizar pericias en no-armas
function renderNonWeaponProficiencies() {
    const container = document.getElementById('nonweapon-skills-grid');
    const slotsCounter = document.getElementById('nonweapon-slots-counter');
    
    if (!container || !slotsCounter || !skillsData) return;
    
    const totalSlots = calculateNonWeaponProficiencySlots();
    const usedSlots = calculateUsedNonWeaponSlots();
    const availableSlots = totalSlots - usedSlots;
    
    slotsCounter.textContent = `${availableSlots}/${totalSlots} casillas`;
    
    // Obtener filtros
    const searchTerm = document.getElementById('skill-search')?.value.toLowerCase() || '';
    const groupFilter = document.getElementById('skill-group-filter')?.value || 'all';
    
    // Limpiar contenedor
    container.innerHTML = '';
    
    // Filtrar y renderizar pericias
    const filteredSkills = skillsData.filter(skill => {
        const matchesSearch = skill.Pericia.toLowerCase().includes(searchTerm);
        const matchesGroup = groupFilter === 'all' || skill.Grupo === groupFilter;
        return matchesSearch && matchesGroup;
    });
    
    filteredSkills.forEach(skill => {
        const skillElement = createNonWeaponProficiencyElement(skill, availableSlots);
        container.appendChild(skillElement);
    });
}

// Crear elemento de pericia en no-armas
function createNonWeaponProficiencyElement(skill, availableSlots) {
    const div = document.createElement('div');
    div.className = 'skill-item';
    
    const currentRanks = characterSkills.nonWeaponProficiencies[skill.Pericia] || 0;
    const maxRanks = parseInt(skill.Ranuras);
    const canIncrease = availableSlots > 0 && currentRanks < maxRanks;
    const canDecrease = currentRanks > 0;
    
    // Calcular modificador total
    const baseModifier = parseInt(skill.Modificador) || 0;
    const groupPenalty = getGroupPenalty(skill.Grupo);
    const armorPenalty = getArmorPenalty(skill.Caracteristica);
    const totalModifier = baseModifier + groupPenalty + armorPenalty;
    
    const modifierText = totalModifier >= 0 ? `+${totalModifier}` : `${totalModifier}`;
    
    div.innerHTML = `
        <div class="item-header">
            <span class="item-name">${skill.Pericia}</span>
            <span class="item-group">${skill.Grupo}</span>
        </div>
        <div class="item-details">
            <span class="item-characteristic">${skill.Caracteristica}</span>
            <span class="item-modifier">${modifierText}</span>
        </div>
        <div class="proficiency-controls">
            <div class="proficiency-level">
                <button class="level-btn ${canDecrease ? '' : 'disabled'}" 
                        onclick="adjustNonWeaponProficiency('${skill.Pericia}', -1)" 
                        ${!canDecrease ? 'disabled' : ''}>-</button>
                <span class="slots-required">${currentRanks}/${maxRanks}</span>
                <button class="level-btn ${canIncrease ? '' : 'disabled'}" 
                        onclick="adjustNonWeaponProficiency('${skill.Pericia}', 1)" 
                        ${!canIncrease ? 'disabled' : ''}>+</button>
            </div>
        </div>
        ${currentRanks > 0 ? `
            <div class="mastery-info show">
                Pericia adquirida: ${currentRanks} de ${maxRanks} rangos
            </div>
        ` : ''}
    `;
    
    return div;
}

// Obtener penalizador por grupo
function getGroupPenalty(skillGroup) {
    const classGroup = getCurrentClassGroup();
    
    // Sin penalizador para grupos correspondientes o General
    if (skillGroup === 'Gen') return 0;
    
    const groupMap = {
        'Luc': 'luchador',
        'Sac': 'sacerdote', 
        'Hec': 'hechicero',
        'Mago': 'hechicero',
        'Bri': 'bribon',
        'Psi': 'bribon'
    };
    
    if (groupMap[skillGroup] === classGroup) {
        return 0; // Sin penalizador para su grupo
    }
    
    return 3; // +3 penalizador para otros grupos
}

// Obtener penalizador por armadura (solo para Destreza)
function getArmorPenalty(characteristic) {
    if (characteristic !== 'Des') return 0;
    
    const equippedArmor = getEquippedArmor();
    if (!equippedArmor) return 0;
    
    // Penalizadores por tipo de armadura en pericias de Destreza
    switch (equippedArmor.type) {
        case 'none':
        case 'light': return 0;
        case 'medium': return 2;
        case 'heavy': return 4;
        default: return 0;
    }
}

// Ajustar nivel de pericia en no-armas
function adjustNonWeaponProficiency(skillName, change) {
    const currentRanks = characterSkills.nonWeaponProficiencies[skillName] || 0;
    const skill = skillsData.find(s => s.Pericia === skillName);
    const maxRanks = skill ? parseInt(skill.Ranuras) : 1;
    const newRanks = Math.max(0, Math.min(maxRanks, currentRanks + change));
    
    if (newRanks !== currentRanks) {
        if (newRanks === 0) {
            delete characterSkills.nonWeaponProficiencies[skillName];
        } else {
            characterSkills.nonWeaponProficiencies[skillName] = newRanks;
        }
        renderNonWeaponProficiencies();
    }
}

// Calcular casillas de no-armas usadas
function calculateUsedNonWeaponSlots() {
    return Object.values(characterSkills.nonWeaponProficiencies).reduce((total, ranks) => total + ranks, 0);
}

// ==========================================
// SISTEMA DE ESTILOS DE COMBATE
// ==========================================

// Renderizar estilos de combate
function renderCombatStyles() {
    const container = document.getElementById('combat-styles-container');
    const slotsCounter = document.getElementById('combat-styles-counter');
    
    if (!container || !slotsCounter) return;
    
    const classGroup = getCurrentClassGroup();
    
    // Solo luchadores pueden usar estilos de combate
    if (classGroup !== 'luchador') {
        container.innerHTML = `
            <div class="no-styles-message">
                Los estilos de combate solo están disponibles para Luchadores
            </div>
        `;
        slotsCounter.textContent = '0/0 casillas';
        return;
    }
    
    const totalSlots = calculateWeaponProficiencySlots(); // Usan las mismas casillas que armas
    const usedWeaponSlots = calculateUsedWeaponSlots();
    const usedStyleSlots = calculateUsedStyleSlots();
    const availableSlots = totalSlots - usedWeaponSlots - usedStyleSlots;
    
    slotsCounter.textContent = `${availableSlots}/${totalSlots} casillas`;
    
    container.innerHTML = '';
    
    // Renderizar estilos disponibles
    Object.entries(COMBAT_STYLES).forEach(([styleId, style]) => {
        if (isStyleAvailableForClass(style, classGroup)) {
            const styleElement = createCombatStyleElement(styleId, style, availableSlots);
            container.appendChild(styleElement);
        }
    });
}

// Crear elemento de estilo de combate
function createCombatStyleElement(styleId, style, availableSlots) {
    const div = document.createElement('div');
    div.className = 'combat-style-card';
    
    const currentLevel = characterSkills.combatStyles[styleId] || null;
    
    div.innerHTML = `
        <div class="style-header">
            <span class="style-name">${style.name}</span>
            <span class="style-cost">1+2 casillas</span>
        </div>
        <div class="style-description">${style.description}</div>
        <div class="style-levels">
            ${Object.entries(style.levels).map(([levelId, level]) => {
                const isPurchased = currentLevel === levelId || (currentLevel === 'maestro' && levelId === 'especialista');
                const canPurchase = !isPurchased && availableSlots >= level.cost && 
                    (levelId === 'especialista' || currentLevel === 'especialista');
                
                return `
                    <div class="style-level ${isPurchased ? 'purchased' : ''}">
                        <span class="style-level-name">${level.name}</span>
                        <span class="style-level-effect">${level.effects}</span>
                        <button class="style-level-btn ${isPurchased ? 'purchased' : (canPurchase ? '' : 'disabled')}"
                                onclick="purchaseCombatStyle('${styleId}', '${levelId}')"
                                ${!canPurchase && !isPurchased ? 'disabled' : ''}>
                            ${isPurchased ? 'Comprado' : `${level.cost} casillas`}
                        </button>
                    </div>
                `;
            }).join('')}
        </div>
    `;
    
    return div;
}

// Verificar si el estilo está disponible para la clase
function isStyleAvailableForClass(style, classGroup) {
    return style.availableFor.includes('todos') || style.availableFor.includes(classGroup);
}

// Comprar estilo de combate
function purchaseCombatStyle(styleId, levelId) {
    const style = COMBAT_STYLES[styleId];
    const level = style.levels[levelId];
    const currentLevel = characterSkills.combatStyles[styleId];
    
    // Verificar si ya está comprado
    if (currentLevel === levelId || (currentLevel === 'maestro' && levelId === 'especialista')) {
        return;
    }
    
    // Verificar casillas disponibles
    const totalSlots = calculateWeaponProficiencySlots();
    const usedSlots = calculateUsedWeaponSlots() + calculateUsedStyleSlots();
    const availableSlots = totalSlots - usedSlots;
    
    if (availableSlots < level.cost) {
        alert('No tienes suficientes casillas de pericia disponibles');
        return;
    }
    
    // Verificar prerrequisitos
    if (levelId === 'maestro' && currentLevel !== 'especialista') {
        alert('Debes tener el nivel Especialista antes de comprar Maestro');
        return;
    }
    
    // Comprar el estilo
    characterSkills.combatStyles[styleId] = levelId;
    renderCombatStyles();
    renderCombatStylesInCombatTab();
    updateCombatStats();
}

// Calcular casillas de estilos usadas
function calculateUsedStyleSlots() {
    return Object.entries(characterSkills.combatStyles).reduce((total, [styleId, level]) => {
        const style = COMBAT_STYLES[styleId];
        if (!style) return total;
        
        if (level === 'especialista') {
            return total + style.levels.especialista.cost;
        } else if (level === 'maestro') {
            return total + style.levels.especialista.cost + style.levels.maestro.cost;
        }
        return total;
    }, 0);
}

// ==========================================
// SISTEMA DE COMBATE - TAB COMBAT
// ==========================================

// Renderizar estilos en el tab de combate
function renderCombatStylesInCombatTab() {
    const container = document.getElementById('active-combat-styles');
    if (!container) return;
    
    const purchasedStyles = Object.entries(characterSkills.combatStyles);
    
    if (purchasedStyles.length === 0) {
        container.innerHTML = `
            <div class="no-styles-active">
                <p style="color: #b0b0b0; font-style: italic; text-align: center;">
                    No tienes estilos de combate disponibles.<br>
                    <small>Compra estilos en la pestaña de Pericias para habilitarlos aquí.</small>
                </p>
            </div>
        `;
        return;
    }
    
    container.innerHTML = '';
    
    purchasedStyles.forEach(([styleId, level]) => {
        const style = COMBAT_STYLES[styleId];
        if (style) {
            const styleElement = createActiveCombatStyleElement(styleId, style, level);
            container.appendChild(styleElement);
        }
    });
}

// Crear elemento de estilo activo en combate
function createActiveCombatStyleElement(styleId, style, level) {
    const div = document.createElement('div');
    div.className = 'combat-style-active';
    
    const isActive = characterSkills.activeCombatStyles?.[styleId] || false;
    const effectsText = level === 'maestro' 
        ? `${style.levels.especialista.effects} + ${style.levels.maestro.effects}`
        : style.levels[level].effects;
    
    div.innerHTML = `
        <div class="style-info-active">
            <div class="style-name-active">${style.name}</div>
            <div class="style-level-active">${getMasteryLevelName(level === 'maestro' ? 2 : 1)}</div>
            <div class="style-effects-active">${effectsText}</div>
        </div>
        <button class="style-toggle-btn ${isActive ? 'active' : ''}"
                onclick="toggleCombatStyle('${styleId}')">
            ${isActive ? 'Activo' : 'Activar'}
        </button>
    `;
    
    return div;
}

// Alternar estilo de combate activo
function toggleCombatStyle(styleId) {
    if (!characterSkills.activeCombatStyles) {
        characterSkills.activeCombatStyles = {};
    }
    
    characterSkills.activeCombatStyles[styleId] = !characterSkills.activeCombatStyles[styleId];
    renderCombatStylesInCombatTab();
    updateCombatStats();
}

// ==========================================
// FUNCIONES DE EQUIPO (PLACEHOLDER)
// ==========================================

// Obtener armadura equipada (placeholder)
function getEquippedArmor() {
    // Por ahora retorna armadura base, implementar cuando esté el sistema de equipo
    return BASIC_ARMOR[0]; // Sin armadura
}

// Obtener escudo equipado (placeholder)
function getEquippedShield() {
    // Por ahora retorna false, implementar cuando esté el sistema de equipo
    return false;
}

// Verificar si tiene estilo activo
function hasCombatStyleActive(styleId) {
    return characterSkills.activeCombatStyles?.[styleId] || false;
}

// Obtener nivel de estilo
function getCombatStyleLevel(styleId) {
    return characterSkills.combatStyles[styleId] || null;
}

// ==========================================
// ACTUALIZACIÓN DE STATS DE COMBATE
// ==========================================

// Actualizar todos los stats de combate
function updateCombatStats() {
    updateBaseGaco();
    updateArmorClass();
    updateInitiative();
    updateSavingThrows();
    updateAttacksPerRound();
    updateArmorBreakdown();
}

// Actualizar GACO base
function updateBaseGaco() {
    const baseGaco = calculateBaseGaco();
    
    // Actualizar en ambos lugares
    const combatGacoElement = document.getElementById('combatGaco');
    const gacoElement = document.getElementById('gaco');
    
    if (combatGacoElement) combatGacoElement.textContent = baseGaco;
    if (gacoElement) gacoElement.textContent = baseGaco;
}

// Actualizar CA
function updateArmorClass() {
    const ac = calculateArmorClass();
    
    // Actualizar en ambos lugares
    const combatACElement = document.getElementById('combatAC');
    const armorClassElement = document.getElementById('armorClass');
    
    if (combatACElement) combatACElement.textContent = ac;
    if (armorClassElement) armorClassElement.textContent = ac;
}

// Actualizar iniciativa
function updateInitiative() {
    const initiative = calculateInitiative();
    const initiativeText = initiative >= 0 ? `+${initiative}` : `${initiative}`;
    
    const combatInitiativeElement = document.getElementById('combatInitiative');
    const initiativeElement = document.getElementById('initiative');
    
    if (combatInitiativeElement) combatInitiativeElement.textContent = initiativeText;
    if (initiativeElement) initiativeElement.textContent = initiativeText;
}

// Actualizar tiradas de salvación (placeholder)
function updateSavingThrows() {
    const classGroup = getCurrentClassGroup();
    const level = getCurrentLevel();
    
    // Valores base por clase y nivel (simplificado)
    const saves = calculateBaseSavingThrows(classGroup, level);
    
    const saveElements = {
        'save-paralysis': saves.paralysis,
        'save-rods': saves.rods,
        'save-petrification': saves.petrification,
        'save-breath': saves.breath,
        'save-spells': saves.spells
    };
    
    Object.entries(saveElements).forEach(([elementId, value]) => {
        const element = document.getElementById(elementId);
        if (element) element.textContent = value;
    });
}

// Calcular salvaciones base (simplificado)
function calculateBaseSavingThrows(classGroup, level) {
    // Valores simplificados - implementar tabla completa después
    const baseSaves = {
        luchador: { paralysis: 14, rods: 16, petrification: 15, breath: 17, spells: 17 },
        sacerdote: { paralysis: 10, rods: 14, petrification: 13, breath: 16, spells: 15 },
        hechicero: { paralysis: 14, rods: 11, petrification: 13, breath: 15, spells: 12 },
        bribon: { paralysis: 13, rods: 14, petrification: 12, breath: 16, spells: 15 }
    };
    
    const base = baseSaves[classGroup] || baseSaves.luchador;
    const levelMod = Math.floor((level - 1) / 3); // Mejora cada 3 niveles
    
    return {
        paralysis: Math.max(2, base.paralysis - levelMod),
        rods: Math.max(2, base.rods - levelMod),
        petrification: Math.max(2, base.petrification - levelMod),
        breath: Math.max(2, base.breath - levelMod),
        spells: Math.max(2, base.spells - levelMod)
    };
}

// Actualizar ataques por ronda
function updateAttacksPerRound() {
    const classGroup = getCurrentClassGroup();
    const level = getCurrentLevel();
    
    let baseAttacks = 1;
    let specializationAttacks = 0;
    let styleAttacks = 0;
    
    // Ataques base por nivel (solo luchadores)
    if (classGroup === 'luchador' && level >= 7) {
        baseAttacks = level >= 13 ? 2 : 1.5; // 3/2 a nivel 7, 2/1 a nivel 13
    }
    
    // Ataques por especialización en armas
    Object.entries(characterSkills.weaponProficiencies).forEach(([weapon, level]) => {
        if (level >= 2) { // Especialización o superior
            specializationAttacks += 0.5 * (level - 1);
        }
    });
    
    // Ataques por estilos de combate
    if (hasCombatStyleActive('sin-armas')) {
        const level = getCombatStyleLevel('sin-armas');
        styleAttacks += level === 'maestro' ? 1 : 0.5;
    }
    
    if (hasCombatStyleActive('ballestas')) {
        const level = getCombatStyleLevel('ballestas');
        styleAttacks += level === 'maestro' ? 1 : 0.5;
    }
    
    const totalAttacks = baseAttacks + specializationAttacks + styleAttacks;
    
    // Actualizar elementos
    const elements = {
        'base-attacks-value': baseAttacks,
        'specialization-attacks-value': specializationAttacks > 0 ? `+${specializationAttacks}` : '+0',
        'style-attacks-value': styleAttacks > 0 ? `+${styleAttacks}` : '+0',
        'total-attacks-value': totalAttacks
    };
    
    Object.entries(elements).forEach(([elementId, value]) => {
        const element = document.getElementById(elementId);
        if (element) element.textContent = value;
    });
}

// Actualizar desglose de CA
function updateArmorBreakdown() {
    const equippedArmor = getEquippedArmor();
    const dexScore = getAbilityScore('dexterity');
    const dexMod = getAbilityModifier(dexScore, 'dexterity-defensive');
    const hasShield = getEquippedShield();
    
    let acBase = equippedArmor ? equippedArmor.ac : 10;
    let acDex = dexMod;
    let acShield = 0;
    let acStyle = 0;
    let acMagic = 0;
    
    if (hasShield) {
        acShield = 1;
        if (hasCombatStyleActive('arma-y-escudo')) {
            acStyle += 2;
        }
    }
    
    if (hasCombatStyleActive('arma-unica')) {
        const level = getCombatStyleLevel('arma-unica');
        acStyle += level === 'maestro' ? 2 : 1;
    }
    
    if (hasCombatStyleActive('sin-armas')) {
        acStyle += 4;
    }
    
    const totalAC = acBase - acDex - acShield - acStyle - acMagic;
    
    // Actualizar elementos
    const elements = {
        'ac-base-armor': acBase,
        'ac-dex-mod': acDex > 0 ? `+${acDex}` : `${acDex}`,
        'ac-shield': acShield > 0 ? `+${acShield}` : '+0',
        'ac-style-bonus': acStyle > 0 ? `+${acStyle}` : '+0',
        'ac-magic-bonus': acMagic > 0 ? `+${acMagic}` : '+0',
        'ac-total': totalAC
    };
    
    Object.entries(elements).forEach(([elementId, value]) => {
        const element = document.getElementById(elementId);
        if (element) element.textContent = value;
    });
}

// ==========================================
// EVENTOS Y FILTROS
// ==========================================

// Event listeners para búsqueda y filtros
function setupSkillsEventListeners() {
    // Búsqueda de armas
    const weaponSearch = document.getElementById('weapon-search');
    if (weaponSearch) {
        weaponSearch.addEventListener('input', renderWeaponProficiencies);
    }
    
    // Búsqueda de pericias
    const skillSearch = document.getElementById('skill-search');
    if (skillSearch) {
        skillSearch.addEventListener('input', renderNonWeaponProficiencies);
    }
    
    // Filtro de grupos
    const groupFilter = document.getElementById('skill-group-filter');
    if (groupFilter) {
        groupFilter.addEventListener('change', renderNonWeaponProficiencies);
    }
}

// ==========================================
// INICIALIZACIÓN
// ==========================================

// Inicializar sistema de pericias
function initializeSkillsSystem() {
    loadSkillsData();
    renderWeaponProficiencies();
    renderCombatStyles();
    renderCombatStylesInCombatTab();
    updateCombatStats();
    setupSkillsEventListeners();
}

// Ejecutar cuando el DOM esté listo
document.addEventListener('DOMContentLoaded', function() {
    // Esperar un poco para asegurar que otros sistemas estén cargados
    setTimeout(initializeSkillsSystem, 100);
});

// También ejecutar cuando se cambie de clase o nivel
function onCharacterChanged() {
    renderWeaponProficiencies();
    renderNonWeaponProficiencies();
    renderCombatStyles();
    renderCombatStylesInCombatTab();
    updateCombatStats();
}

// Hook para integrar con el sistema existente
if (window.AbilityCalculator) {
    const originalCalculateModifiers = window.AbilityCalculator.calculateModifiers;
    window.AbilityCalculator.calculateModifiers = function() {
        if (originalCalculateModifiers) {
            originalCalculateModifiers.call(this);
        }
        updateCombatStats();
    };
}
              
        function updateClassSelection() {
            character.specificClass = document.getElementById('specificClass').value;
            updateCharacterDisplay();
        }

        function updateLevel() {
            const level = parseInt(document.getElementById('level').value) || 1;
            character.level = level;
            document.getElementById('characterLevelDisplay').textContent = level;
        }

        function updateFromXP() {
            const xp = parseInt(document.getElementById('experience').value) || 0;
            character.experience = xp;
            
            // Basic XP to level conversion (can be refined)
            let level = 1;
            if (xp >= 2000) level = 2;
            if (xp >= 4000) level = 3;
            if (xp >= 8000) level = 4;
            if (xp >= 16000) level = 5;
            if (xp >= 32000) level = 6;
            if (xp >= 64000) level = 7;
            if (xp >= 125000) level = 8;
            if (xp >= 250000) level = 9;
            if (xp >= 500000) level = 10;
            
            document.getElementById('level').value = level;
            updateLevel();
        }

        // Ability score functions
        function calculateModifiers() {
            const abilities = ['strength', 'dexterity', 'constitution', 'intelligence', 'wisdom', 'charisma'];
            
            abilities.forEach(ability => {
                const score = parseInt(document.getElementById(ability).value) || 10;
                character.abilities[ability] = score;
                
                let modifier = 0;
                if (score <= 3) modifier = -3;
                else if (score <= 5) modifier = -2;
                else if (score <= 8) modifier = -1;
                else if (score <= 12) modifier = 0;
                else if (score <= 15) modifier = 1;
                else if (score <= 17) modifier = 2;
                else modifier = 3;
                
                const modElement = document.getElementById(ability.substring(0, 3) + 'Mod');
                modElement.textContent = modifier >= 0 ? '+' + modifier : modifier.toString();
                
                // Update modifier classes
                modElement.className = 'ability-modifier ';
                if (modifier > 0) modElement.className += 'modifier-positive';
                else if (modifier < 0) modElement.className += 'modifier-negative';
                else modElement.className += 'modifier-zero';
            });
            
            // Update constitution bonus info
            updateConstitutionBonus();
            updateArmorStats(); // Update AC with dexterity changes
        }

        function updateConstitutionBonus() {
            const con = character.abilities.constitution;
            const conData = abilityModifiers.constitution[con] || { hp: 0, shock: 70, resurrection: 75 };
            
            document.getElementById('conHPBonus').textContent = `HP por nivel: ${conData.hp >= 0 ? '+' : ''}${conData.hp}`;
            document.getElementById('conShockSurvival').textContent = `Shock del sistema: ${conData.shock}%`;
            document.getElementById('conResurrection').textContent = `Supervivencia/Revivir: ${conData.resurrection}%`;
            
            document.getElementById('constitutionBonusInfo').style.display = 'block';
        }

        function rollAbilities() {
            const abilities = ['strength', 'dexterity', 'constitution', 'intelligence', 'wisdom', 'charisma'];
            
            abilities.forEach(ability => {
                // Roll 4d6, drop lowest
                const rolls = [];
                for (let i = 0; i < 4; i++) {
                    rolls.push(Math.floor(Math.random() * 6) + 1);
                }
                rolls.sort((a, b) => b - a);
                const total = rolls[0] + rolls[1] + rolls[2];
                
                document.getElementById(ability).value = total;
            });
            
            calculateModifiers();
            showNotification('Habilidades rodadas con 4d6, descartando el menor');
        }

        function rollHitPoints() {
            let hitDie = 8; // Default
            if (character.primaryClass && classData[character.primaryClass]) {
                const die = classData[character.primaryClass].hitDie;
                hitDie = parseInt(die.substring(1));
            }
            
            const roll = Math.floor(Math.random() * hitDie) + 1;
            const conBonus = abilityModifiers.constitution[character.abilities.constitution]?.hp || 0;
            const total = Math.max(1, roll + conBonus);
            
            character.hitPoints = total;
            document.getElementById('totalHP').textContent = total;
            document.getElementById('combatHP').textContent = total;
            
            showNotification(`HP rodados: ${roll} + ${conBonus} (CON) = ${total}`);
        }

        function rollDice(sides) {
            const roll = Math.floor(Math.random() * sides) + 1;
            showNotification(`d${sides}: ${roll}`);
        }

// Función para actualizar el tamaño del personaje basado en la altura
function updateCharacterSize() {
    const heightInput = document.getElementById('characterHeight');
    const sizeInput = document.getElementById('characterSize');
    
    if (!heightInput || !sizeInput) return;
    
    const height = parseInt(heightInput.value) || 0;
    let size = 'Mediano'; // Valor por defecto
    
    if (height >= 1 && height <= 30) {
        size = 'Diminuto';
    } else if (height >= 31 && height <= 60) {
        size = 'Minúsculo';
    } else if (height >= 61 && height <= 120) {
        size = 'Pequeño';
    } else if (height >= 121 && height <= 240) {
        size = 'Mediano';
    } else if (height >= 241 && height <= 480) {
        size = 'Grande';
    } else if (height >= 481 && height <= 960) {
        size = 'Enorme';
    } else if (height >= 961 && height <= 2000) {
        size = 'Gargantuesco';
    } else if (height > 2000) {
        size = 'Colosal';
    }
    
    sizeInput.value = size;
    
    console.log(`Altura: ${height}cm → Tamaño: ${size}`);
}
// Tabla de experiencia por clase
const xpTables = {
    guerrero: [0, 2000, 4000, 8000, 16000, 32000, 64000, 125000, 250000, 500000, 750000, 1000000, 1250000, 1500000, 1750000, 2000000, 2250000, 2500000, 2750000, 3000000],
    
    luchador: [0, 2250, 4500, 9000, 18000, 32000, 75000, 150000, 300000, 600000, 900000, 1200000, 1500000, 1800000, 2100000, 2400000, 2700000, 3000000, 3300000, 3600000],
    
    hechicero: [0, 2500, 5000, 10000, 20000, 40000, 60000, 90000, 135000, 250000, 375000, 750000, 1125000, 1500000, 1875000, 2250000, 2625000, 3000000, 3375000, 3750000],
    
    clerigo: [0, 1500, 3000, 6000, 13000, 27500, 55000, 110000, 225000, 450000, 675000, 900000, 1125000, 1350000, 1575000, 1800000, 2025000, 2250000, 2475000, 2700000],
    
    druida: [0, 2000, 4000, 7500, 12500, 20000, 35000, 60000, 90000, 125000, 200000, 300000, 750000, 1500000, 3000000, 3500000, 500000, 1500000, 1500000, 2000000], // Nivel 17 = 500000
    
    ladron: [0, 1250, 2500, 5000, 10000, 20000, 40000, 70000, 110000, 160000, 220000, 440000, 660000, 880000, 1100000, 1320000, 1540000, 1760000, 1980000, 2200000]
};

// Mapeo de clases a tablas
const classToTable = {
    'guerrero': 'guerrero',
    'ranger': 'luchador',
    'bárbaro': 'luchador', 
    'paladín': 'luchador',
    'samurái': 'luchador',
    'mago': 'hechicero',
    'hechicero': 'hechicero',
    'bruja': 'hechicero',
    'artífice': 'hechicero',
    'clérigo': 'clerigo',
    'chamán': 'clerigo',
    'druida': 'druida',
    'ladrón': 'ladron',
    'bardo': 'ladron',
    'ninja': 'ladron',
    'psiónico': 'ladron',
    'pistolero': 'ladron'
};

// Función para determinar si es humano
function isHuman() {
    const race = document.getElementById('race')?.value?.toLowerCase() || '';
    return race === 'humano' || race === '';
}

// Función para obtener todas las clases activas
function getActiveClasses() {
    const classes = [];
    
    // Clase principal
    const primary = document.getElementById('primary-selected-name')?.textContent;
    if (primary && primary !== 'Selecciona una clase') {
        classes.push(primary.toLowerCase());
    }
    
    // Clase secundaria
    const secondary = document.getElementById('secondary-selected-name')?.textContent;
    if (secondary && secondary !== 'Selecciona una clase' && secondary !== 'Selecciona primero una categoría principal') {
        classes.push(secondary.toLowerCase());
    }
    
    // Clase terciaria
    const tertiary = document.getElementById('tertiary-selected-name')?.textContent;
    if (tertiary && tertiary !== 'Selecciona una clase' && tertiary !== 'Selecciona primero una categoría secundaria') {
        classes.push(tertiary.toLowerCase());
    }
    
    return classes;
}

// Función para calcular XP requerida para multiclase
function calculateMulticlassXP(level, classes, isHumanRace) {
    if (classes.length === 0) return 0;
    
    let totalXP = 0;
    
    classes.forEach(className => {
        const tableKey = classToTable[className] || 'ladron';
        const table = xpTables[tableKey];
        
        if (level <= table.length) {
            let classXP = table[level - 1] || 0;
            
            // Aplicar penalización por raza no humana
            if (!isHumanRace) {
                classXP *= 2;
            }
            
            totalXP += classXP;
        }
    });
    
    // Para multiclase, dividir entre número de clases
    if (classes.length > 1) {
        totalXP = Math.floor(totalXP / classes.length);
    }
    
    return totalXP;
}

// Función principal para actualizar desde XP
function updateFromXP() {
    const xpInput = document.getElementById('experience');
    if (!xpInput) return;
    
    const currentXP = parseInt(xpInput.value) || 0;
    const classes = getActiveClasses();
    const isHumanRace = isHuman();
    
    if (classes.length === 0) {
        showNextLevelInfo(currentXP, 1, null, 'No hay clases seleccionadas');
        return;
    }
    
    // Calcular nivel actual
    let currentLevel = 1;
    for (let testLevel = 2; testLevel <= 20; testLevel++) {
        const requiredXP = calculateMulticlassXP(testLevel, classes, isHumanRace);
        if (currentXP >= requiredXP) {
            currentLevel = testLevel;
        } else {
            break;
        }
    }
    
    // Calcular XP para siguiente nivel
    let nextLevelXP = null;
    if (currentLevel < 20) {
        nextLevelXP = calculateMulticlassXP(currentLevel + 1, classes, isHumanRace);
    }
    
    // Actualizar displays
    const levelDisplay = document.getElementById('characterLevelDisplay');
    if (levelDisplay) {
        levelDisplay.textContent = currentLevel;
    }
    
    const levelField = document.getElementById('Level');
    if (levelField) {
        levelField.value = currentLevel;
    }
    
    // Mostrar información detallada
    showNextLevelInfo(currentXP, currentLevel, nextLevelXP, classes, isHumanRace);
    
    // Actualizar cálculos de combate
    if (typeof updateAllCombatStats === 'function') {
        updateAllCombatStats();
    }
}

// Función para mostrar información del siguiente nivel
function showNextLevelInfo(currentXP, currentLevel, nextLevelXP, classes, isHumanRace) {
    let infoElement = document.getElementById('nextLevelInfo');
    if (!infoElement) {
        infoElement = document.createElement('div');
        infoElement.id = 'nextLevelInfo';
        infoElement.style.cssText = `
            margin-top: 0.5rem;
            padding: 0.8rem;
            background: rgba(255, 215, 0, 0.1);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 6px;
            font-size: 0.85rem;
            color: #ffd700;
            line-height: 1.4;
        `;
        
        const xpInput = document.getElementById('experience');
        if (xpInput && xpInput.parentNode) {
            xpInput.parentNode.appendChild(infoElement);
        }
    }
    
    if (typeof classes === 'string') {
        // Caso de error
        infoElement.innerHTML = `<span style="color: #ff6b6b">${classes}</span>`;
        return;
    }
    
    let info = `<strong>Nivel ${currentLevel}</strong>`;
    
    // Mostrar clases activas
    if (classes && classes.length > 0) {
        info += `<br><small>Clases: ${classes.join(', ')}</small>`;
        
        if (classes.length > 1) {
            info += `<br><small>Multiclase (XP promediado)</small>`;
        }
        
        if (!isHumanRace) {
            info += `<br><small style="color: #ffed4e">Raza no humana (XP x2)</small>`;
        }
    }
    
    if (nextLevelXP) {
        const xpNeeded = nextLevelXP - currentXP;
        const percentage = Math.min(100, (currentXP / nextLevelXP) * 100);
        
        info += `<br><br><strong>Siguiente nivel (${currentLevel + 1}):</strong>`;
        info += `<br>Requiere: ${nextLevelXP.toLocaleString()} XP`;
        info += `<br>Faltan: <span style="color: #ffed4e">${xpNeeded.toLocaleString()} XP</span>`;
        info += `<br><small>Progreso: ${percentage.toFixed(1)}%</small>`;
        
        // Barra de progreso visual
        info += `<div style="
            width: 100%; 
            height: 8px; 
            background: rgba(0,0,0,0.3); 
            border-radius: 4px; 
            margin-top: 4px;
            overflow: hidden;
        ">
            <div style="
                width: ${percentage}%; 
                height: 100%; 
                background: linear-gradient(90deg, #ffd700, #ffed4e);
                transition: width 0.3s ease;
            "></div>
        </div>`;
    } else {
        info += `<br><br><span style="color: #00ff7f">¡Nivel máximo alcanzado!</span>`;
    }
    
    infoElement.innerHTML = info;
}

// Event listeners para actualizar cuando cambien las clases
function setupXPListeners() {
    const classElements = [
        'primary-selected-name',
        'secondary-selected-name', 
        'tertiary-selected-name',
        'race'
    ];
    
    classElements.forEach(id => {
        const element = document.getElementById(id);
        if (element) {
            // Observer para detectar cambios en el texto
            const observer = new MutationObserver(() => {
                setTimeout(updateFromXP, 100);
            });
            observer.observe(element, { childList: true, characterData: true, subtree: true });
        }
    });
}

// Inicializar listeners cuando cargue la página
document.addEventListener('DOMContentLoaded', function() {
    setupXPListeners();
    // Actualizar una vez al cargar
    setTimeout(updateFromXP, 500);
});
              
        // Spell system functions (simplified placeholders)
        function updateSpellList() {
            const casterType = document.getElementById('casterType').value;
            document.getElementById('onlineSearchBtn').disabled = !casterType;
            document.getElementById('addSpellBtn').disabled = !casterType;
            
            if (casterType) {
                showNotification(`Tipo de lanzador seleccionado: ${casterType}`);
            }
        }

        function filterSpells() {
            showNotification('Función de filtrado implementada');
        }

        function searchSpells() {
            showNotification('Función de búsqueda implementada');
        }

        function browseSpellLists() {
            showNotification('Lista de conjuros en desarrollo');
        }

        function searchSpellOnline() {
            showNotification('Búsqueda online en desarrollo');
        }

        function parseSpellsFromText() {
            showNotification('Importación de texto en desarrollo');
        }

        function exportCustomSpells() {
            showNotification('Exportación en desarrollo');
        }

        function importCustomSpells() {
            showNotification('Importación JSON en desarrollo');
        }

        function addCustomSpell() {
            showNotification('Añadir conjuro manual en desarrollo');
        }

        // Character management
        function saveCharacter() {
            const characterData = JSON.stringify(character, null, 2);
            showNotification('Personaje guardado en memoria (localStorage no disponible)');
            console.log('Character data:', characterData);
        }

        function exportCharacter() {
            const characterData = JSON.stringify(character, null, 2);
            const blob = new Blob([characterData], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${character.name || 'personaje'}.json`;
            a.click();
            URL.revokeObjectURL(url);
            showNotification('Personaje exportado como archivo JSON');
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            calculateModifiers();
            updateArmorStats();
            
            // Initialize all equipment slots as empty
            Object.keys(character.equipment).forEach(slot => {
                updateEquipmentSlot(slot, null);
            });
        });
    </script>
</body>
</html> 
